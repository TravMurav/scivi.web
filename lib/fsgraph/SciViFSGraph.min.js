var SciViFSGraph="object"==typeof SciViFSGraph?SciViFSGraph:{};SciViFSGraph.main=function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=30)}([function(t,e,i){"use strict";var s=SyntaxError,n=Function,r=TypeError,a=function(t){try{return n('"use strict"; return ('+t+").constructor;")()}catch(t){}},o=Object.getOwnPropertyDescriptor;if(o)try{o({},"")}catch(t){o=null}var l=function(){throw new r},h=o?function(){try{return l}catch(t){try{return o(arguments,"callee").get}catch(t){return l}}}():l,c=i(18)(),u=Object.getPrototypeOf||function(t){return t.__proto__},d={},g="undefined"==typeof Uint8Array?void 0:u(Uint8Array),p={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":c?u([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":n,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c?u(u([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&c?u((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&c?u((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c?u(""[Symbol.iterator]()):void 0,"%Symbol%":c?Symbol:void 0,"%SyntaxError%":s,"%ThrowTypeError%":h,"%TypedArray%":g,"%TypeError%":r,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},_={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},f=i(1),m=i(3),v=f.call(Function.call,Array.prototype.concat),y=f.call(Function.apply,Array.prototype.splice),b=f.call(Function.call,String.prototype.replace),x=f.call(Function.call,String.prototype.slice),w=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,E=/\\(\\)?/g,k=function(t){var e=x(t,0,1),i=x(t,-1);if("%"===e&&"%"!==i)throw new s("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==e)throw new s("invalid intrinsic syntax, expected opening `%`");var n=[];return b(t,w,(function(t,e,i,s){n[n.length]=i?b(s,E,"$1"):e||t})),n},z=function(t,e){var i,n=t;if(m(_,n)&&(n="%"+(i=_[n])[0]+"%"),m(p,n)){var o=p[n];if(o===d&&(o=function t(e){var i;if("%AsyncFunction%"===e)i=a("async function () {}");else if("%GeneratorFunction%"===e)i=a("function* () {}");else if("%AsyncGeneratorFunction%"===e)i=a("async function* () {}");else if("%AsyncGenerator%"===e){var s=t("%AsyncGeneratorFunction%");s&&(i=s.prototype)}else if("%AsyncIteratorPrototype%"===e){var n=t("%AsyncGenerator%");n&&(i=u(n.prototype))}return p[e]=i,i}(n)),void 0===o&&!e)throw new r("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:o}}throw new s("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new r("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new r('"allowMissing" argument must be a boolean');var i=k(t),n=i.length>0?i[0]:"",a=z("%"+n+"%",e),l=a.name,h=a.value,c=!1,u=a.alias;u&&(n=u[0],y(i,v([0,1],u)));for(var d=1,g=!0;d<i.length;d+=1){var _=i[d],f=x(_,0,1),b=x(_,-1);if(('"'===f||"'"===f||"`"===f||'"'===b||"'"===b||"`"===b)&&f!==b)throw new s("property names with quotes must have matching quotes");if("constructor"!==_&&g||(c=!0),m(p,l="%"+(n+="."+_)+"%"))h=p[l];else if(null!=h){if(!(_ in h)){if(!e)throw new r("base intrinsic for "+t+" exists, but the property is not available.");return}if(o&&d+1>=i.length){var w=o(h,_);h=(g=!!w)&&"get"in w&&!("originalValue"in w.get)?w.get:h[_]}else g=m(h,_),h=h[_];g&&!c&&(p[l]=h)}}return h}},function(t,e,i){"use strict";var s=i(16);t.exports=Function.prototype.bind||s},function(t,e,i){t.exports=function(t){"uniqueLinkId"in(t=t||{})&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n","\n","Note: there is also change in default behavior: From now on each graph\nis considered to be not a multigraph by default (each edge is unique)."),t.multigraph=t.uniqueLinkId);void 0===t.multigraph&&(t.multigraph=!1);if("function"!=typeof Map)throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,i=[],h={},c=0,u=t.multigraph?function(t,e,i){var s=l(t,e),n=h.hasOwnProperty(s);if(n||S(t,e)){n||(h[s]=0);var r="@"+ ++h[s];s=l(t+r,e+r)}return new o(t,e,i,s)}:function(t,e,i){var s=l(t,e);return new o(t,e,i,s)},d=[],g=A,p=A,_=A,f=A,m={addNode:b,addLink:function(t,e,s){_();var n=x(t)||b(t),r=x(e)||b(e),o=u(t,e,s);i.push(o),a(n,o),t!==e&&a(r,o);return g(o,"add"),f(),o},removeLink:z,removeNode:w,getNode:x,getNodeCount:E,getLinkCount:k,getLinksCount:k,getNodesCount:E,getLinks:function(t){var e=x(t);return e?e.links:null},forEachNode:O,forEachLinkedNode:function(t,i,s){var n=x(t);if(n&&n.links&&"function"==typeof i)return s?function(t,i,s){for(var n=0;n<t.length;++n){var r=t[n];if(r.fromId===i&&s(e.get(r.toId),r))return!0}}(n.links,t,i):function(t,i,s){for(var n=0;n<t.length;++n){var r=t[n],a=r.fromId===i?r.toId:r.fromId;if(s(e.get(a),r))return!0}}(n.links,t,i)},forEachLink:function(t){var e,s;if("function"==typeof t)for(e=0,s=i.length;e<s;++e)t(i[e])},beginUpdate:_,endUpdate:f,clear:function(){_(),O((function(t){w(t.id)})),f()},hasLink:S,hasNode:x,getLink:S};return s(m),function(){var t=m.on;m.on=function(){return m.beginUpdate=_=N,m.endUpdate=f=j,g=v,p=y,m.on=t,t.apply(m,arguments)}}(),m;function v(t,e){d.push({link:t,changeType:e})}function y(t,e){d.push({node:t,changeType:e})}function b(t,i){if(void 0===t)throw new Error("Invalid node identifier");_();var s=x(t);return s?(s.data=i,p(s,"update")):(s=new r(t,i),p(s,"add")),e.set(t,s),f(),s}function x(t){return e.get(t)}function w(t){var i=x(t);if(!i)return!1;_();var s=i.links;if(s){i.links=null;for(var n=0;n<s.length;++n)z(s[n])}return e.delete(t),p(i,"remove"),f(),!0}function E(){return e.size}function k(){return i.length}function z(t){if(!t)return!1;var e=n(t,i);if(e<0)return!1;_(),i.splice(e,1);var s=x(t.fromId),r=x(t.toId);return s&&(e=n(t,s.links))>=0&&s.links.splice(e,1),r&&(e=n(t,r.links))>=0&&r.links.splice(e,1),g(t,"remove"),f(),!0}function S(t,e){var i,s=x(t);if(!s||!s.links)return null;for(i=0;i<s.links.length;++i){var n=s.links[i];if(n.fromId===t&&n.toId===e)return n}return null}function A(){}function N(){c+=1}function j(){0===(c-=1)&&d.length>0&&(m.fire("changed",d),d.length=0)}function O(t){if("function"!=typeof t)throw new Error("Function is expected to iterate over graph nodes. You passed "+t);for(var i=e.values(),s=i.next();!s.done;){if(t(s.value))return!0;s=i.next()}}};var s=i(29);function n(t,e){if(!e)return-1;if(e.indexOf)return e.indexOf(t);var i,s=e.length;for(i=0;i<s;i+=1)if(e[i]===t)return i;return-1}function r(t,e){this.id=t,this.links=null,this.data=e}function a(t,e){t.links?t.links.push(e):t.links=[e]}function o(t,e,i,s){this.fromId=t,this.toId=e,this.data=i,this.id=s}function l(t,e){return t.toString()+"👉 "+e.toString()}},function(t,e,i){"use strict";var s=i(1);t.exports=s.call(Function.call,Object.prototype.hasOwnProperty)},function(t,e,i){"use strict";var s=i(1),n=i(0),r=n("%Function.prototype.apply%"),a=n("%Function.prototype.call%"),o=n("%Reflect.apply%",!0)||s.call(a,r),l=n("%Object.getOwnPropertyDescriptor%",!0),h=n("%Object.defineProperty%",!0),c=n("%Math.max%");if(h)try{h({},"a",{value:1})}catch(t){h=null}t.exports=function(t){var e=o(s,a,arguments);if(l&&h){var i=l(e,"length");i.configurable&&h(e,"length",{value:1+c(0,t.length-(arguments.length-1))})}return e};var u=function(){return o(s,r,arguments)};h?h(t.exports,"apply",{value:u}):t.exports.apply=u},function(t,e,i){"use strict";var s=i(20),n="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),r=Object.prototype.toString,a=Array.prototype.concat,o=Object.defineProperty,l=o&&function(){var t={};try{for(var e in o(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),h=function(t,e,i,s){var n;(!(e in t)||"function"==typeof(n=s)&&"[object Function]"===r.call(n)&&s())&&(l?o(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},c=function(t,e){var i=arguments.length>2?arguments[2]:{},r=s(e);n&&(r=a.call(r,Object.getOwnPropertySymbols(e)));for(var o=0;o<r.length;o+=1)h(t,r[o],e[r[o]],i[r[o]])};c.supportsDescriptors=!!l,t.exports=c},function(t,e,i){"use strict";var s=Object.prototype.toString;t.exports=function(t){var e=s.call(t),i="[object Arguments]"===e;return i||(i="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===s.call(t.callee)),i}},function(t,e,i){"use strict";var s=i(22),n=i(24),r=i(25)("String.prototype.replace"),a=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,o=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;t.exports=function(){var t=n(s(this));return r(r(t,a,""),o,"")}},function(t,e,i){"use strict";var s=i(7);t.exports=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:s}},function(t,e,i){"use strict";var s=i(13),n=i(15),r=i(3),a=i(17),o=function(t){n(!1,t)},l=String.prototype.replace,h=String.prototype.split,c=function(t){var e=t%100,i=e%10;return 11!==e&&1===i?0:2<=i&&i<=4&&!(e>=12&&e<=14)?1:2},u={pluralTypes:{arabic:function(t){if(t<3)return t;var e=t%100;return e>=3&&e<=10?3:e>=11?4:5},bosnian_serbian:c,chinese:function(){return 0},croatian:c,french:function(t){return t>1?1:0},german:function(t){return 1!==t?1:0},russian:c,lithuanian:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){if(1===t)return 0;var e=t%10;return 2<=e&&e<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!=1||t%100==11?1:0},slovenian:function(t){var e=t%100;return 1===e?0:2===e?1:3===e||4===e?2:3}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]}};function d(t,e){var i,n,r=(i=t.pluralTypeToLanguages,n={},s(i,(function(t,e){s(t,(function(t){n[t]=e}))})),n);return r[e]||r[h.call(e,/-/,1)[0]]||r.en}function g(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var p=/%\{(.*?)\}/g;function _(t,e,i,s,n){if("string"!=typeof t)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==e)return t;var o=t,c=s||p,g=n||u,_="number"==typeof e?{smart_count:e}:e;if(null!=_.smart_count&&o){var f=h.call(o,"||||");o=a(f[function(t,e,i){return t.pluralTypes[d(t,e)](i)}(g,i||"en",_.smart_count)]||f[0])}return o=l.call(o,c,(function(t,e){return r(_,e)&&null!=_[e]?_[e]:t}))}function f(t){var e=t||{};this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en";var i=e.allowMissing?_:null;this.onMissingKey="function"==typeof e.onMissingKey?e.onMissingKey:i,this.warn=e.warn||o,this.tokenRegex=function(t){var e=t&&t.prefix||"%{",i=t&&t.suffix||"}";if("||||"===e||"||||"===i)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(g(e)+"(.*?)"+g(i),"g")}(e.interpolation),this.pluralRules=e.pluralRules||u}f.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},f.prototype.extend=function(t,e){s(t,(function(t,i){var s=e?e+"."+i:i;"object"==typeof t?this.extend(t,s):this.phrases[s]=t}),this)},f.prototype.unset=function(t,e){"string"==typeof t?delete this.phrases[t]:s(t,(function(t,i){var s=e?e+"."+i:i;"object"==typeof t?this.unset(t,s):delete this.phrases[s]}),this)},f.prototype.clear=function(){this.phrases={}},f.prototype.replace=function(t){this.clear(),this.extend(t)},f.prototype.t=function(t,e){var i,s,n=null==e?{}:e;if("string"==typeof this.phrases[t])i=this.phrases[t];else if("string"==typeof n._)i=n._;else if(this.onMissingKey){s=(0,this.onMissingKey)(t,n,this.currentLocale,this.tokenRegex,this.pluralRules)}else this.warn('Missing translation for key: "'+t+'"'),s=t;return"string"==typeof i&&(s=_(i,n,this.currentLocale,this.tokenRegex,this.pluralRules)),s},f.prototype.has=function(t){return r(this.phrases,t)},f.transformPhrase=function(t,e,i){return _(t,e,i)},t.exports=f},function(t,e,i){
/*! Split.js - v1.3.5 */
t.exports=function(){"use strict";var t=window,e=t.document,i=function(){return!1},s=t.attachEvent&&!t.addEventListener,n=["","-webkit-","-moz-","-o-"].filter((function(t){var i=e.createElement("div");return i.style.cssText="width:"+t+"calc(9px)",!!i.style.length})).shift()+"calc",r=function(t){return"string"==typeof t||t instanceof String?e.querySelector(t):t};return function(a,o){var l,h,c,u;void 0===o&&(o={});var d=r(a[0]).parentNode,g=t.getComputedStyle(d).flexDirection,p=o.sizes||a.map((function(){return 100/a.length})),_=void 0!==o.minSize?o.minSize:100,f=Array.isArray(_)?_:a.map((function(){return _})),m=void 0!==o.gutterSize?o.gutterSize:10,v=void 0!==o.snapOffset?o.snapOffset:30,y=o.direction||"horizontal",b=o.cursor||("horizontal"===y?"ew-resize":"ns-resize"),x=o.gutter||function(t,i){var s=e.createElement("div");return s.className="gutter gutter-"+i,s},w=o.elementStyle||function(t,e,i){var r={};return r[t]="string"==typeof e||e instanceof String?e:s?e+"%":n+"("+e+"% - "+i+"px)",r},E=o.gutterStyle||function(t,e){return(i={})[t]=e+"px",i;var i};function k(t,e,i){var s=w(l,e,i);Object.keys(s).forEach((function(e){return t.style[e]=s[e]}))}function z(t){var e=u[this.a],i=u[this.b],s=e.size+i.size;e.size=t/this.size*s,i.size=s-t/this.size*s,k(e.element,e.size,this.aGutterSize),k(i.element,i.size,this.bGutterSize)}function S(t){var e;this.dragging&&((e="touches"in t?t.touches[0][h]-this.start:t[h]-this.start)<=u[this.a].minSize+v+this.aGutterSize?e=u[this.a].minSize+this.aGutterSize:e>=this.size-(u[this.b].minSize+v+this.bGutterSize)&&(e=this.size-(u[this.b].minSize+this.bGutterSize)),z.call(this,e),o.onDrag&&o.onDrag())}function A(){var t=u[this.a].element,e=u[this.b].element;this.size=t.getBoundingClientRect()[l]+e.getBoundingClientRect()[l]+this.aGutterSize+this.bGutterSize,this.start=t.getBoundingClientRect()[c]}function N(){var e=u[this.a].element,s=u[this.b].element;this.dragging&&o.onDragEnd&&o.onDragEnd(),this.dragging=!1,t.removeEventListener("mouseup",this.stop),t.removeEventListener("touchend",this.stop),t.removeEventListener("touchcancel",this.stop),this.parent.removeEventListener("mousemove",this.move),this.parent.removeEventListener("touchmove",this.move),delete this.stop,delete this.move,e.removeEventListener("selectstart",i),e.removeEventListener("dragstart",i),s.removeEventListener("selectstart",i),s.removeEventListener("dragstart",i),e.style.userSelect="",e.style.webkitUserSelect="",e.style.MozUserSelect="",e.style.pointerEvents="",s.style.userSelect="",s.style.webkitUserSelect="",s.style.MozUserSelect="",s.style.pointerEvents="",this.gutter.style.cursor="",this.parent.style.cursor=""}function j(e){var s=u[this.a].element,n=u[this.b].element;!this.dragging&&o.onDragStart&&o.onDragStart(),e.preventDefault(),this.dragging=!0,this.move=S.bind(this),this.stop=N.bind(this),t.addEventListener("mouseup",this.stop),t.addEventListener("touchend",this.stop),t.addEventListener("touchcancel",this.stop),this.parent.addEventListener("mousemove",this.move),this.parent.addEventListener("touchmove",this.move),s.addEventListener("selectstart",i),s.addEventListener("dragstart",i),n.addEventListener("selectstart",i),n.addEventListener("dragstart",i),s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",this.gutter.style.cursor=b,this.parent.style.cursor=b,A.call(this)}"horizontal"===y?(l="width",h="clientX",c="left"):"vertical"===y&&(l="height",h="clientY",c="top");var O=[];function L(t){t.forEach((function(e,i){if(i>0){var s=O[i-1],n=u[s.a],r=u[s.b];n.size=t[i-1],r.size=e,k(n.element,n.size,s.aGutterSize),k(r.element,r.size,s.bGutterSize)}}))}function C(){O.forEach((function(t){t.parent.removeChild(t.gutter),u[t.a].element.style[l]="",u[t.b].element.style[l]=""}))}return u=a.map((function(t,e){var i,n={element:r(t),size:p[e],minSize:f[e]};if(e>0&&((i={a:e-1,b:e,dragging:!1,isFirst:1===e,isLast:e===a.length-1,direction:y,parent:d}).aGutterSize=m,i.bGutterSize=m,i.isFirst&&(i.aGutterSize=m/2),i.isLast&&(i.bGutterSize=m/2),"row-reverse"===g||"column-reverse"===g)){var o=i.a;i.a=i.b,i.b=o}if(!s&&e>0){var h=x(e,y);!function(t,e){var i=E(l,e);Object.keys(i).forEach((function(e){return t.style[e]=i[e]}))}(h,m),h.addEventListener("mousedown",j.bind(i)),h.addEventListener("touchstart",j.bind(i)),d.insertBefore(h,n.element),i.gutter=h}0===e||e===a.length-1?k(n.element,n.size,m/2):k(n.element,n.size,m);var c=n.element.getBoundingClientRect()[l];return c<n.minSize&&(n.minSize=c),e>0&&O.push(i),n})),s?{setSizes:L,destroy:C}:{setSizes:L,getSizes:function(){return u.map((function(t){return t.size}))},collapse:function(t){if(t===O.length){var e=O[t-1];A.call(e),s||z.call(e,e.size-e.bGutterSize)}else{var i=O[t];A.call(i),s||z.call(i,i.aGutterSize)}},destroy:C}}}()},function(t,e,i){var s,n,r;n=[],void 0===(r="function"==typeof(s=function(){return function(){function t(e){var i,s;if(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.maxElements=e.maxElements,null==this.width||null==this.height)throw new Error("Missing quadtree dimensions.");if(null==this.x&&(this.x=0),null==this.y&&(this.y=0),null==this.maxElements&&(this.maxElements=1),this.contents=[],this.oversized=[],this.size=0,this.width<1||this.height<1)throw new Error("Dimensions must be positive integers.");if(!Number.isInteger(this.x)||!Number.isInteger(this.y))throw new Error("Coordinates must be integers");if(this.maxElements<1)throw new Error("The maximum number of elements before a split must be a positive integer.");for(i in s=this,this.children={NW:{create:function(){return new t({x:s.x,y:s.y,width:Math.max(Math.floor(s.width/2),1),height:Math.max(Math.floor(s.height/2),1),maxElements:s.maxElements})},tree:null},NE:{create:function(){return new t({x:s.x+Math.max(Math.floor(s.width/2),1),y:s.y,width:Math.ceil(s.width/2),height:Math.max(Math.floor(s.height/2),1),maxElements:s.maxElements})},tree:null},SW:{create:function(){return new t({x:s.x,y:s.y+Math.max(Math.floor(s.height/2),1),width:Math.max(Math.floor(s.width/2),1),height:Math.ceil(s.height/2),maxElements:s.maxElements})},tree:null},SE:{create:function(){return new t({x:s.x+Math.max(Math.floor(s.width/2),1),y:s.y+Math.max(Math.floor(s.height/2),1),width:Math.ceil(s.width/2),height:Math.ceil(s.height/2),maxElements:s.maxElements})},tree:null}},this.children)this.children[i].get=function(){return null!=this.tree||(this.tree=this.create()),this.tree}}var e,i,s,n,r,a,o,l;return n=function(t){var e,i;return{x:Math.floor((null!=(e=t.width)?e:1)/2)+t.x,y:Math.floor((null!=(i=t.height)?i:1)/2)+t.y}},e=function(t,e){var i,s,n,r;return!(t.x>=e.x+(null!=(i=e.width)?i:1)||t.x+(null!=(s=t.width)?s:1)<=e.x||t.y>=e.y+(null!=(n=e.height)?n:1)||t.y+(null!=(r=t.height)?r:1)<=e.y)},i=function(t,e){var i;return i=n(e),t.x<i.x?t.y<i.y?"NW":"SW":t.y<i.y?"NE":"SE"},l=function(t){if("object"!=typeof t)throw new Error("Element must be an Object.");if(null==t.x||null==t.y)throw new Error("Coordinates properties are missing.");if((null!=t?t.width:void 0)<0||(null!=t?t.height:void 0)<0)throw new Error("Width and height must be positive integers.")},a=function(t){var e,i,s,n;return i=Math.max(Math.floor(t.width/2),1),s=Math.ceil(t.width/2),n=Math.max(Math.floor(t.height/2),1),e=Math.ceil(t.height/2),{NW:{x:t.x,y:t.y,width:i,height:n},NE:{x:t.x+i,y:t.y,width:s,height:n},SW:{x:t.x,y:t.y+n,width:i,height:e},SE:{x:t.x+i,y:t.y+n,width:s,height:e}}},s=function(t,i){var s,n,r,o;for(n in o=[],r=a(i))s=r[n],e(t,s)&&o.push(n);return o},r=function(t,e){var i;return(i=function(i){return t["_"+i]=t[i],Object.defineProperty(t,i,{set:function(t){return e.remove(this,!0),this["_"+i]=t,e.push(this)},get:function(){return this["_"+i]},configurable:!0})})("x"),i("y"),i("width"),i("height")},o=function(t){var e;return(e=function(e){if(null!=t["_"+e])return delete t[e],t[e]=t["_"+e],delete t["_"+e]})("x"),e("y"),e("width"),e("height")},t.prototype.clear=function(){var t,e;for(t in this.contents=[],this.oversized=[],this.size=0,e=[],this.children)e.push(this.children[t].tree=null);return e},t.prototype.push=function(t,e){return this.pushAll([t],e)},t.prototype.pushAll=function(t,e){var i,n,a,o,h,c,u,d,g,p,_,f,m,v,y,b,x,w,E,k;for(_=0,v=t.length;_<v;_++)p=t[_],l(p),e&&r(p,this);for(u=[{tree:this,elements:t}];u.length>0;){for(k=(x=u.shift()).tree,d={NW:null,NE:null,SW:null,SE:null},f=0,y=(c=x.elements).length;f<y;f++)if(h=c[f],k.size++,1!==(g=s(h,k)).length||1===k.width||1===k.height)k.oversized.push(h);else if(k.size-k.oversized.length<=k.maxElements)k.contents.push(h);else{for(o=g[0],E=k.children[o],null==d[o]&&(d[o]={tree:E.get(),elements:[]}),d[o].elements.push(h),m=0,b=(w=k.contents).length;m<b;m++)n=w[m],null==d[a=s(n,k)[0]]&&(d[a]={tree:k.children[a].get(),elements:[]}),d[a].elements.push(n);k.contents=[]}for(o in d)null!=(i=d[o])&&u.push(i)}return this},t.prototype.remove=function(t,e){var s,n;return l(t),(s=this.oversized.indexOf(t))>-1?(this.oversized.splice(s,1),this.size--,e||o(t),!0):(s=this.contents.indexOf(t))>-1?(this.contents.splice(s,1),this.size--,e||o(t),!0):!(null==(n=this.children[i(t,this)]).tree||!n.tree.remove(t,e)||(this.size--,0===n.tree.size&&(n.tree=null),0))},t.prototype.colliding=function(t,i){var n,r,a,o,h,c,u,d,g,p,_,f,m,v;for(null==i&&(i=e),l(t),h=[],a=[this];a.length>0;){for(c=0,g=(f=(v=a.shift()).oversized).length;c<g;c++)(r=f[c])!==t&&i(t,r)&&h.push(r);for(u=0,p=(m=v.contents).length;u<p;u++)(r=m[u])!==t&&i(t,r)&&h.push(r);for(0===(o=s(t,v)).length&&(o=[],t.x>=v.x+v.width&&o.push("NE"),t.y>=v.y+v.height&&o.push("SW"),o.length>0&&(1===o.length?o.push("SE"):o=["SE"])),d=0,_=o.length;d<_;d++)n=o[d],null!=v.children[n].tree&&a.push(v.children[n].tree)}return h},t.prototype.onCollision=function(t,i,n){var r,a,o,h,c,u,d,g,p,_,f,m,v;for(null==n&&(n=e),l(t),o=[this];o.length>0;){for(c=0,g=(f=(v=o.shift()).oversized).length;c<g;c++)(a=f[c])!==t&&n(t,a)&&i(a);for(u=0,p=(m=v.contents).length;u<p;u++)(a=m[u])!==t&&n(t,a)&&i(a);for(0===(h=s(t,v)).length&&(h=[],t.x>=v.x+v.width&&h.push("NE"),t.y>=v.y+v.height&&h.push("SW"),h.length>0&&(1===h.length?h.push("SE"):h=["SE"])),d=0,_=h.length;d<_;d++)r=h[d],null!=v.children[r].tree&&o.push(v.children[r].tree)}return null},t.prototype.get=function(t){return this.where(t)},t.prototype.where=function(t){var e,s,n,r,a,o,h,c,u,d,g,p,_;if("object"==typeof t&&(null==t.x||null==t.y))return this.find((function(e){var i,s;for(s in i=!0,t)t[s]!==e[s]&&(i=!1);return i}));for(l(t),r=[],n=[this];n.length>0;){for(a=0,c=(d=(_=n.shift()).oversized).length;a<c;a++){for(h in s=d[a],e=!0,t)t[h]!==s[h]&&(e=!1);e&&r.push(s)}for(o=0,u=(g=_.contents).length;o<u;o++){for(h in s=g[o],e=!0,t)t[h]!==s[h]&&(e=!1);e&&r.push(s)}null!=(p=_.children[i(t,_)]).tree&&n.push(p.tree)}return r},t.prototype.each=function(t){var e,i,s,n,r,a,o,l,h,c;for(i=[this];i.length>0;){for(n=0,a=(l=(c=i.shift()).oversized).length;n<a;n++)s=l[n],"function"==typeof t&&t(s);for(r=0,o=(h=c.contents).length;r<o;r++)s=h[r],"function"==typeof t&&t(s);for(e in c.children)null!=c.children[e].tree&&i.push(c.children[e].tree)}return this},t.prototype.find=function(t){var e,i,s,n,r,a,o,l,h,c,u;for(i=[this],n=[];i.length>0;){for(r=0,o=(h=(u=i.shift()).oversized).length;r<o;r++)s=h[r],("function"==typeof t?t(s):void 0)&&n.push(s);for(a=0,l=(c=u.contents).length;a<l;a++)s=c[a],("function"==typeof t?t(s):void 0)&&n.push(s);for(e in u.children)null!=u.children[e].tree&&i.push(u.children[e].tree)}return n},t.prototype.filter=function(e){var i;return(i=function(s){var n,r,a,o,l,h,c,u,d,g,p;for(n in(r=new t({x:s.x,y:s.y,width:s.width,height:s.height,maxElements:s.maxElements})).size=0,s.children)null!=s.children[n].tree&&(r.children[n].tree=i(s.children[n].tree),r.size+=null!=(u=null!=(d=r.children[n].tree)?d.size:void 0)?u:0);for(o=0,h=(g=s.oversized).length;o<h;o++)a=g[o],(null==e||("function"==typeof e?e(a):void 0))&&r.oversized.push(a);for(l=0,c=(p=s.contents).length;l<c;l++)a=p[l],(null==e||("function"==typeof e?e(a):void 0))&&r.contents.push(a);return r.size+=r.oversized.length+r.contents.length,0===r.size?null:r})(this)},t.prototype.reject=function(t){return this.filter((function(e){return!("function"==typeof t?t(e):void 0)}))},t.prototype.visit=function(t){var e,i,s;for(i=[this];i.length>0;)for(e in s=i.shift(),t.bind(s)(),s.children)null!=s.children[e].tree&&i.push(s.children[e].tree);return this},t.prototype.pretty=function(){var t,e,i,s,n,r,a;for(r="",i=function(t){var e,i,s;for(s="",e=i=t;i<=0?e<0:e>0;i<=0?++e:--e)s+="   ";return s},e=[{label:"ROOT",tree:this,level:0}];e.length>0;){for(t in r+=(s=i((a=e.shift()).level))+"| "+a.label+"\n"+s+"| ------------\n",a.tree.oversized.length>0&&(r+=s+"| * Oversized elements *\n"+s+"|   "+a.tree.oversized+"\n"),a.tree.contents.length>0&&(r+=s+"| * Leaf content *\n"+s+"|   "+a.tree.contents+"\n"),n=!1,a.tree.children)null!=a.tree.children[t].tree&&(n=!0,e.unshift({label:t,tree:a.tree.children[t].tree,level:a.level+1}));n&&(r+=s+"└──┐\n")}return r},t}()})?s.apply(e,n):s)||(t.exports=r)},function(t,e,i){var s=i(27),n=i(28);t.exports=function(t,e){var i=s(t),r=n(i,e),a=r.modularity(),o=r.optimizeModularity(),l=r.modularity();return{canCoarse:function(){return o},originalModularity:a,newModularity:l,getClass:function(t){var e=i.getNodeIdFromNgraph(t);return r.getClass(e)}}}},function(t,e,i){"use strict";var s=i(14),n=Object.prototype.toString,r=Object.prototype.hasOwnProperty,a=function(t,e,i){for(var s=0,n=t.length;s<n;s++)r.call(t,s)&&(null==i?e(t[s],s,t):e.call(i,t[s],s,t))},o=function(t,e,i){for(var s=0,n=t.length;s<n;s++)null==i?e(t.charAt(s),s,t):e.call(i,t.charAt(s),s,t)},l=function(t,e,i){for(var s in t)r.call(t,s)&&(null==i?e(t[s],s,t):e.call(i,t[s],s,t))};t.exports=function(t,e,i){if(!s(e))throw new TypeError("iterator must be a function");var r;arguments.length>=3&&(r=i),"[object Array]"===n.call(t)?a(t,e,r):"string"==typeof t?o(t,e,r):l(t,e,r)}},function(t,e,i){"use strict";var s,n,r=Function.prototype.toString,a="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof a&&"function"==typeof Object.defineProperty)try{s=Object.defineProperty({},"length",{get:function(){throw n}}),n={},a((function(){throw 42}),null,s)}catch(t){t!==n&&(a=null)}else a=null;var o=/^\s*class\b/,l=function(t){try{var e=r.call(t);return o.test(e)}catch(t){return!1}},h=Object.prototype.toString,c="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,u="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};t.exports=a?function(t){if(t===u)return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if("function"==typeof t&&!t.prototype)return!0;try{a(t,null,s)}catch(t){if(t!==n)return!1}return!l(t)}:function(t){if(t===u)return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if("function"==typeof t&&!t.prototype)return!0;if(c)return function(t){try{return!l(t)&&(r.call(t),!0)}catch(t){return!1}}(t);if(l(t))return!1;var e=h.call(t);return"[object Function]"===e||"[object GeneratorFunction]"===e}},function(t,e,i){"use strict";var s=function(){};t.exports=s},function(t,e,i){"use strict";var s="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,r=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==r.call(e))throw new TypeError(s+e);for(var i,a=n.call(arguments,1),o=function(){if(this instanceof i){var s=e.apply(this,a.concat(n.call(arguments)));return Object(s)===s?s:this}return e.apply(t,a.concat(n.call(arguments)))},l=Math.max(0,e.length-a.length),h=[],c=0;c<l;c++)h.push("$"+c);if(i=Function("binder","return function ("+h.join(",")+"){ return binder.apply(this,arguments); }")(o),e.prototype){var u=function(){};u.prototype=e.prototype,i.prototype=new u,u.prototype=null}return i}},function(t,e,i){"use strict";var s=i(4),n=i(5),r=i(7),a=i(8),o=i(26),l=s(a());n(l,{getPolyfill:a,implementation:r,shim:o}),t.exports=l},function(t,e,i){"use strict";var s="undefined"!=typeof Symbol&&Symbol,n=i(19);t.exports=function(){return"function"==typeof s&&("function"==typeof Symbol&&("symbol"==typeof s("foo")&&("symbol"==typeof Symbol("bar")&&n())))}},function(t,e,i){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),i=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var s=Object.getOwnPropertySymbols(t);if(1!==s.length||s[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var n=Object.getOwnPropertyDescriptor(t,e);if(42!==n.value||!0!==n.enumerable)return!1}return!0}},function(t,e,i){"use strict";var s=Array.prototype.slice,n=i(6),r=Object.keys,a=r?function(t){return r(t)}:i(21),o=Object.keys;a.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return n(t)?o(s.call(t)):o(t)}):Object.keys=a;return Object.keys||a},t.exports=a},function(t,e,i){"use strict";var s;if(!Object.keys){var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,a=i(6),o=Object.prototype.propertyIsEnumerable,l=!o.call({toString:null},"toString"),h=o.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&n.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{u(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();s=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===r.call(t),s=a(t),o=e&&"[object String]"===r.call(t),d=[];if(!e&&!i&&!s)throw new TypeError("Object.keys called on a non-object");var p=h&&i;if(o&&t.length>0&&!n.call(t,0))for(var _=0;_<t.length;++_)d.push(String(_));if(s&&t.length>0)for(var f=0;f<t.length;++f)d.push(String(f));else for(var m in t)p&&"prototype"===m||!n.call(t,m)||d.push(String(m));if(l)for(var v=function(t){if("undefined"==typeof window||!g)return u(t);try{return u(t)}catch(t){return!1}}(t),y=0;y<c.length;++y)v&&"constructor"===c[y]||!n.call(t,c[y])||d.push(c[y]);return d}}t.exports=s},function(t,e,i){"use strict";t.exports=i(23)},function(t,e,i){"use strict";var s=i(0)("%TypeError%");t.exports=function(t,e){if(null==t)throw new s(e||"Cannot call method on "+t);return t}},function(t,e,i){"use strict";var s=i(0),n=s("%String%"),r=s("%TypeError%");t.exports=function(t){if("symbol"==typeof t)throw new r("Cannot convert a Symbol value to a string");return n(t)}},function(t,e,i){"use strict";var s=i(0),n=i(4),r=n(s("String.prototype.indexOf"));t.exports=function(t,e){var i=s(t,!!e);return"function"==typeof i&&r(t,".prototype.")>-1?n(i):i}},function(t,e,i){"use strict";var s=i(5),n=i(8);t.exports=function(){var t=n();return s(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t}},function(t,e){t.exports=function(t){var e,i=t.getNodesCount(),s=[],n=new Map;return t.forEachNode((function(t){var e,i;e=t.id,i=s.length,n.set(e,i),s.push({selfLoopsCount:0,weightedDegree:0,neighbours:null})})),t.forEachLink((function(t){var e,i=r(t.fromId),n=r(t.toId),o=(e=t.data)?"number"==typeof e?e:"number"==typeof e.weight?e.weight:1:1,l=s[i],h=s[n];i===n?(l.selfLoopsCount+=o,l.weightedDegree+=o):(a(l,n,o),a(h,i,o),l.weightedDegree+=o,h.weightedDegree+=o)})),e=function(){for(var t=0,e=0;e<i;++e)t+=o(e);return t}(),{nodeCount:i,weight:e,forEachNeigbour:function(t,e){var i=l(t);if(!i.neighbours)return;for(var s=0;s<i.neighbours.length;++s){var n=i.neighbours[s];e(n.id,n.weight)}},getWeightedDegree:o,getSelfLoopsCount:function(t){return l(t).selfLoopsCount},getNodeIdFromNgraph:r};function r(t){var e=n.get(t);if(void 0===e)throw new Error("Unknown node id: "+t);return e}function a(t,e,i){var s={id:e,weight:i};t.neighbours?t.neighbours.push(s):t.neighbours=[s]}function o(t){return l(t).weightedDegree}function l(t){var e=s[t];if(!e)throw new Error("cannot find node with id: "+t);return e}}},function(t,e){t.exports=function(t,e){for(var i=t.weight,s=t.nodeCount,n=new Float32Array(s),r=new Float32Array(s),a=new Uint32Array(s),o=0;o<s;++o)a[o]=o,n[o]=t.getWeightedDegree(o),r[o]=t.getSelfLoopsCount(o);return{modularity:d,optimizeModularity:function(){var e,i,n=function(){for(var t=[],e=0;e<s;++e)t[e]=e;return t}(),r=d(),o=!1;do{i=0,e=r;for(var g=0;g<n.length;++g){var p=n[g],_=a[p],f=l(p),m=f.get(_);c(p,_,m);var v=t.getWeightedDegree(p),y=_,b=0;f.forEach((function(t,e){var i=h(t,e,v);i<=b||(y=e,b=i)}));var x=f.get(y);u(p,y,x),y!==_&&(i+=1)}r=d(),i>0&&(o=!0)}while(i>0&&r-e>1e-6);return o},getClass:function(t){return a[t]}};function l(e){var i=new Map;return i.set(a[e],0),t.forEachNeigbour(e,(function(t,e){var s=a[t],n=i.get(s)||0;i.set(s,n+e)})),i}function h(t,e,s){return t-n[e]*s/i}function c(e,i,s){n[i]-=t.getWeightedDegree(e),r[i]-=2*s+t.getSelfLoopsCount(e),a[e]=-1}function u(e,i,s){n[i]+=t.getWeightedDegree(e),r[i]+=2*s+t.getSelfLoopsCount(e),a[e]=i}function d(){for(var t=0,e=0;e<s;++e)if(n[e]>0){var a=n[e]/i;t+=r[e]/i-a*a}return t}}},function(t,e){t.exports=function(t){!function(t){if(!t)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],i=0;i<e.length;++i)if(t.hasOwnProperty(e[i]))throw new Error("Subject cannot be eventified, since it already has property '"+e[i]+"'")}(t);var e=function(t){var e=Object.create(null);return{on:function(i,s,n){if("function"!=typeof s)throw new Error("callback is expected to be a function");var r=e[i];return r||(r=e[i]=[]),r.push({callback:s,ctx:n}),t},off:function(i,s){if(void 0===i)return e=Object.create(null),t;if(e[i])if("function"!=typeof s)delete e[i];else for(var n=e[i],r=0;r<n.length;++r)n[r].callback===s&&n.splice(r,1);return t},fire:function(i){var s,n=e[i];if(!n)return t;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var r=0;r<n.length;++r){var a=n[r];a.callback.apply(a.ctx,s)}return t}}}(t);return t.on=e.on,t.off=e.off,t.fire=e.fire,t}},function(t,e,i){"use strict";i.r(e),i.d(e,"getParameterByName",(function(){return ti})),i.d(e,"Translator",(function(){return n})),i.d(e,"getOrCreateTranslatorInstance",(function(){return a})),i.d(e,"GUI",(function(){return he})),i.d(e,"GraphSerializer",(function(){return ge})),i.d(e,"CircleNodeRenderer",(function(){return ye})),i.d(e,"OrientedStraightLinkRenderer",(function(){return ke})),i.d(e,"StraightLinkRenderer",(function(){return je})),i.d(e,"LayoutBuilder_Circle",(function(){return Oe})),i.d(e,"LayoutBuilder_FruchtermanReingold",(function(){return Ce})),i.d(e,"NodeInfoTab",(function(){return Me})),i.d(e,"NodeListTab",(function(){return Fe})),i.d(e,"SettingsTab",(function(){return We})),i.d(e,"FiltersTab",(function(){return Ke})),i.d(e,"StateCalculatorOperand",(function(){return Xe})),i.d(e,"CalculatorTab",(function(){return Ze})),i.d(e,"AboutGraphTab",(function(){return Qe})),i.d(e,"ParamType",(function(){return Pe})),i.d(e,"Param",(function(){return Re})),i.d(e,"ScalarParam",(function(){return Be})),i.d(e,"BooleanParam",(function(){return De}));var s=i(9);class n{constructor(t="ru"){this._locale=t,this._instance=new s({allowMissing:!1,locale:t})}extend(t){return this._instance.extend(t[this._locale]),this}apply(t){return this._instance.t(t)}}let r;function a(t=""){return r||(r=new n(t)),r}var o,l=i(10),h=i(11);!function(t){t.isNodeViewEmphasized=function(t){return!t.is_hidden&&(t.is_hovered||t.is_selected||t.is_toggled||t.selected_adjacent_vertex_count>0)},t.isLinkViewEmphasized=function(t){const e=t.from,i=t.to;if(e.is_hidden||i.is_hidden)return!1;{const t=e.is_hovered||e.is_selected||e.is_toggled,s=i.is_hovered||i.is_selected||i.is_toggled;return t&&s||t&&i.selected_adjacent_vertex_count>0||s&&e.selected_adjacent_vertex_count>0}},t.isLinkViewDisabled=function(t){return t.is_hidden||t.to.is_hidden||t.from.is_hidden},t.onNodesReplaced=function(){this.quad_tree.clear(),Object.values(this.aabbs).forEach(t=>{const e=t.scene_object;t.x=e.position.x-e.size,t.y=e.position.y-e.size,e.is_hidden||this.quad_tree.push(t)})}}(o||(o={}));class c{constructor(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get w(){return this.values[3]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}get xyzw(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set w(t){this.values[3]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set xyzw(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}get r(){return this.values[0]}get g(){return this.values[1]}get b(){return this.values[2]}get a(){return this.values[3]}get rg(){return[this.values[0],this.values[1]]}get rgb(){return[this.values[0],this.values[1],this.values[2]]}get rgba(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set r(t){this.values[0]=t}set g(t){this.values[1]=t}set b(t){this.values[2]=t}set a(t){this.values[3]=t}set rg(t){this.values[0]=t[0],this.values[1]=t[1]}set rgb(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set rgba(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}at(t){return this.values[t]}reset(){this.x=0,this.y=0,this.z=0,this.w=0}copy(t){return t||(t=new c),t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t}equals(t,e=1e-5){return!(Math.abs(this.x-t.x)>e)&&(!(Math.abs(this.y-t.y)>e)&&(!(Math.abs(this.z-t.z)>e)&&!(Math.abs(this.w-t.w)>e)))}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y,i=this.z,s=this.w;return t*t+e*e+i*i+s*s}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e.z*=t,e.w*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x*=0,t.y*=0,t.z*=0,t.w*=0,t):(e=1/e,t.x*=e,t.y*=e,t.z*=e,t.w*=e,t)}multiplyMat4(t,e){return e||(e=this),t.multiplyVec4(this,e)}static mix(t,e,i,s){return s||(s=new c),s.x=t.x+i*(e.x-t.x),s.y=t.y+i*(e.y-t.y),s.z=t.z+i*(e.z-t.z),s.w=t.w+i*(e.w-t.w),s}static sum(t,e,i){return i||(i=new c),i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i.w=t.w+e.w,i}static difference(t,e,i){return i||(i=new c),i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i.w=t.w-e.w,i}static product(t,e,i){return i||(i=new c),i.x=t.x*e.x,i.y=t.y*e.y,i.z=t.z*e.z,i.w=t.w*e.w,i}static quotient(t,e,i){return i||(i=new c),i.x=t.x/e.x,i.y=t.y/e.y,i.z=t.z/e.z,i.w=t.w/e.w,i}}c.zero=new c([0,0,0,1]),c.one=new c([1,1,1,1]);class u{constructor(t){this.values=new Float32Array(16),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<16;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<16;t++)this.values[t]=0}copy(t){t||(t=new u);for(let e=0;e<16;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<16;e++)t[e]=this.values[e];return t}row(t){return[this.values[4*t+0],this.values[4*t+1],this.values[4*t+2],this.values[4*t+3]]}col(t){return[this.values[t],this.values[t+4],this.values[t+8],this.values[t+12]]}equals(t,e=1e-5){for(let i=0;i<16;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}determinant(){const t=this.values[0],e=this.values[1],i=this.values[2],s=this.values[3],n=this.values[4],r=this.values[5],a=this.values[6],o=this.values[7],l=this.values[8],h=this.values[9],c=this.values[10],u=this.values[11],d=this.values[12],g=this.values[13],p=this.values[14],_=this.values[15];return(t*r-e*n)*(c*_-u*p)-(t*a-i*n)*(h*_-u*g)+(t*o-s*n)*(h*p-c*g)+(e*a-i*r)*(l*_-u*d)-(e*o-s*r)*(l*p-c*d)+(i*o-s*a)*(l*g-h*d)}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=0,this.values[5]=1,this.values[6]=0,this.values[7]=0,this.values[8]=0,this.values[9]=0,this.values[10]=1,this.values[11]=0,this.values[12]=0,this.values[13]=0,this.values[14]=0,this.values[15]=1,this}transpose(){const t=this.values[1],e=this.values[2],i=this.values[3],s=this.values[6],n=this.values[7],r=this.values[11];return this.values[1]=this.values[4],this.values[2]=this.values[8],this.values[3]=this.values[12],this.values[4]=t,this.values[6]=this.values[9],this.values[7]=this.values[13],this.values[8]=e,this.values[9]=s,this.values[11]=this.values[14],this.values[12]=i,this.values[13]=n,this.values[14]=r,this}inverse(){const t=this.values[0],e=this.values[1],i=this.values[2],s=this.values[3],n=this.values[4],r=this.values[5],a=this.values[6],o=this.values[7],l=this.values[8],h=this.values[9],c=this.values[10],u=this.values[11],d=this.values[12],g=this.values[13],p=this.values[14],_=this.values[15],f=t*r-e*n,m=t*a-i*n,v=t*o-s*n,y=e*a-i*r,b=e*o-s*r,x=i*o-s*a,w=l*g-h*d,E=l*p-c*d,k=l*_-u*d,z=h*p-c*g,S=h*_-u*g,A=c*_-u*p;let N=f*A-m*S+v*z+y*k-b*E+x*w;return N?(N=1/N,this.values[0]=(r*A-a*S+o*z)*N,this.values[1]=(-e*A+i*S-s*z)*N,this.values[2]=(g*x-p*b+_*y)*N,this.values[3]=(-h*x+c*b-u*y)*N,this.values[4]=(-n*A+a*k-o*E)*N,this.values[5]=(t*A-i*k+s*E)*N,this.values[6]=(-d*x+p*v-_*m)*N,this.values[7]=(l*x-c*v+u*m)*N,this.values[8]=(n*S-r*k+o*w)*N,this.values[9]=(-t*S+e*k-s*w)*N,this.values[10]=(d*b-g*v+_*f)*N,this.values[11]=(-l*b+h*v-u*f)*N,this.values[12]=(-n*z+r*E-a*w)*N,this.values[13]=(t*z-e*E+i*w)*N,this.values[14]=(-d*y+g*m-p*f)*N,this.values[15]=(l*y-h*m+c*f)*N,this):null}multiply(t){const e=this.values[0],i=this.values[1],s=this.values[2],n=this.values[3],r=this.values[4],a=this.values[5],o=this.values[6],l=this.values[7],h=this.values[8],c=this.values[9],u=this.values[10],d=this.values[11],g=this.values[12],p=this.values[13],_=this.values[14],f=this.values[15];let m=t.at(0),v=t.at(1),y=t.at(2),b=t.at(3);return this.values[0]=m*e+v*r+y*h+b*g,this.values[1]=m*i+v*a+y*c+b*p,this.values[2]=m*s+v*o+y*u+b*_,this.values[3]=m*n+v*l+y*d+b*f,m=t.at(4),v=t.at(5),y=t.at(6),b=t.at(7),this.values[4]=m*e+v*r+y*h+b*g,this.values[5]=m*i+v*a+y*c+b*p,this.values[6]=m*s+v*o+y*u+b*_,this.values[7]=m*n+v*l+y*d+b*f,m=t.at(8),v=t.at(9),y=t.at(10),b=t.at(11),this.values[8]=m*e+v*r+y*h+b*g,this.values[9]=m*i+v*a+y*c+b*p,this.values[10]=m*s+v*o+y*u+b*_,this.values[11]=m*n+v*l+y*d+b*f,m=t.at(12),v=t.at(13),y=t.at(14),b=t.at(15),this.values[12]=m*e+v*r+y*h+b*g,this.values[13]=m*i+v*a+y*c+b*p,this.values[14]=m*s+v*o+y*u+b*_,this.values[15]=m*n+v*l+y*d+b*f,this}multiplyVec3(t){const e=t.x,i=t.y,s=t.z;return new p([this.values[0]*e+this.values[4]*i+this.values[8]*s+this.values[12],this.values[1]*e+this.values[5]*i+this.values[9]*s+this.values[13],this.values[2]*e+this.values[6]*i+this.values[10]*s+this.values[14]])}multiplyVec4(t,e){e||(e=new c);const i=t.x,s=t.y,n=t.z,r=t.w;return e.x=this.values[0]*i+this.values[4]*s+this.values[8]*n+this.values[12]*r,e.y=this.values[1]*i+this.values[5]*s+this.values[9]*n+this.values[13]*r,e.z=this.values[2]*i+this.values[6]*s+this.values[10]*n+this.values[14]*r,e.w=this.values[3]*i+this.values[7]*s+this.values[11]*n+this.values[15]*r,e}toMat3(){return new d([this.values[0],this.values[1],this.values[2],this.values[4],this.values[5],this.values[6],this.values[8],this.values[9],this.values[10]])}toInverseMat3(){const t=this.values[0],e=this.values[1],i=this.values[2],s=this.values[4],n=this.values[5],r=this.values[6],a=this.values[8],o=this.values[9],l=this.values[10],h=l*n-r*o,c=-l*s+r*a,u=o*s-n*a;let g=t*h+e*c+i*u;return g?(g=1/g,new d([h*g,(-l*e+i*o)*g,(r*e-i*n)*g,c*g,(l*t-i*a)*g,(-r*t+i*s)*g,u*g,(-o*t+e*a)*g,(n*t-e*s)*g])):null}translate(t){const e=t.x,i=t.y,s=t.z;return this.values[12]+=this.values[0]*e+this.values[4]*i+this.values[8]*s,this.values[13]+=this.values[1]*e+this.values[5]*i+this.values[9]*s,this.values[14]+=this.values[2]*e+this.values[6]*i+this.values[10]*s,this.values[15]+=this.values[3]*e+this.values[7]*i+this.values[11]*s,this}scale(t){const e=t.x,i=t.y,s=t.z;return this.values[0]*=e,this.values[1]*=e,this.values[2]*=e,this.values[3]*=e,this.values[4]*=i,this.values[5]*=i,this.values[6]*=i,this.values[7]*=i,this.values[8]*=s,this.values[9]*=s,this.values[10]*=s,this.values[11]*=s,this}rotate(t,e){let i=e.x,s=e.y,n=e.z,r=Math.sqrt(i*i+s*s+n*n);if(!r)return null;1!==r&&(r=1/r,i*=r,s*=r,n*=r);const a=Math.sin(t),o=Math.cos(t),l=1-o,h=this.values[0],c=this.values[1],u=this.values[2],d=this.values[3],g=this.values[4],p=this.values[5],_=this.values[6],f=this.values[7],m=this.values[8],v=this.values[9],y=this.values[10],b=this.values[11],x=i*i*l+o,w=s*i*l+n*a,E=n*i*l-s*a,k=i*s*l-n*a,z=s*s*l+o,S=n*s*l+i*a,A=i*n*l+s*a,N=s*n*l-i*a,j=n*n*l+o;return this.values[0]=h*x+g*w+m*E,this.values[1]=c*x+p*w+v*E,this.values[2]=u*x+_*w+y*E,this.values[3]=d*x+f*w+b*E,this.values[4]=h*k+g*z+m*S,this.values[5]=c*k+p*z+v*S,this.values[6]=u*k+_*z+y*S,this.values[7]=d*k+f*z+b*S,this.values[8]=h*A+g*N+m*j,this.values[9]=c*A+p*N+v*j,this.values[10]=u*A+_*N+y*j,this.values[11]=d*A+f*N+b*j,this}static frustum(t,e,i,s,n,r){const a=e-t,o=s-i,l=r-n;return new u([2*n/a,0,0,0,0,2*n/o,0,0,(e+t)/a,(s+i)/o,-(r+n)/l,-1,0,0,-r*n*2/l,0])}static perspective(t,e,i,s){const n=i*Math.tan(t*Math.PI/360),r=n*e;return u.frustum(-r,r,-n,n,i,s)}static orthographic(t,e,i,s,n,r){const a=e-t,o=s-i,l=r-n;return new u([2/a,0,0,0,0,2/o,0,0,0,0,-2/l,0,-(t+e)/a,-(s+i)/o,-(r+n)/l,1])}static lookAt(t,e,i=p.up){if(t.equals(e))return this.identity;const s=p.difference(t,e).normalize(),n=p.cross(i,s).normalize(),r=p.cross(s,n).normalize();return new u([n.x,r.x,s.x,0,n.y,r.y,s.y,0,n.z,r.z,s.z,0,-p.dot(n,t),-p.dot(r,t),-p.dot(s,t),1])}static product(t,e,i){const s=t.at(0),n=t.at(1),r=t.at(2),a=t.at(3),o=t.at(4),l=t.at(5),h=t.at(6),c=t.at(7),d=t.at(8),g=t.at(9),p=t.at(10),_=t.at(11),f=t.at(12),m=t.at(13),v=t.at(14),y=t.at(15),b=e.at(0),x=e.at(1),w=e.at(2),E=e.at(3),k=e.at(4),z=e.at(5),S=e.at(6),A=e.at(7),N=e.at(8),j=e.at(9),O=e.at(10),L=e.at(11),C=e.at(12),M=e.at(13),T=e.at(14),I=e.at(15);return i?(i.init([b*s+x*o+w*d+E*f,b*n+x*l+w*g+E*m,b*r+x*h+w*p+E*v,b*a+x*c+w*_+E*y,k*s+z*o+S*d+A*f,k*n+z*l+S*g+A*m,k*r+z*h+S*p+A*v,k*a+z*c+S*_+A*y,N*s+j*o+O*d+L*f,N*n+j*l+O*g+L*m,N*r+j*h+O*p+L*v,N*a+j*c+O*_+L*y,C*s+M*o+T*d+I*f,C*n+M*l+T*g+I*m,C*r+M*h+T*p+I*v,C*a+M*c+T*_+I*y]),i):new u([b*s+x*o+w*d+E*f,b*n+x*l+w*g+E*m,b*r+x*h+w*p+E*v,b*a+x*c+w*_+E*y,k*s+z*o+S*d+A*f,k*n+z*l+S*g+A*m,k*r+z*h+S*p+A*v,k*a+z*c+S*_+A*y,N*s+j*o+O*d+L*f,N*n+j*l+O*g+L*m,N*r+j*h+O*p+L*v,N*a+j*c+O*_+L*y,C*s+M*o+T*d+I*f,C*n+M*l+T*g+I*m,C*r+M*h+T*p+I*v,C*a+M*c+T*_+I*y])}}u.identity=(new u).setIdentity();class d{constructor(t){this.values=new Float32Array(9),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<9;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<9;t++)this.values[t]=0}copy(t){t||(t=new d);for(let e=0;e<9;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<9;e++)t[e]=this.values[e];return t}row(t){return[this.values[3*t+0],this.values[3*t+1],this.values[3*t+2]]}col(t){return[this.values[t],this.values[t+3],this.values[t+6]]}equals(t,e=1e-5){for(let i=0;i<9;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}determinant(){const t=this.values[0],e=this.values[1],i=this.values[2],s=this.values[3],n=this.values[4],r=this.values[5],a=this.values[6],o=this.values[7],l=this.values[8];return t*(l*n-r*o)+e*(-l*s+r*a)+i*(o*s-n*a)}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=1,this.values[5]=0,this.values[6]=0,this.values[7]=0,this.values[8]=1,this}transpose(){const t=this.values[1],e=this.values[2],i=this.values[5];return this.values[1]=this.values[3],this.values[2]=this.values[6],this.values[3]=t,this.values[5]=this.values[7],this.values[6]=e,this.values[7]=i,this}inverse(){const t=this.values[0],e=this.values[1],i=this.values[2],s=this.values[3],n=this.values[4],r=this.values[5],a=this.values[6],o=this.values[7],l=this.values[8],h=l*n-r*o,c=-l*s+r*a,u=o*s-n*a;let d=t*h+e*c+i*u;return d?(d=1/d,this.values[0]=h*d,this.values[1]=(-l*e+i*o)*d,this.values[2]=(r*e-i*n)*d,this.values[3]=c*d,this.values[4]=(l*t-i*a)*d,this.values[5]=(-r*t+i*s)*d,this.values[6]=u*d,this.values[7]=(-o*t+e*a)*d,this.values[8]=(n*t-e*s)*d,this):null}multiply(t){const e=this.values[0],i=this.values[1],s=this.values[2],n=this.values[3],r=this.values[4],a=this.values[5],o=this.values[6],l=this.values[7],h=this.values[8],c=t.at(0),u=t.at(1),d=t.at(2),g=t.at(3),p=t.at(4),_=t.at(5),f=t.at(6),m=t.at(7),v=t.at(8);return this.values[0]=c*e+u*n+d*o,this.values[1]=c*i+u*r+d*l,this.values[2]=c*s+u*a+d*h,this.values[3]=g*e+p*n+_*o,this.values[4]=g*i+p*r+_*l,this.values[5]=g*s+p*a+_*h,this.values[6]=f*e+m*n+v*o,this.values[7]=f*i+m*r+v*l,this.values[8]=f*s+m*a+v*h,this}multiplyVec2(t,e){const i=t.x,s=t.y;return e?(e.xy=[i*this.values[0]+s*this.values[3]+this.values[6],i*this.values[1]+s*this.values[4]+this.values[7]],e):new _([i*this.values[0]+s*this.values[3]+this.values[6],i*this.values[1]+s*this.values[4]+this.values[7]])}multiplyVec3(t,e){const i=t.x,s=t.y,n=t.z;return e?(e.xyz=[i*this.values[0]+s*this.values[3]+n*this.values[6],i*this.values[1]+s*this.values[4]+n*this.values[7],i*this.values[2]+s*this.values[5]+n*this.values[8]],e):new p([i*this.values[0]+s*this.values[3]+n*this.values[6],i*this.values[1]+s*this.values[4]+n*this.values[7],i*this.values[2]+s*this.values[5]+n*this.values[8]])}toMat4(t){return t?(t.init([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1]),t):new u([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1])}toQuat(){const t=this.values[0],e=this.values[1],i=this.values[2],s=this.values[3],n=this.values[4],r=this.values[5],a=this.values[6],o=this.values[7],l=this.values[8],h=t-n-l,c=n-t-l,u=l-t-n;let d=0,p=t+n+l;h>p&&(p=h,d=1),c>p&&(p=c,d=2),u>p&&(p=u,d=3);const _=.5*Math.sqrt(p+1),f=.25/_,m=new g;switch(d){case 0:m.w=_,m.x=(r-o)*f,m.y=(a-i)*f,m.z=(e-s)*f;break;case 1:m.w=(r-o)*f,m.x=_,m.y=(e+s)*f,m.z=(a+i)*f;break;case 2:m.w=(a-i)*f,m.x=(e+s)*f,m.y=_,m.z=(r+o)*f;break;case 3:m.w=(e-s)*f,m.x=(a+i)*f,m.y=(r+o)*f,m.z=_}return m}rotate(t,e){let i=e.x,s=e.y,n=e.z,r=Math.sqrt(i*i+s*s+n*n);if(!r)return null;1!==r&&(r=1/r,i*=r,s*=r,n*=r);const a=Math.sin(t),o=Math.cos(t),l=1-o,h=this.values[0],c=this.values[1],u=this.values[2],d=this.values[4],g=this.values[5],p=this.values[6],_=this.values[8],f=this.values[9],m=this.values[10],v=i*i*l+o,y=s*i*l+n*a,b=n*i*l-s*a,x=i*s*l-n*a,w=s*s*l+o,E=n*s*l+i*a,k=i*n*l+s*a,z=s*n*l-i*a,S=n*n*l+o;return this.values[0]=h*v+d*y+_*b,this.values[1]=c*v+g*y+f*b,this.values[2]=u*v+p*y+m*b,this.values[3]=h*x+d*w+_*E,this.values[4]=c*x+g*w+f*E,this.values[5]=u*x+p*w+m*E,this.values[6]=h*k+d*z+_*S,this.values[7]=c*k+g*z+f*S,this.values[8]=u*k+p*z+m*S,this}static product(t,e,i){const s=t.at(0),n=t.at(1),r=t.at(2),a=t.at(3),o=t.at(4),l=t.at(5),h=t.at(6),c=t.at(7),u=t.at(8),g=e.at(0),p=e.at(1),_=e.at(2),f=e.at(3),m=e.at(4),v=e.at(5),y=e.at(6),b=e.at(7),x=e.at(8);return i?(i.init([g*s+p*a+_*h,g*n+p*o+_*c,g*r+p*l+_*u,f*s+m*a+v*h,f*n+m*o+v*c,f*r+m*l+v*u,y*s+b*a+x*h,y*n+b*o+x*c,y*r+b*l+x*u]),i):new d([g*s+p*a+_*h,g*n+p*o+_*c,g*r+p*l+_*u,f*s+m*a+v*h,f*n+m*o+v*c,f*r+m*l+v*u,y*s+b*a+x*h,y*n+b*o+x*c,y*r+b*l+x*u])}}d.identity=(new d).setIdentity();class g{constructor(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get w(){return this.values[3]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}get xyzw(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set w(t){this.values[3]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set xyzw(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}at(t){return this.values[t]}reset(){for(let t=0;t<4;t++)this.values[t]=0}copy(t){t||(t=new g);for(let e=0;e<4;e++)t.values[e]=this.values[e];return t}roll(){const t=this.x,e=this.y,i=this.z,s=this.w;return Math.atan2(2*(t*e+s*i),s*s+t*t-e*e-i*i)}pitch(){const t=this.x,e=this.y,i=this.z,s=this.w;return Math.atan2(2*(e*i+s*t),s*s-t*t-e*e+i*i)}yaw(){return Math.asin(2*(this.x*this.z-this.w*this.y))}equals(t,e=1e-5){for(let i=0;i<4;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}setIdentity(){return this.x=0,this.y=0,this.z=0,this.w=1,this}calculateW(){const t=this.x,e=this.y,i=this.z;return this.w=-Math.sqrt(Math.abs(1-t*t-e*e-i*i)),this}inverse(){const t=g.dot(this,this);if(!t)return this.xyzw=[0,0,0,0],this;const e=t?1/t:0;return this.x*=-e,this.y*=-e,this.z*=-e,this.w*=e,this}conjugate(){return this.values[0]*=-1,this.values[1]*=-1,this.values[2]*=-1,this}length(){const t=this.x,e=this.y,i=this.z,s=this.w;return Math.sqrt(t*t+e*e+i*i+s*s)}normalize(t){t||(t=this);const e=this.x,i=this.y,s=this.z,n=this.w;let r=Math.sqrt(e*e+i*i+s*s+n*n);return r?(r=1/r,t.x=e*r,t.y=i*r,t.z=s*r,t.w=n*r,t):(t.x=0,t.y=0,t.z=0,t.w=0,t)}add(t){for(let e=0;e<4;e++)this.values[e]+=t.at(e);return this}multiply(t){const e=this.values[0],i=this.values[1],s=this.values[2],n=this.values[3],r=t.x,a=t.y,o=t.z,l=t.w;return this.x=e*l+n*r+i*o-s*a,this.y=i*l+n*a+s*r-e*o,this.z=s*l+n*o+e*a-i*r,this.w=n*l-e*r-i*a-s*o,this}multiplyVec3(t,e){e||(e=new p);const i=t.x,s=t.y,n=t.z,r=this.x,a=this.y,o=this.z,l=this.w,h=l*i+a*n-o*s,c=l*s+o*i-r*n,u=l*n+r*s-a*i,d=-r*i-a*s-o*n;return e.x=h*l+d*-r+c*-o-u*-a,e.y=c*l+d*-a+u*-r-h*-o,e.z=u*l+d*-o+h*-a-c*-r,e}toMat3(t){t||(t=new d);const e=this.x,i=this.y,s=this.z,n=this.w,r=e+e,a=i+i,o=s+s,l=e*r,h=e*a,c=e*o,u=i*a,g=i*o,p=s*o,_=n*r,f=n*a,m=n*o;return t.init([1-(u+p),h+m,c-f,h-m,1-(l+p),g+_,c+f,g-_,1-(l+u)]),t}toMat4(t){t||(t=new u);const e=this.x,i=this.y,s=this.z,n=this.w,r=e+e,a=i+i,o=s+s,l=e*r,h=e*a,c=e*o,d=i*a,g=i*o,p=s*o,_=n*r,f=n*a,m=n*o;return t.init([1-(d+p),h+m,c-f,0,h-m,1-(l+p),g+_,0,c+f,g-_,1-(l+d),0,0,0,0,1]),t}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static sum(t,e,i){return i||(i=new g),i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i.w=t.w+e.w,i}static product(t,e,i){i||(i=new g);const s=t.x,n=t.y,r=t.z,a=t.w,o=e.x,l=e.y,h=e.z,c=e.w;return i.x=s*c+a*o+n*h-r*l,i.y=n*c+a*l+r*o-s*h,i.z=r*c+a*h+s*l-n*o,i.w=a*c-s*o-n*l-r*h,i}static cross(t,e,i){i||(i=new g);const s=t.x,n=t.y,r=t.z,a=t.w,o=e.x,l=e.y,h=e.z,c=e.w;return i.x=a*h+r*c+s*l-n*o,i.y=a*c-s*o-n*l-r*h,i.z=a*o+s*c+n*h-r*l,i.w=a*l+n*c+r*o-s*h,i}static shortMix(t,e,i,s){if(s||(s=new g),i<=0)return s.xyzw=t.xyzw,s;if(i>=1)return s.xyzw=e.xyzw,s;let n=g.dot(t,e);const r=e.copy();let a,o;if(n<0&&(r.inverse(),n=-n),n>.9999)a=1-i,o=0+i;else{const t=Math.sqrt(1-n*n),e=Math.atan2(t,n),s=1/t;a=Math.sin((1-i)*e)*s,o=Math.sin((0+i)*e)*s}return s.x=a*t.x+o*r.x,s.y=a*t.y+o*r.y,s.z=a*t.z+o*r.z,s.w=a*t.w+o*r.w,s}static mix(t,e,i,s){s||(s=new g);const n=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w;if(Math.abs(n)>=1)return s.xyzw=t.xyzw,s;const r=Math.acos(n),a=Math.sqrt(1-n*n);if(Math.abs(a)<.001)return s.x=.5*t.x+.5*e.x,s.y=.5*t.y+.5*e.y,s.z=.5*t.z+.5*e.z,s.w=.5*t.w+.5*e.w,s;const o=Math.sin((1-i)*r)/a,l=Math.sin(i*r)/a;return s.x=t.x*o+e.x*l,s.y=t.y*o+e.y*l,s.z=t.z*o+e.z*l,s.w=t.w*o+e.w*l,s}static fromAxisAngle(t,e,i){i||(i=new g),e*=.5;const s=Math.sin(e);return i.x=t.x*s,i.y=t.y*s,i.z=t.z*s,i.w=Math.cos(e),i}}g.identity=(new g).setIdentity();class p{constructor(t){this.values=new Float32Array(3),void 0!==t&&(this.xyz=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}at(t){return this.values[t]}reset(){this.x=0,this.y=0,this.z=0}copy(t){return t||(t=new p),t.x=this.x,t.y=this.y,t.z=this.z,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t}equals(t,e=1e-5){return!(Math.abs(this.x-t.x)>e)&&(!(Math.abs(this.y-t.y)>e)&&!(Math.abs(this.z-t.z)>e))}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e.z*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x=0,t.y=0,t.z=0,t):(e=1/e,t.x*=e,t.y*=e,t.z*=e,t)}multiplyByMat3(t,e){return e||(e=this),t.multiplyVec3(this,e)}multiplyByQuat(t,e){return e||(e=this),t.multiplyVec3(this,e)}toQuat(t){t||(t=new g);const e=new p,i=new p;return e.x=Math.cos(.5*this.x),i.x=Math.sin(.5*this.x),e.y=Math.cos(.5*this.y),i.y=Math.sin(.5*this.y),e.z=Math.cos(.5*this.z),i.z=Math.sin(.5*this.z),t.x=i.x*e.y*e.z-e.x*i.y*i.z,t.y=e.x*i.y*e.z+i.x*e.y*i.z,t.z=e.x*e.y*i.z-i.x*i.y*e.z,t.w=e.x*e.y*e.z+i.x*i.y*i.z,t}static cross(t,e,i){i||(i=new p);const s=t.x,n=t.y,r=t.z,a=e.x,o=e.y,l=e.z;return i.x=n*l-r*o,i.y=r*a-s*l,i.z=s*o-n*a,i}static dot(t,e){const i=t.x,s=t.y,n=t.z;return i*e.x+s*e.y+n*e.z}static distance(t,e){e.x,t.x,e.y,t.y,e.z,t.z;return Math.sqrt(this.squaredDistance(t,e))}static squaredDistance(t,e){const i=e.x-t.x,s=e.y-t.y,n=e.z-t.z;return i*i+s*s+n*n}static direction(t,e,i){i||(i=new p);const s=t.x-e.x,n=t.y-e.y,r=t.z-e.z;let a=Math.sqrt(s*s+n*n+r*r);return 0===a?(i.x=0,i.y=0,i.z=0,i):(a=1/a,i.x=s*a,i.y=n*a,i.z=r*a,i)}static mix(t,e,i,s){return s||(s=new p),s.x=t.x+i*(e.x-t.x),s.y=t.y+i*(e.y-t.y),s.z=t.z+i*(e.z-t.z),s}static sum(t,e,i){return i||(i=new p),i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i}static difference(t,e,i){return i||(i=new p),i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i}static product(t,e,i){return i||(i=new p),i.x=t.x*e.x,i.y=t.y*e.y,i.z=t.z*e.z,i}static quotient(t,e,i){return i||(i=new p),i.x=t.x/e.x,i.y=t.y/e.y,i.z=t.z/e.z,i}}p.zero=new p([0,0,0]),p.one=new p([1,1,1]),p.up=new p([0,1,0]),p.right=new p([1,0,0]),p.forward=new p([0,0,1]);class _{constructor(t){this.values=new Float32Array(2),void 0!==t&&(this.xy=t)}get x(){return this.values[0]}get y(){return this.values[1]}get xy(){return[this.values[0],this.values[1]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}at(t){return this.values[t]}reset(){this.x=0,this.y=0}copy(t){return t||(t=new _),t.x=this.x,t.y=this.y,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t}equals(t,e=1e-5){return!(Math.abs(this.x-t.x)>e)&&!(Math.abs(this.y-t.y)>e)}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y;return t*t+e*e}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}divide(t){return this.x/=t.x,this.y/=t.y,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x=0,t.y=0,t):(e=1/e,t.x*=e,t.y*=e,t)}multiplyMat2(t,e){return e||(e=this),t.multiplyVec2(this,e)}multiplyMat3(t,e){return e||(e=this),t.multiplyVec2(this,e)}static cross(t,e,i){i||(i=new p);const s=t.x,n=t.y,r=e.x,a=s*e.y-n*r;return i.x=0,i.y=0,i.z=a,i}static dot(t,e){return t.x*e.x+t.y*e.y}static distance(t,e){return Math.sqrt(this.squaredDistance(t,e))}static squaredDistance(t,e){const i=e.x-t.x,s=e.y-t.y;return i*i+s*s}static direction(t,e,i){i||(i=new _);const s=t.x-e.x,n=t.y-e.y;let r=Math.sqrt(s*s+n*n);return 0===r?(i.x=0,i.y=0,i):(r=1/r,i.x=s*r,i.y=n*r,i)}static mix(t,e,i,s){s||(s=new _);const n=t.x,r=t.y,a=e.x,o=e.y;return s.x=n+i*(a-n),s.y=r+i*(o-r),s}static sum(t,e,i){return i||(i=new _),i.x=t.x+e.x,i.y=t.y+e.y,i}static difference(t,e,i){return i||(i=new _),i.x=t.x-e.x,i.y=t.y-e.y,i}static product(t,e,i){return i||(i=new _),i.x=t.x*e.x,i.y=t.y*e.y,i}static quotient(t,e,i){return i||(i=new _),i.x=t.x/e.x,i.y=t.y/e.y,i}}_.zero=new _([0,0]),_.one=new _([1,1]);class f{constructor(t){this.values=new Float32Array(4),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<4;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<4;t++)this.values[t]=0}copy(t){t||(t=new f);for(let e=0;e<4;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<4;e++)t[e]=this.values[e];return t}row(t){return[this.values[2*t+0],this.values[2*t+1]]}col(t){return[this.values[t],this.values[t+2]]}equals(t,e=1e-5){for(let i=0;i<4;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}determinant(){return this.values[0]*this.values[3]-this.values[2]*this.values[1]}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=1,this}transpose(){const t=this.values[1];return this.values[1]=this.values[2],this.values[2]=t,this}inverse(){let t=this.determinant();if(!t)return null;t=1/t;const e=this.values[0];return this.values[0]=t*this.values[3],this.values[1]=t*-this.values[1],this.values[2]=t*-this.values[2],this.values[3]=t*e,this}multiply(t){const e=this.values[0],i=this.values[1],s=this.values[2],n=this.values[3];return this.values[0]=e*t.at(0)+i*t.at(2),this.values[1]=e*t.at(1)+i*t.at(3),this.values[2]=s*t.at(0)+n*t.at(2),this.values[3]=s*t.at(1)+n*t.at(3),this}rotate(t){const e=this.values[0],i=this.values[1],s=this.values[2],n=this.values[3],r=Math.sin(t),a=Math.cos(t);return this.values[0]=e*a+i*r,this.values[1]=e*-r+i*a,this.values[2]=s*a+n*r,this.values[3]=s*-r+n*a,this}multiplyVec2(t,e){const i=t.x,s=t.y;return e?(e.xy=[i*this.values[0]+s*this.values[1],i*this.values[2]+s*this.values[3]],e):new _([i*this.values[0]+s*this.values[1],i*this.values[2]+s*this.values[3]])}scale(t){const e=this.values[0],i=this.values[1],s=this.values[2],n=this.values[3],r=t.x,a=t.y;return this.values[0]=e*r,this.values[1]=i*a,this.values[2]=s*r,this.values[3]=n*a,this}static product(t,e,i){const s=t.at(0),n=t.at(1),r=t.at(2),a=t.at(3);return i?(i.init([s*e.at(0)+n*e.at(2),s*e.at(1)+n*e.at(3),r*e.at(0)+a*e.at(2),r*e.at(1)+a*e.at(3)]),i):new f([s*e.at(0)+n*e.at(2),s*e.at(1)+n*e.at(3),r*e.at(0)+a*e.at(2),r*e.at(1)+a*e.at(3)])}}f.identity=(new f).setIdentity();class m{constructor(){this.hovered_objects=[],this.cursor_pos=new _([0,0]),this.old_cursor_pos=new _([0,0]),this.cursor_offset=new _([0,0])}bindCanvas(t,e){this.canvas=t,document.onmousedown=this.onMouseDown.bind(this),document.onmouseup=this.onMouseUp.bind(this),document.onmousemove=this.onMouseMove.bind(this),this.canvas.onwheel=this.onCanvasScroll.bind(this),this.canvas.ondblclick=this.onDblCLick.bind(this),this.object_detector=e}bindScene(t){this.scene=t}onMouseDown(t){const e=this.canvas.getBoundingClientRect();t.clientX>e.left&&t.clientX<e.right&&t.clientY>e.top&&t.clientY<e.bottom&&(this.old_cursor_pos.xy=[t.clientX,t.clientY],this.cursor_pos.xy=this.old_cursor_pos.xy,this.mouse_moved=!1,this.mouse_pressed=!0)}onMouseUp(t){this.mouse_pressed&&this.hovered_objects.length>0&&(this.mouse_moved?this.hovered_objects[0].onDragEnd&&this.hovered_objects[0].onDragEnd(this.hovered_objects[0]):this.hovered_objects[0].onClick&&this.hovered_objects[0].onClick(this.hovered_objects[0],t)),this.mouse_moved=!1,this.mouse_pressed=!1}onMouseMove(t){const e=this.canvas.width/this.canvas.height;if(this.cursor_pos.x=t.clientX,this.cursor_pos.y=t.clientY,this.mouse_pressed)this.cursor_offset.x=2*(this.cursor_pos.x-this.old_cursor_pos.x)*m.mouse_sensitivity*e/this.canvas.width,this.cursor_offset.y=-2*(this.cursor_pos.y-this.old_cursor_pos.y)*m.mouse_sensitivity/this.canvas.height,this.hovered_objects.length>0&&this.hovered_objects[0].onDrag?this.hovered_objects[0].onDrag(this.hovered_objects[0],this.cursor_offset):0==this.hovered_objects.length&&this.scene.onDrag&&this.scene.onDrag(this.scene,this.cursor_offset),this.old_cursor_pos.x=this.cursor_pos.x,this.old_cursor_pos.y=this.cursor_pos.y,this.mouse_moved=!0;else{const t=this.object_detector(this.cursor_pos);this.hovered_objects.filter(e=>-1==t.indexOf(e)&&e.onLeave).forEach(t=>t.onLeave(t)),t.filter(t=>-1==this.hovered_objects.indexOf(t)&&t.onEnter).forEach(t=>t.onEnter(t)),this.hovered_objects=t}}onDblCLick(t){this.hovered_objects.length>0&&this.hovered_objects[0].onDblClick&&this.hovered_objects[0].onDblClick(this.hovered_objects[0],t)}onCanvasScroll(t){this.scene.onZoom&&this.scene.onZoom(this.scene,t.deltaY/-100,this.cursor_pos)}}m.mouse_sensitivity=1;class v{compile(t,e){const i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,e.vertex_shader),t.compileShader(i);let s=t.getShaderParameter(i,t.COMPILE_STATUS);if(!s)return alert(t.getShaderInfoLog(i)),null;const n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,e.fragment_shader),t.compileShader(n),s=t.getShaderParameter(n,t.COMPILE_STATUS),!s)return t.deleteShader(i),alert(t.getShaderInfoLog(n)),null;const r=t.createProgram();if(t.attachShader(r,i),t.attachShader(r,n),t.linkProgram(r),s=t.getProgramParameter(r,t.LINK_STATUS),!s)return null;return{program:r,attributes:v.getAttributeLocations(t,r,e.attributes),uniforms:v.getUniformLocations(t,r,e.uniforms)}}static getAttributeLocations(t,e,i){let s={};for(let n=0;n<i.length;++n){let r=i[n],a=-1;if(a=t.getAttribLocation(e,r),-1===a)throw new Error("Program doesn't have required attribute: "+r);s[i[n]]=a}return s}static getUniformLocations(t,e,i){let s={};for(let n=0;n<i.length;++n){let r=i[n];{let a=t.getUniformLocation(e,r);if(null===a)throw new Error("Program doesn't have required uniform: "+r);s[i[n]]=a}}return s}}const y=new v,{abs:b,atan2:x,cos:w,floor:E,log:k,min:z,max:S,round:A,sign:N,sin:j,sqrt:O,cbrt:L,PI:C,hypot:M}=Math;
/**
 * @license
 *
 * js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2017, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */function T(t,e,i){return t+(e-t)*i}function I(t,e=0,i=1){return t<e?e:t>i?i:t}function F(t,e,i,s=1e-8){let n,r=e;for(;i--&&b(n=t(r))>s;){const e=(t(r+s)-n)/s;console.log("fx / dfdx",n/e,"fx",n,"x",r),r-=n/e}return r}const P=C/180,R=180/C;function B(...t){return t[0]instanceof D?t[0]:t.length>1&&"string"==typeof t[t.length-1]?nt(t.slice(0,t.length-1),t[t.length-1]):Array.isArray(t[0])?nt(t[0]):nt(t)}class D{constructor(t,e,i,s=1){this.r=t,this.g=e,this.b=i,this.a=s}mix(t,e,i="rgb"){return H(this,t,e,i)}rgb(t=!0,e=!0){const i=i=>(t&&(i=A(i)),e&&(i=I(i,0,255)),i),{r:s,g:n,b:r}=this;return[i(s),i(n),i(r)]}rgba(t=!0,e=!0){const i=i=>(t&&(i=A(i)),e&&(i=I(i,0,255)),i),{r:s,g:n,b:r,a:a}=this;return[i(s),i(n),i(r),a]}hex(t="rgb"){const{r:e,g:i,b:s,a:n}=this;return function(t,e,i,s,n="rgb"){t=I(A(t),0,255),e=I(A(e),0,255),i=I(A(i),0,255);const r=(t<<16|e<<8|i).toString(16).padStart(6,"0"),a=A(255*I(s)).toString(16).padStart(2,"0");return"#"+("argb"==n?a+r:"rgba"==n?r+a:r)}(e,i,s,n,t)}hsl(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[s,n,r]=Et(t/255,e/255,i/255),a=(r+n)/2;let o;o=r==n?0:a<.5?(r-n)/(r+n):(r-n)/(2-r-n);return[s,o,a]}(t,e,i)}hsv(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[s,n,r]=Et(t,e,i),a=r-n;return[s,0==r?0:a/r,r/255]}(t,e,i)}hcg(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[s,n,r]=Et(t,e,i),a=(r-n)/255;return[s,a,a<1?n/255/(1-a):0]}(t,e,i)}css(t="rgb"){if("rgb"==t){const{r:t,g:e,b:i,a:s}=this;return function(t,e,i,s=1){return s>=1?"rgb("+[t,e,i].map(A).join(",")+")":"rgba("+[t,e,i].map(A).join(",")+","+s+")"}(t,e,i,s)}if("hsl"==t)return function([t,e,i],s){const n=s<1?"hsla":"hsl";return n+"("+mt(t)+","+mt(100*e)+"%,"+mt(100*i)+"%"+("hsla"==n?","+mt(s):"")+")"}(this.hsl(),this.alpha());throw new Error}name(t=!1){const e=this.num(),i=Object.keys(q).find(t=>q[t]==e);if(!i&&t){const[t,e,i]=this.lab();return(s=Object.keys(q))[Pt(s,s=>{const[n,r,a]=K(q[s]).lab();return-M(t-n,e-r,i-a)})]}var s;return i}cmyk(){const{r:t,g:e,b:i}=this;return function(t,e,i){const s=1-S(t/=255,e/=255,i/=255);if(1==s)return[0,0,0,1];return[(1-t-s)/(1-s),(1-e-s)/(1-s),(1-i-s)/(1-s),s]}(t,e,i)}gl(){const{r:t,g:e,b:i,a:s}=this;return[t/255,e/255,i/255,s]}luminance(t){const{r:e,g:i,b:s,a:n}=this,[,r]=It(e,i,s);if(void 0===t)return r;const a=(t,e,i)=>(i-t)/(e-t);return t>r?H(this,G,a(r,1,t),"xyz").alpha(n):H(U,this,a(0,r,t),"xyz").alpha(n)}temperature(){const{r:t,g:e,b:i}=this;return s=t,n=e,r=i,console.log(r-s),n+r<158.61?(console.log("0 < t < 20"),A(100*F(t=>n-(-155.25485562709179-.44596950469579133*(t-2)+104.49216199393888*k(t-2)),15,4))):r-s<0?(console.log("20 < t < 66"),A(100*F(t=>r-(.8274096064007395*(t-10)-254.76935184120902+115.67994401066147*k(t-10)),43,4))):(console.log("0 < t < 400, start= "+(-1.4*(s+n)+755)),A(100*F(t=>s-(351.97690566805693+.114206453784165*(t-55)-40.25366309332127*k(t-55)),-1.4*(s+n)+755,8)));var s,n,r}set(t,e){const[i,s]=t.split("."),n=this[i](),r=i.indexOf(s);if(-1==r)throw new Error("invalid channel");return n[r]="number"==typeof e?e:e(n[r]),B(n,i).alpha(this.a)}clipped(){const{r:t,g:e,b:i}=this;return!(0<=t&&t<=255&&0<=e&&e<=255&&0<=i&&i<=255)}textColor(){return this.luminance()>.5?U:G}alpha(t){if(void 0===t)return this.a;const{r:e,g:i,b:s}=this;return X(e,i,s,t)}darker(t=1){const[e,i,s]=this.lab();return Y(e-At*t,i,s,this.alpha())}brighter(t=1){return this.darker(-t)}saturate(t=1){const[e,i,s]=this.lch();return function(...t){return nt(t,"lch")}(e,S(0,i+t*At),s,this.alpha())}desaturate(t=1){return this.saturate(-t)}premultiplied(){const{r:t,g:e,b:i,a:s}=this;return X(t*s,e*s,i*s,s)}hsi(){const{r:t,g:e,b:i}=this;return function(t,e,i){const s=t/255,n=e/255,r=i/255,a=(s+n+r)/3;if(s==n&&n==r)return[0,0,a];{const t=.5*(2*s-n-r),e=O(3)/2*(n-r),i=x(e,t),o=z(s,n,r);return[(i<0?2*C+i:i)*R,1-o/a,a]}}(t,e,i)}lab(){const{r:t,g:e,b:i}=this;return Tt(t,e,i)}num(t="rgb"){const{r:e,g:i,b:s,a:n}=this;return function(t,e,i,s=1,n="rgb"){const r=A(t)<<16|A(e)<<8|A(i);return"rgb"===n?r:"rgba"===n?r<<8|A(255*s)<<24:A(255*s)<<24|r}(e,i,s,n,t)}lch(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[s,n,r]=Tt(t,e,i);return function(t,e,i){const s=M(e,i),n=(x(i,e)*R+360)%360;return[t,s,n]}(s,n,r)}(t,e,i)}xyz(){const{r:t,g:e,b:i}=this;return It(t,e,i)}equals(t){const{r:e,g:i,b:s,a:n}=this,{r:r,g:a,b:o,a:l}=t;return e==r&&i==a&&s==o&&n==l}hashCode(){return this.num("rgba")}toSource(){const{r:t,g:e,b:i,a:s}=this;return"chroma.rgb("+t+", "+e+", "+i+(1===s?")":", "+s+")")}}D.prototype.toString=D.prototype.css,D.prototype.kelvin=D.prototype.temperature;const U=new D(0,0,0,1),G=new D(255,255,255,1),V={OrRd:[16775148,16705736,16635038,16628612,16551257,15689032,14102559,11730944,8323072],PuBu:[16775163,15525874,13685222,10927579,7645647,3576e3,356528,285325,145496],BuPu:[16252157,14740724,12571622,10403034,9213638,9202609,8929693,8458108,5046347],Oranges:[16774635,16705230,16634018,16625259,16616764,15821075,14239745,10892803,8333060],BuGn:[16252157,15070713,13429990,10082505,6734500,4304502,2329413,27948,17435],YlOrBr:[16777189,16775100,16704401,16696399,16685353,15495188,13388802,10040324,6694150],YlGn:[16777189,16252089,14282915,11394446,7915129,4303709,2327619,26679,17705],Reds:[16774640,16703698,16563105,16552562,16476746,15678252,13309981,10817301,6750221],RdPu:[16775155,16638173,16565696,16424885,16214177,14496919,11403646,7995767,4784234],Greens:[16252149,15070688,13101504,10607003,7652470,4303709,2329413,27948,17435],YlGnBu:[16777177,15595697,13101492,8375739,4306628,1937856,2252456,2438292,531800],Purples:[16579581,15724021,14342891,12369372,10394312,8420794,6967715,5515151,4128893],GnBu:[16252144,14742491,13429701,11066805,8113348,5157843,2854078,551084,540801],Greys:[16777215,15790320,14277081,12434877,9868950,7566195,5395026,2434341,0],YlOrRd:[16777164,16772512,16701814,16691788,16616764,16535082,14883356,12386342,8388646],PuRd:[16250105,15196655,13941210,13210823,14640560,15149450,13505110,9961539,6750239],Blues:[16251903,14609399,13032431,10406625,7057110,4362950,2191797,545180,536683],PuBuGn:[16775163,15524592,13685222,10927579,6793679,3576e3,164234,93273,83510],Viridis:[4456788,4728695,4147850,3237774,2524047,2071946,7130714,11984427,16705573],Spectral:[10355010,13975119,16018755,16625249,16703627,16777151,15136152,11263396,6734501,3311805,6180770],RdYlGn:[10813478,14102567,16018755,16625249,16703627,16777151,14282635,10934634,6733155,1742928,26679],RdBu:[6750239,11671595,14049357,16033154,16636871,16250871,13755888,9618910,4428739,2188972,340065],PiYG:[9306450,12917629,14579630,15840986,16638191,16250871,15136208,12116358,8371265,5083681,2581529],PRGn:[4194379,7744131,10055851,12756431,15193320,16250871,14282963,10935200,5942881,1800247,17435],RdYlBu:[10813478,14102567,16018755,16625249,16703632,16777151,14742520,11262441,7646673,4552116,3225237],BrBG:[5517317,9195786,12550445,14664317,16181443,16119285,13101797,8441281,3512207,91742,15408],RdGy:[6750239,11671595,14049357,16033154,16636871,16777215,14737632,12237498,8882055,5066061,1710618],PuOr:[8338184,11753478,14713364,16627811,16703670,16250871,14211819,11709394,8418220,5515144,2949195],Set2:[6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947],Accent:[8374655,12496596,16629894,16777113,3697840,15729279,12540695,6710886],Set1:[14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329],Set3:[9294791,16777139,12499674,16482418,8434131,16626786,11787881,16567781,14277081,12353725,13429701,16772463],Dark2:[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886],Paired:[10931939,2062516,11722634,3383340,16489113,14883356,16629615,16744192,13284054,6962586,16777113,11622696],Pastel2:[11789005,16633260,13358568,16042724,15136201,16773806,15852236,13421772],Pastel1:[16495790,11783651,13429701,14601188,16701862,16777164,15063229,16636652,15921906]},q={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflower:6591981,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,laserlemon:16777044,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrod:16448210,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,maroon2:8323072,maroon3:11546720,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,purple2:8323199,purple3:10494192,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function H(t,e,i=.5,s="rgb"){const n=B(t),r=B(e),a=it[s]&&it[s](n,r,i,s);if(!a)throw new Error("color mode "+s+" is not supported");return a.alpha(T(n.alpha(),r.alpha(),i))}function W(...t){return nt(t,"hsl")}function Y(...t){return nt(t,"lab")}function K(t){const[e,i,s]=ot(t);return new D(e,i,s)}function X(...t){return nt(t,"rgb")}xt(wt((t,e)=>t)),xt(wt((t,e)=>t*e/255)),xt(wt((function(t,e){return 255*(1-(1-t/255)*(1-e/255))}))),xt(wt((function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))}))),xt(wt(z)),xt(wt(S)),xt(wt((function(t,e){if(255==t)return 255;return 255*z(1,e/255/(1-t/255))}))),xt(wt((function(t,e){return 255*(1-(1-e/255)/(t/255))})));function J(...t){const e=t=>e._at(t);return Object.getOwnPropertyNames(Z.prototype).forEach(t=>e[t]=Z.prototype[t]),Array.isArray(t[0])&&(t=t[0]),1==t.length&&"string"==typeof t[0]&&(t=V[t[0]]),e._init("function"==typeof t[0]?t[0]:t.map(t=>B(t))),e}class Z{classes(t){if(void 0===t)return this._classes;if(Array.isArray(t))this._classes=t,this.domain(t[0],t[t.length-1]);else{if(t%1!=0||t<1)throw new Error("invalid classes param");this._classes=et(this.domain(),"e",t)}return this}domain(...t){if(void 0===t[0])return"function"!=typeof this._colors?this._pos.map(t=>T(this._min,this._max,t)):[this._min,this._max];if(this._min=t[0],this._max=t[t.length-1],2==t.length)"function"!=typeof this._colors&&(this._pos=this._colors.map((t,e)=>e/(this._colors.length-1)));else{if("function"==typeof this._colors||t.length!=this._colors.length)throw new Error("invalid domain "+t);this._pos=t.map(t=>{return e=this._min,i=this._max,(t-e)/(i-e);var e,i})}return this}mode(t){return void 0===t?this._mode:(this._mode=t,this._resetCache(),this)}out(t){return this._out=t,this}correctLightness(t=!0){if(this._correctLightness!=t){this._resetCache();const e=this._colors;if(t&&"function"!=typeof e){let t=0;for(let i=1;i<e.length;i++){const s=e[i].lab()[0]-e[i-1].lab()[0];if(0==t)t=s;else if(t*s<0)throw new Error("scale color lightnesses must be monotonic")}}}return this._correctLightness=t,this}padding(t,e=t){return t?(this._paddingLeft=t,this._paddingRight=e,this):[this._paddingLeft,this._paddingRight]}colors(t,e="hex"){let i;if(void 0===t)i=this._colors.slice();else if(1==t)i=[this._color((this._min+this._max)/2)];else if(t>1)i=Array.from({length:t},(e,i)=>this._color(T(this._min,this._max,i/(t-1))));else{let t;t=this._classes&&this._classes.length>2?Array.from({length:this._classes.length-1},(t,e)=>.5*(this._classes[e]+this._classes[e+1])):this.domain(),i=t.map(t=>this._color(t))}return"color"!=e?i.map(t=>t[e]()):i}cache(t){return void 0===t?!!this._cache:(this._cache=t?this._cache||new Map:void 0,this)}gamma(t){return void 0===t?this._gamma:(this._gamma=t,this)}_at(t){const e=this._color(t);return this._out?e[this._out]():e}_init(t){this._colors=t,"function"!=typeof t&&(this._pos=t.map((e,i)=>i/(t.length-1))),this._mode="rgb",this.domain(0,1),this._paddingLeft=0,this._paddingRight=0,this._correctLightness=!1,this._cache=new Map,this._gamma=1}_getClass(t){return this._classes.findIndex(e=>t<=e)-1}_color(t,e=!1){let i;if(e)i=t;else{const e=this._min,s=this._max;if(this._classes&&this._classes.length>2){i=this._getClass(t)/(this._classes.length-2)}else i=s!==e?(t-e)/(s-e):1;this._correctLightness&&(i=this._tCorrectedLightness(i))}i=i**this._gamma,i=(this._paddingLeft+i)/(1+this._paddingLeft+this._paddingRight),i=I(i,0,1);const s=i,n=this._cache&&this._cache.get(s);if(n)return n;{let t;if(Array.isArray(this._colors))for(let e=0;e<this._pos.length;e++){const s=this._pos[e];if(i<=s){t=this._colors[e];break}if(i>=s&&e==this._pos.length-1){t=this._colors[e];break}if(i>s&&i<this._pos[e+1]){i=(i-s)/(this._pos[e+1]-s),t=H(this._colors[e],this._colors[e+1],i,this._mode);break}}else t=this._colors(i);return this._cache&&this._cache.set(s,t),t}}_tCorrectedLightness(t){const e=T(this._color(0,!0).lab()[0],this._color(1,!0).lab()[0],t);return function(t,e,i,s){let n=t(e);for(;s--;){const s=(e+i)/2,r=t(s);N(n)==N(r)?(e=s,n=r):i=s}return(e+i)/2}(t=>this._color(t,!0).lab()[0]-e,0,1,8)}_resetCache(){this._cache&&this._cache.clear()}}var Q;function tt(t){const e={min:1/0,max:-1/0,sum:0,values:[],count:0};return t.forEach(t=>function(t){null==t||isNaN(t)||(e.values.push(t),e.sum+=t,t<e.min&&(e.min=t),t>e.max&&(e.max=t),e.count+=1)}(t)),e.domain=[e.min,e.max],e.limits=function(t,e){return et(this,t,e)},e}function et(t,e="e",i=7){const s=Array.isArray(t)?tt(t):t,{min:n,max:r,values:a}=s;if(a.sort((t,e)=>t-e),1==i)return[n,r];if(e.startsWith("c"))return[n,r];if(e.startsWith("e"))return Array.from({length:i+1},(t,e)=>T(n,r,e/i));if(e.startsWith("l")){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");const t=Math.LOG10E*k(n),e=Math.LOG10E*k(r);return Array.from({length:i+1},(s,n)=>10**T(t,e,n/i))}if(e.startsWith("q"))return Array.from({length:i+1},(t,e)=>{const s=(a.length-1)*e/i,n=E(s);return n==s?a[n]:T(a[n],a[n+1],s-n)});if(e.startsWith("k")){const t=a.length,e=new Array(t),s=new Array(i);let o=!0,l=0,h=Array.from({length:i+1},(t,e)=>T(n,r,e/i));do{s.fill(0);for(let t=0;t<a.length;t++){const i=a[t],n=Pt(h,t=>-b(t-i));s[n]++,e[t]=n}const t=new Array(i).fill(0);for(let i=0;i<e.length;i++){t[e[i]]+=a[i]}for(let e=0;e<t.length;e++)t[e]/=s[e];o=t.some((t,e)=>t!=h[e]),h=t}while(l++<200&&o);const c=Array.from({length:i},()=>[]);for(let t=0;t<e.length;t++){c[e[t]].push(a[t])}const u=[];for(const t of c)u.push(t[0],t[t.length-1]);u.sort((t,e)=>t-e);const d=[];d.push(u[0]);for(let t=1;t<u.length;t+=2){const e=u[t];isNaN(e)||-1!=d.indexOf(e)||d.push(e)}return d}throw new Error("unknown mode")}!function(t){t.cool=function(){return J([W(180,1,.9),W(250,.7,.4)])},t.hot=function(){return J(["#000","#f00","#ff0","#fff"]).mode("rgb")}}(Q||(Q={}));const it={},st={};function nt(t,e){if(Array.isArray(t[0])&&(t=t[0]),!e)if(1==t.length&&t[0]in q)e="name";else if(1==t.length&&"string"==typeof t[0])e="css";else if(3==t.length)e="rgb";else if(4==t.length&&"number"==typeof t[3]&&t[3]>=0&&t[3]<=1)e="rgb";else{if(!(1==t.length&&"number"==typeof t[0]&&t[0]>=0&&t[0]<=16777215))throw new Error("could not guess mode. args "+JSON.stringify(t));e="num"}const i=st[e](...t);return new D(i[0],i[1],i[2],void 0!==i[3]?i[3]:1)}function rt(t){let e;if(e=t.match(/^#?([A-F\d]{2})([A-F\d]{2})([A-F\d]{2})([A-F\d]{2})?$/i))return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?parseInt(e[4],16)/255:1];if(e=t.match(/^#?([A-F\d])([A-F\d])([A-F\d])([A-F\d])?$/i))return[17*parseInt(e[1],16),17*parseInt(e[2],16),17*parseInt(e[3],16),e[4]?17*parseInt(e[4],16)/255:1];throw new Error("invalid hex color: "+t)}function at(t){return(t%360+360)%360}function ot(t){if(!("number"==typeof t&&t>=0&&t<=16777215))throw new Error("unknown num color: "+t);return[t>>16,t>>8&255,255&t,1]}it.xyz=it.rgb=it.lab=function(t,e,i,s){const n=t[s](),r=e[s]();return nt([T(n[0],r[0],i),T(n[1],r[1],i),T(n[2],r[2],i),T(t.alpha(),e.alpha(),i)],s)},it.num=function(t,e,i){return K(T(t.num(),e.num(),i))},it.lrgb=function(t,e,i){const[s,n,r,a]=t.rgba(!1,!1),[o,l,h,c]=e.rgba(!1,!1);return new D(O(s**2*(1-i)+o**2*i),O(n**2*(1-i)+l**2*i),O(r**2*(1-i)+h**2*i),T(a,c,i))},st.lrgb=st.rgb,st.hex=rt,st.hsl=zt,st.hsv=function(t,e,i,s=1){t=at(t);const n=i*e;return kt(t,n,n*(1-b(t/60%2-1)),i-n,s)},st.num=ot;const lt="\\s*",ht="([+-]?(?:\\d*\\.?)?\\d+(?:[eE][+-]?\\d+)?)",ct=new RegExp(["^rgba?\\(",ht,",",ht,",",ht,"(?:,",ht+"(%)?",")?\\)$"].join(lt),"i"),ut=new RegExp(["^rgba?\\(",ht,ht,ht,"(?:/",ht+"(%)?",")?\\)$"].join(lt),"i"),dt=new RegExp(["^rgba?\\(",ht+"%",",",ht+"%",",",ht+"%","(?:,",ht+"(%)?",")?\\)$"].join(lt),"i"),gt=new RegExp(["^rgba?\\(",ht+"%",ht+"%",ht+"%","(?:/",ht+"(%)?",")?\\)$"].join(lt),"i"),pt=new RegExp(["^hsla?\\(",ht+"(deg|rad|turn)?",",",ht+"%",",",ht+"%","(?:,",ht+"(%)?",")?\\)$"].join(lt),"i"),_t=new RegExp(["^hsla?\\(",ht+"(deg|rad|turn)?\\s+"+ht+"%",ht+"%","(?:/",ht+"(%)?",")?\\)$"].join(lt),"i");function ft(t){if(q&&q.hasOwnProperty(t))return ot(q[t.toLowerCase()]);let e;if(e=t.match(ct)||t.match(ut))return[I(+e[1],0,255),I(+e[2],0,255),I(+e[3],0,255),e[4]?I(e[5]?+e[4]/100:+e[4]):1];if(e=t.match(dt)||t.match(gt))return[255*I(+e[1]/100),255*I(+e[2]/100),255*I(+e[3]/100),e[4]?I(e[5]?+e[4]/100:+e[4]):1];if(e=t.match(pt)||t.match(_t)){const t={deg:1,rad:R,turn:360},i=e[2]?e[2].toLowerCase():"deg";return zt((+e[1]*t[i]%360+360)%360,I(+e[3]/100),I(+e[4]/100),e[5]?I(e[6]?+e[5]/100:+e[5]):1)}return rt(t)}function mt(t){return A(100*t)/100}function vt(t){const e=t/255;return e<=.04045?e/12.92:((e+.055)/1.055)**2.4}function yt(t){return t<=.0031308?12.92*t*255:255*(1.055*t**(1/2.4)-.055)}function bt(t){const e=t/100;let i,s,n;return e<66?(i=255,s=-155.25485562709179-.44596950469579133*(e-2)+104.49216199393888*k(e-2),n=e<20?0:.8274096064007395*(e-10)-254.76935184120902+115.67994401066147*k(e-10)):(i=351.97690566805693+.114206453784165*(e-55)-40.25366309332127*k(e-55),s=325.4494125711974+.07943456536662342*(e-50)-28.0852963507957*k(e-50),n=255),[i,s,n]}function xt(t){return function(e,i){const[s,n,r]=t(B(i).rgb(),B(e).rgb());return X(s,n,r)}}function wt(t){return function(e,i){return e.map((e,s)=>t(e,i[s]))}}function Et(t,e,i){const s=z(t,e,i),n=S(t,e,i),r=n-s;let a;return a=0==r?0:t==n?(e-i)/r+(e<i?6:0):e==n?2+(i-t)/r:4+(t-e)/r,[60*a,s,n]}function kt(t,e,i,s,n){const r=255*s,a=255*e+r,o=255*i+r;return t<60?[a,o,r,n]:t<120?[o,a,r,n]:t<180?[r,a,o,n]:t<240?[r,o,a,n]:t<300?[o,r,a,n]:[a,r,o,n]}function zt(t,e,i,s=1){t=at(t);const n=(1-b(2*i-1))*e;return kt(t,n,n*(1-b(t/60%2-1)),i-n/2,s)}function St(t,e,i,s=1){const[n,r,a]=function(t,e,i){function s(t){return t>Lt?t**3:Ct*(t-4/29)}return[Nt*s((t+16)/116+e/500),jt*s((t+16)/116),Ot*s((t+16)/116-i/200)]}(t,e,i);return Ft(n,r,a,s)}st.css=ft,st.name=function(t){return ot(q[t])},st.lch=function(t,e,i,s=1){const[,n,r]=function(t,e,i){return[t,w(i*P)*e,j(i*P)*e]}(t,e,i);return St(t,n,r,s)},st.cmyk=function(t,e,i,s,n=1){return 1==s?[0,0,0,n]:[255*(1-t)*(1-s),255*(1-e)*(1-s),255*(1-i)*(1-s),n]},st.gl=function(t,e,i,s=1){return[255*t,255*e,255*i,s]},st.rgb=(...t)=>t,st.temperature=st.kelvin=st.K=bt,st.hcg=function(t,e,i,s=1){const n=i*(1-e);return kt(t=at(t),e,e*(1-b(t/60%2-1)),n,s)};const At=18,Nt=.95047,jt=1,Ot=1.08883,Lt=.206896552,Ct=.12841855,Mt=.008856452;function Tt(t,e,i){const[s,n,r]=It(t,e,i);return function(t,e,i){function s(t){return t>Mt?L(t):t/Ct+4/29}return[116*s(e/jt)-16,500*(s(t/Nt)-s(e/jt)),200*(s(e/jt)-s(i/Ot))]}(s,n,r)}function It(t,e,i){const s=vt(t),n=vt(e),r=vt(i);return[.4124564*s+.3575761*n+.1804375*r,.2126729*s+.7151522*n+.072175*r,.0193339*s+.119192*n+.9503041*r]}function Ft(t,e,i,s=1){const n=-.969266*t+1.8760108*e+.041556*i,r=.0556434*t-.2040259*e+1.0572252*i;return[yt(3.2404542*t-1.5371385*e-.4985314*i),yt(n),yt(r),s]}function Pt(t,e){let i=-1/0,s=-1;for(let n=0;n<t.length;n++){const r=e(t[n]);r>i&&(i=r,s=n)}return s}st.xyz=Ft,st.lab=St,st.hsi=function(t,e,i,s=1){let n,r,a,o=t*P;return o<2*C/3?(a=(1-e)/3,n=(1+e*w(o)/w(C/3-o))/3,r=1-(a+n)):o<4*C/3?(o-=2*C/3,n=(1-e)/3,r=(1+e*w(o)/w(C/3-o))/3,a=1-(n+r)):(o-=4*C/3,r=(1-e)/3,a=(1+e*w(o)/w(C/3-o))/3,n=1-(r+a)),[3*i*n*255,3*i*r*255,3*i*a*255,s]},it.hsv=it.hsl=it.hsi=it.lch=it.hcg=function(t,e,i,s){const[n,r,a]=t[s](),[o,l,h]=e[s]();function c(t,e,i){return t+i*(at(e-t+180)-180)}return B(("h"==s.charAt(0)?c:T)(n,o,i),T(r,l,i),("h"==s.charAt(2)?c:T)(a,h,i),s)};var Rt=o.isLinkViewEmphasized,Bt=o.isNodeViewEmphasized,Dt=o.isLinkViewDisabled;class Ut{constructor(t){this.canvas=t,this.context2D=this.canvas.getContext("2d",{alpha:!1}),this.gl_canvas=document.createElement("canvas");try{this.gl=this.gl_canvas.getContext("webgl",{premultipliedAlpha:!1})}catch(t){this.gl=null,console.error("Can't create webgl context")}this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.ALWAYS),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.enable(this.gl.CULL_FACE),this.camera_pos=new _([0,0]),this.zoom_direction=new _([0,0]),this.cursor_pos_Scene=new _([0,0]),this.PV=d.identity.copy(),this.PV_inv=d.identity.copy(),this.P=d.identity.copy(),this.S=d.identity.copy(),this.rotation_angle=0}bindGraphView(t,e){this.graph_view=t,this.view_configuration=e,e.scroll_value.Reset(),e.link_renderer.bindContext(this.gl,y),Object.keys(e.node_renderer_per_group).forEach(t=>{e.node_renderer_per_group[t].bindContext(this.gl,y)}),e.link_renderer.clearObjects(),Object.keys(e.node_renderer_per_group).forEach(t=>e.node_renderer_per_group[t].clearObjects())}render(){const t={x:0,y:0,width:this.canvas.clientWidth,height:this.canvas.clientHeight},e=t.width/t.height,i=this.view_configuration;Ut.resizeCanvasFramebuffer(this.canvas,t.width,t.height),Ut.resizeCanvasFramebuffer(this.gl_canvas,t.width*Ut.samples_count,t.height*Ut.samples_count),this.gl.viewport(0,0,t.width*Ut.samples_count,t.height*Ut.samples_count);const s=Math.cos(this.rotation_angle),n=Math.sin(this.rotation_angle),r=1/e/i.scene_size,a=1/i.scene_size,o=this.camera_pos.x*r,l=this.camera_pos.y*a;this.P.init([r*s,-n*a,0,r*n,a*s,0,o,l,1]);const h=this.view_configuration.scroll_value.value,c=-this.zoom_direction.x*h+this.zoom_direction.x,u=-this.zoom_direction.y*h+this.zoom_direction.y;this.S.init([h,0,0,0,h,0,c,u,1]),d.product(this.P,this.S,this.PV),this.PV_inv.init(this.PV.all()),this.PV_inv.inverse();const g=Object.values(this.graph_view.nodes),p=Object.values(this.graph_view.links);this.drawn_nodes=[],this.drawn_links=[],p.forEach(t=>{t.zOrder=0,Rt(t)?t.zOrder=3:(Bt(t.from)&&t.zOrder++,Bt(t.to)&&t.zOrder++),Dt(t)?this.view_configuration.link_renderer.deleteObject(t):(this.drawn_links.push(t),this.view_configuration.link_renderer.addObject(t))}),g.forEach(t=>{t.zOrder=0,Bt(t)&&(t.zOrder=1),t.is_hidden?this.view_configuration.node_renderer_per_group[t.group].deleteObject(t):(this.drawn_nodes.push(t),this.view_configuration.node_renderer_per_group[t.group].addObject(t))}),this.context2D.fillStyle="white",this.context2D.fillRect(0,0,this.canvas.width,this.canvas.height),this.drawGraph(),this.view_configuration.always_show_weights&&this.drawEdgeWeights(),this.drawLabels(),Ut.draw_aabb&&this.drawAABBs()}moveCamera(t){this.camera_pos.x+=t.x*this.view_configuration.scene_size,this.camera_pos.y+=t.y*this.view_configuration.scene_size}scaleGraph(t){t=Math.pow(1.25,t);let e=_.difference(this.cursor_pos_Scene,this.zoom_direction);this.view_configuration.scroll_value.value*=t,this.zoom_direction.x+=e.x*t,this.zoom_direction.y+=e.y*t}set rotation(t){this.rotation_angle=t}get rotation(){return this.rotation_angle}get scaleFactor(){return this.view_configuration.scroll_value.value}get CursorPosAtScene(){return this.cursor_pos_Scene}set CursorPos(t){this.cursor_pos_Scene.x=t.x,this.cursor_pos_Scene.y=t.y,this.ClientToScene(this.cursor_pos_Scene)}SceneToClient(t){this.PV.multiplyVec2(t,t),t.x=(t.x+1)*this.canvas.clientWidth/2,t.y=(1-t.y)*this.canvas.clientHeight/2}ClientToScene(t){const e=this.canvas.getBoundingClientRect();t.x=2*(t.x-e.left)/e.width-1,t.y=2*(t.y-e.top)/e.height-1,t.y*=-1,this.PV_inv.multiplyVec2(t,t)}drawGraph(){const t=this.view_configuration;t.link_renderer.sortObjects(),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),t.link_renderer.render(this.PV,0),Object.keys(t.node_renderer_per_group).forEach(e=>{t.node_renderer_per_group[e].render(this.PV,t.node_border_width)}),this.context2D.drawImage(this.gl_canvas,0,0,this.canvas.width,this.canvas.height)}drawLabels(){this.view_configuration.label_painter;const t=new _,e=new _;var i=null;i=0==this.view_configuration.label_layout_strategy?{font_size:this.view_configuration.label_font_size,is_bordered:!0,is_bold:!1,padding:5,text_color:"#000000",background_color:"#ffffff"}:{font_size:this.view_configuration.label_font_size,is_bordered:!1,is_bold:!1,padding:5,text_color:"#000000",background_color:null};const s=this.drawn_nodes.filter(t=>this.view_configuration.always_show_labels||t.is_toggled||t.is_selected||t.is_hovered||t.selected_adjacent_vertex_count>0);s.forEach(n=>{if(0==this.view_configuration.label_layout_strategy){t.x=0,t.y=0,e.x=0,e.y=0,s.forEach(t=>{const i=t.position.x-n.position.x,s=t.position.y-n.position.y,r=Math.sqrt(i*i+s*s);r>0&&(e.x+=i/r,e.y+=s/r)});const i=e.y/e.x;e.x>0&&i>1||e.x<0&&i<-1?(e.x=0,e.y=1):i<=1&&i>-1?(e.y=0,e.x>0?e.x=1:e.x=-1):(e.x>0&&i<-1||e.x<0&&i>1)&&(e.x=0,e.y=-1);const r=Math.cos(this.rotation_angle),a=Math.sin(this.rotation_angle);e.x=-e.x,e.y=-e.y,t.x=n.position.x+(e.x*n.size*r-e.y*n.size*a),t.y=n.position.y+(e.x*n.size*a+e.y*n.size*r)}else 1==this.view_configuration.label_layout_strategy&&(t.x=n.position.x,t.y=n.position.y);this.SceneToClient(t),i.is_bold=n.is_toggled,this.drawLabel(n.data.label,t,e,i)})}drawLabel(t,e,i,s){this.context2D.font=`${s.is_bold?"bold":""} ${s.font_size}px sans-serif`;const n=this.context2D.measureText(t).width,r=n+2*s.padding,a=s.font_size+2*s.padding;e.x+=i.x*(r/2),e.y-=i.y*s.font_size,this.context2D.fillStyle=B(s.background_color).css(),this.context2D.fillRect(e.x-r/2,e.y-a/2,r,a),this.context2D.fillStyle=B(s.text_color).css(),this.context2D.fillText(t,e.x-n/2,e.y+s.padding),s.is_bordered&&this.context2D.strokeRect(e.x-r/2,e.y-a/2,r,a)}drawEdgeWeights(){const t=new _([0,0]);this.drawn_links.forEach(e=>{const i=e.data.weight;if(i){const s=String(i.toFixed(1));t.x=e.to.position.x-e.from.position.x,t.y=e.to.position.y-e.from.position.y;const n=t.length(),r=t.x/n,a=t.y/n;t.x=e.from.position.x+t.x/2-(e.size+1)*a,t.y=e.from.position.y+t.y/2+(e.size+1)*r,this.SceneToClient(t);const o=this.context2D.measureText(s).width,l=this.view_configuration.label_font_size;this.context2D.fillStyle="black",this.context2D.fillText(s,t.x-o/2,t.y+l/2)}})}drawAABBs(){var t=new _,e=new _;this.graph_view.quad_tree.each(i=>{t.x=i.x,t.y=i.y,e.x=i.x+i.width,e.y=i.y+i.height,this.SceneToClient(t),this.SceneToClient(e),this.context2D.strokeRect(t.x,t.y,e.x-t.x,e.y-t.y)})}drawCursor(){var t=new _(this.cursor_pos_Scene.xy);this.SceneToClient(t),this.context2D.fillRect(t.x-2.5,t.y-2.5,5,5)}static resizeCanvasFramebuffer(t,e,i){t.width===e&&t.height===i||(t.width=e,t.height=i)}}async function Gt(t,e){this.translateGraph(e),this.update()}async function Vt(t,e,i){this.zoomAt(e),this.update()}async function $t(t,e){const i=this,s=t.scene_object;e.shiftKey&&0==e.button?s.is_selected?i.DeselectNode(s.id):i.SelectNode(s.id):0==e.button?i.ToggleNode(s.id):e.button,i.update()}async function qt(t,e){const i=t.scene_object;this.translateNode(i.id,e),this.update()}async function Ht(t){const e=t,i=e.scene_object,s=i.graph_view.quad_tree;s.remove(e),e.x=i.position.x-i.size,e.y=i.position.y-i.size,s.push(e)}async function Wt(t){const e=t.scene_object;this.HoverOnNode(e.id),this.update()}async function Yt(t){const e=t.scene_object;this.HoverOffNode(e.id),this.update()}function Kt(t){const e=360*Math.random();let i=Math.random(),s=Math.random();return i=.4*i+.2,s=.25*s+.65,B(e,i,s,"hsl").alpha(t)}function Xt(t){return t.set("hsl.l",.5).saturate(1)}Ut.dScale=1.25,Ut.samples_count=2,Ut.draw_aabb=!1;var Jt=o.onNodesReplaced;class Zt{constructor(t,e){this.graph_view=null,this.view_configuration=null,this.controller=e,this.canvas=t,this.toggled_node=null,this.inputManager=new m,this.inputManager.bindCanvas(t,this.detectObjectsUnderCursor.bind(this)),this.renderer=new Ut(t)}bindGraph(t,e){if(this.view_configuration=e,!e)throw new DOMException("There's no view configuration for graph");let i=[];const s=this.makeGraphView(t,this.view_configuration);if(this.graph_view&&(i=Object.keys(this.graph_view.nodes).filter(t=>this.graph_view.nodes[t].is_selected),Object.keys(s.nodes).forEach(t=>{const i=s.nodes[t];this.graph_view.nodes.hasOwnProperty(t)&&(i.position=this.graph_view.nodes[t].position,i.position.length()>e.scene_size&&i.position.normalize().scale(e.scene_size))}),s.onNodesReplaced()),this.graph_view=s,this.toggled_node){const t=this.toggled_node.id;this.toggled_node=null,this.ToggleNode(t)}i.forEach(t=>{this.SelectNode(t)}),this.inputManager.bindScene(this.graph_view),this.renderer.bindGraphView(this.graph_view,this.view_configuration)}updateViewConfiguration(){const t=this.view_configuration;Object.values(this.graph_view.nodes).forEach(e=>{const i=e.data.norm_weight;e.size=Math.max(Math.min(t.node_sizer(i),t.max_node_size),t.min_node_size);const s=this.view_configuration.node_colors_per_group[e.group];e.base_color=B(s),e.emphasized_color=Xt(e.base_color)}),Object.values(this.graph_view.links).forEach(e=>{const i=e.data.norm_weight;e.size=Math.max(Math.min(t.link_sizer(i),t.max_link_size),t.min_link_size)})}update(){this.renderer.render()}layoutGraph(t){t.layout(this.graph_view,this.view_configuration.scene_size)}translateGraph(t){this.renderer.moveCamera(t)}zoomAt(t){this.renderer.scaleGraph(t)}rotateGraph(t){this.renderer.rotation=t/180*Math.PI}translateNode(t,e){const i=this.graph_view.nodes[t];if(i){const t=Math.cos(this.renderer.rotation),s=Math.sin(this.renderer.rotation),n=this.view_configuration.scene_size/this.scaleFactor,r=e.x*n,a=e.y*n;i.position.x+=r*t-a*s,i.position.y+=r*s+a*t}}HideNode(t){const e=this.graph_view.nodes[t];e&&!e.is_hidden&&(e.is_hidden=!0,this.graph_view.quad_tree.remove(this.graph_view.aabbs[t]),e.is_selected&&this.DeselectNode(t),e.is_hovered&&this.HoverOffNode(t),e.is_toggled&&this.ToggleNode(t))}ShowNode(t){const e=this.graph_view.nodes[t];e&&e.is_hidden&&(e.is_hidden=!1,this.graph_view.quad_tree.push(this.graph_view.aabbs[t]))}SetNodeLabel(t,e){const i=this.graph_view.nodes[t];i&&(i.data.label=e)}ToggleNode(t){const e=this.graph_view.nodes[t];this.toggled_node&&t==this.toggled_node.id?(this.toggled_node.is_toggled=!1,this.DeselectAdjacentNodes(this.toggled_node.id),this.controller("OnToggleOffNode",{node_id:this.toggled_node.id}),this.toggled_node=null):(this.toggled_node&&(this.toggled_node.is_toggled=!1,this.DeselectAdjacentNodes(this.toggled_node.id),this.controller("OnToggleOffNode",{node_id:this.toggled_node.id})),this.toggled_node=e,this.toggled_node.is_toggled=!0,this.SelectAdjacentNodes(this.toggled_node.id),this.controller("OnToggleOnNode",{node_id:this.toggled_node.id}))}SelectNode(t){const e=this.graph_view.nodes[t];e&&!e.is_hidden&&(e.is_selected=!0,this.SelectAdjacentNodes(t),this.controller("OnSelectNode",{node_id:t}))}DeselectNode(t){const e=this.graph_view.nodes[t];e&&(e.is_selected=!1,this.DeselectAdjacentNodes(t),this.controller("OnDeselectNode",{node_id:t}))}HoverOnNode(t){const e=this.graph_view.nodes[t];e&&!e.is_hidden&&(e.is_hovered=!0,this.SelectAdjacentNodes(t))}HoverOffNode(t){const e=this.graph_view.nodes[t];e&&(e.is_hovered=!1,this.DeselectAdjacentNodes(t))}ShowLink(t,e){const i=this.graph_view.links_from_node[t][e];if(i&&i.is_hidden){const t=i.to,e=i.from;t.is_hidden||e.is_hidden||(i.is_hidden=!1,(e.is_selected||e.is_toggled||e.is_hovered)&&t.selected_adjacent_vertex_count++)}}HideLink(t,e){const i=this.graph_view.links_from_node[t][e];if(i&&!i.is_hidden){const t=i.to,e=i.from;i.is_hidden=!0,(e.is_toggled||e.is_selected||e.is_hovered)&&t.selected_adjacent_vertex_count--,(t.is_toggled||t.is_selected||t.is_hovered)&&(e.selected_adjacent_vertex_count--,console.log("hide link to",e.data.label))}}detectObjectsUnderCursor(t){this.renderer.CursorPos=t;const e=this.renderer.CursorPosAtScene,i={x:e.x,y:e.y,width:.05,height:.05};return this.graph_view.quad_tree.colliding(i)}get scaleFactor(){return this.renderer.scaleFactor}makeGraphView(t,e){const i={nodes:{},node_groups:{},links:[],links_from_node:{},quad_tree:new h({width:e.scene_size,height:e.scene_size,maxElements:3}),aabbs:{},onDrag:Gt.bind(this),onDragEnd:null,onZoom:Vt.bind(this)};return i.onNodesReplaced=Jt.bind(i),t.source_graph.forEachNode(s=>{const n=t.mutable_graph.getNode(s.id),r=n?n.data:s.data,a=Zt.makeNodeView(e,i,s.id,r);a.is_hidden=t.isManuallyHiddenNode(s.id),i.node_groups[r.group]||(i.node_groups[r.group]={}),i.nodes[s.id]=a,i.node_groups[r.group][s.id]=a,i.links_from_node[s.id]={}}),t.source_graph.forEachLink(s=>{const n=i.nodes[s.fromId],r=i.nodes[s.toId],a=Zt.makeLinkView(n,r,s,e);a.is_hidden=t.isManuallyHiddenNode(s.fromId)||t.isManuallyHiddenNode(s.toId),i.links.push(a),i.links_from_node[s.fromId][s.toId]=a}),i.quad_tree.clear(),Object.keys(i.nodes).forEach(t=>{const e=this.makeAABB(i.nodes[t]);i.aabbs[t]=e,i.quad_tree.push(e)}),i}static makeNodeView(t,e,i,s){const n=new _([120*Math.random()-60,120*Math.random()-60]),r=t.node_colors_per_group[s.group];return{group:s.group,position:n,base_color:B(r),emphasized_color:Xt(B(r)),is_hovered:!1,is_selected:!1,is_toggled:!1,selected_adjacent_vertex_count:0,is_hidden:!1,size:Math.max(Math.min(t.node_sizer(s.norm_weight),t.max_node_size),t.min_node_size),zOrder:0,id:i,data:Object.assign({},s),graph_view:e}}static makeLinkView(t,e,i,s){const n=i.data.norm_weight;return{from:t,to:e,size:Math.max(Math.min(s.link_sizer(n),s.max_link_size),s.min_link_size),alpha:1,zOrder:0,is_hidden:!1,painter:s.link_painter,data:Object.assign({},i.data)}}makeAABB(t){return{x:t.position.x-t.size,y:t.position.y-t.size,width:2*t.size,height:2*t.size,scene_object:t,onClick:$t.bind(this),onDrag:qt.bind(this),onDragEnd:Ht.bind(this),onEnter:Wt.bind(this),onLeave:Yt.bind(this)}}SelectAdjacentNodes(t){Object.values(this.graph_view.links_from_node[t]).forEach(t=>{t.is_hidden||t.to.selected_adjacent_vertex_count++})}DeselectAdjacentNodes(t){Object.values(this.graph_view.links_from_node[t]).forEach(t=>{t.is_hidden||t.to.selected_adjacent_vertex_count--})}}var Qt,te=i(12),ee=i.n(te),ie=i(2),se=i.n(ie);!function(t){t.EmptyMeta={groups_count:0,nodes_count:0,links_count:0};class e{constructor(e){this.label=e||"",this.mutable_graph=se()(),this.source_graph=se()(),this.manually_hidden_node_ids=[],this.meta=Object.assign({},t.EmptyMeta)}isManuallyHiddenNode(t){return-1!=this.manually_hidden_node_ids.indexOf(t)}hideNode(t,e=!1){this.mutable_graph.removeNode(t)&&e&&this.manually_hidden_node_ids.push(t)}showNode(t,e=!1){const i=this.source_graph.getNode(t),s=this.source_graph.getLinks(t);if(i&&!this.mutable_graph.hasNode(t)&&(this.mutable_graph.beginUpdate(),this.mutable_graph.addNode(t,Object.assign({},i.data)),s&&s.forEach(t=>{const e=this.mutable_graph.getNode(t.fromId),i=this.mutable_graph.getNode(t.toId);if(e&&i&&null==this.mutable_graph.hasLink(e.id,i.id)){const e=Object.assign({},t.data);this.mutable_graph.addLink(t.fromId,t.toId,e)}}),this.mutable_graph.endUpdate(),e)){const e=this.manually_hidden_node_ids.indexOf(t),i=this.manually_hidden_node_ids.length;let s=this.manually_hidden_node_ids[e];this.manually_hidden_node_ids[e]=this.manually_hidden_node_ids[i-1],this.manually_hidden_node_ids[i-1]=s,this.manually_hidden_node_ids.pop()}}hideLink(t,e){const i=this.mutable_graph.getLink(t,e);i&&this.mutable_graph.removeLink(i)}showLink(t,e){const i=this.source_graph.getLink(t,e),s=this.mutable_graph.getNode(t),n=this.mutable_graph.getNode(e);if(i&&s&&n&&null==this.mutable_graph.hasLink(t,e)){const s=Object.assign({},i.data);this.mutable_graph.addLink(t,e,s)}}updateMeta(){let t=!1,e=!1;const i=[];if(this.source_graph.forEachNode(t=>{e=e||t.data.weight}),this.source_graph.forEachLink(e=>{t=t||e.data.weight}),this.mutable_graph.forEachNode(t=>{const e=t.data.group;i.includes(e)||i.push(e)}),this.meta.groups_count=i.length,this.meta.links_count=this.mutable_graph.getLinksCount(),this.meta.nodes_count=this.mutable_graph.getNodesCount(),e){const t={min:1/0,max:-1/0,avg:0};this.source_graph.forEachNode(e=>(t.max=Math.max(t.max,e.data.weight),t.min=Math.min(t.min,e.data.weight),t.avg+=e.data.weight,!1)),t.avg/=this.source_graph.getNodesCount(),this.meta.node_weight_range=t,this.source_graph.forEachNode(t=>{const e=t.data.weight,i=this.meta.node_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)}),this.mutable_graph.forEachNode(t=>{const e=t.data.weight,i=this.meta.node_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)})}if(t){const t={min:1/0,max:-1/0,avg:0};this.source_graph.forEachLink(e=>(t.max=Math.max(t.max,e.data.weight),t.min=Math.min(t.min,e.data.weight),t.avg+=e.data.weight,!1)),t.avg/=this.source_graph.getLinksCount(),this.meta.link_weight_range=t,this.source_graph.forEachLink(t=>{const e=t.data.weight,i=this.meta.link_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)}),this.mutable_graph.forEachLink(t=>{const e=t.data.weight,i=this.meta.link_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)})}}clusterize(){const t=ee()(this.mutable_graph),e=[];this.mutable_graph.forEachNode((function(i){const s=t.getClass(i.id);let n=e.indexOf(s);-1==n&&(e.push(s),n=e.length-1),i.data.group=n})),console.log(e),this.meta.groups_count=e.length}copy(){const t=new e(this.label);return this.source_graph.forEachNode(e=>{const i=Object.assign({},e.data);t.source_graph.addNode(e.id,i)}),this.source_graph.forEachLink(e=>{const i=Object.assign({},e.data);t.source_graph.addLink(e.fromId,e.toId,i)}),this.mutable_graph.forEachNode(e=>{const i=Object.assign({},e.data);t.mutable_graph.addNode(e.id,i)}),this.mutable_graph.forEachLink(e=>{const i=Object.assign({},e.data);t.mutable_graph.addLink(e.fromId,e.toId,i)}),t.meta=Object.assign(this.meta),t}}t.GraphState=e,t.getFirstState=function(t){return t.states[Object.keys(t.states)[0]]},t.updateGraphMeta=function(t){t.meta.node_weight_range=void 0,t.meta.link_weight_range=void 0,Object.values(t.states).forEach(e=>{t.meta.groups_count=Math.max(e.meta.groups_count,t.meta.groups_count),t.meta.links_count=Math.max(e.meta.links_count,t.meta.links_count),t.meta.nodes_count=Math.max(e.meta.nodes_count,t.meta.nodes_count),e.meta.link_weight_range&&(t.meta.link_weight_range||(t.meta.link_weight_range={min:1/0,max:-1/0,avg:0}),t.meta.link_weight_range.min=Math.min(t.meta.link_weight_range.min,e.meta.link_weight_range.min),t.meta.link_weight_range.max=Math.max(t.meta.link_weight_range.max,e.meta.link_weight_range.max),t.meta.link_weight_range.avg+=e.meta.link_weight_range.avg),e.meta.node_weight_range&&(t.meta.node_weight_range||(t.meta.node_weight_range={min:1/0,max:-1/0,avg:0}),t.meta.node_weight_range.min=Math.min(t.meta.node_weight_range.min,e.meta.node_weight_range.min),t.meta.node_weight_range.max=Math.max(t.meta.node_weight_range.max,e.meta.node_weight_range.max),t.meta.node_weight_range.avg+=e.meta.node_weight_range.avg)});const e=Object.keys(t.states).length;t.meta.link_weight_range&&(t.meta.link_weight_range.avg/=e),t.meta.node_weight_range&&(t.meta.node_weight_range.avg/=e)},t.calculateState=function(t,e){e.length%2==0&&console.log("incorrect expression for calculation: extra symbols");let i=0;function s(t,e){let i=null;return t.mutable_graph.forEachNode(t=>{t.data.label==e&&(i=t)}),i}function n(t,e,i){let s=null;return t.mutable_graph.forEachLink(n=>{if(!s){const r=t.mutable_graph.getNode(n.fromId),a=t.mutable_graph.getNode(n.toId);r.data.label==e&&a.data.label==i&&(s=n)}}),s}function r(t,e){t.mutable_graph.beginUpdate(),e.mutable_graph.forEachNode(e=>{const n=s(t,e.data.label);if(n)n.data.weight=Math.max(n.data.weight,e.data.weight);else{const s=Object.assign({},e.data);t.mutable_graph.addNode(++i,s)}}),e.mutable_graph.forEachLink(i=>{let r=e.mutable_graph.getNode(i.fromId),a=e.mutable_graph.getNode(i.toId);const o=n(t,r.data.label,a.data.label);if(o)o.data.weight=Math.max(o.data.weight,i.data.weight);else if(r=s(t,r.data.label),a=s(t,a.data.label),r&&a){const e=Object.assign({},i.data);t.mutable_graph.addLink(r.id,a.id,e)}}),t.mutable_graph.endUpdate()}function a(t,e){const i=[],r=[];t.mutable_graph.forEachLink(i=>{const s=t.mutable_graph.getNode(i.fromId),a=t.mutable_graph.getNode(i.toId);n(e,s.data.label,a.data.label)||r.push(i)}),t.mutable_graph.forEachNode(t=>{s(e,t.data.label)||i.push(t.id)}),t.mutable_graph.beginUpdate(),r.forEach(e=>t.mutable_graph.removeLink(e)),i.forEach(e=>t.mutable_graph.removeNode(e)),t.mutable_graph.endUpdate()}function o(t,e){const i=[],r=[];t.mutable_graph.forEachLink(i=>{const s=t.mutable_graph.getNode(i.fromId),a=t.mutable_graph.getNode(i.toId);n(e,s.data.label,a.data.label)&&r.push(i)}),t.mutable_graph.forEachNode(t=>{s(e,t.data.label)&&i.push(t.id)}),t.mutable_graph.beginUpdate(),r.forEach(e=>t.mutable_graph.removeLink(e)),i.forEach(e=>t.mutable_graph.removeNode(e)),t.mutable_graph.endUpdate()}function l(t,e){const r=[],a=[];t.mutable_graph.forEachLink(i=>{const s=t.mutable_graph.getNode(i.fromId),r=t.mutable_graph.getNode(i.toId);n(e,s.data.label,r.data.label)&&a.push(i)}),t.mutable_graph.forEachNode(t=>{s(e,t.data.label)&&r.push(t.id)}),e.mutable_graph.forEachNode(e=>{s(t,e.data.label)||t.mutable_graph.addNode(++i,e.data)}),e.mutable_graph.forEachLink(i=>{let r=e.mutable_graph.getNode(i.fromId),a=e.mutable_graph.getNode(i.toId);n(t,r.data.label,a.data.label)||(r=s(t,r.data.label),a=s(t,a.data.label),r&&a&&t.mutable_graph.addLink(r.id,a.id,i.data))}),t.mutable_graph.beginUpdate(),a.forEach(e=>t.mutable_graph.removeLink(e)),r.forEach(e=>t.mutable_graph.removeNode(e)),t.mutable_graph.endUpdate()}const h=t.states[parseInt(e[0])].copy();h.label="calculated",h.mutable_graph.forEachNode(t=>{"number"==typeof t.id&&t.id>i&&(i=t.id)});for(let i=1;i<e.length;i+=2){const s=parseInt(e[i+1]);switch(e[i]){case Xe.UNION:r(h,t.states[s]);break;case Xe.INTERSECT:a(h,t.states[s]);break;case Xe.DIFF:o(h,t.states[s]);break;case Xe.SYMDIFF:l(h,t.states[s]);break;default:console.log("incorrect expression: invalid operation")}}return h.source_graph.clear(),h.mutable_graph.forEachNode(t=>{const e=Object.assign({},t.data);h.source_graph.addNode(t.id,e)}),h.mutable_graph.forEachLink(t=>{const e=Object.assign({},t.data);h.source_graph.addLink(t.fromId,t.toId,e)}),h.updateMeta(),h}}(Qt||(Qt={}));const ne="scivi_fsgraph";var re=Qt.getFirstState,ae=Qt.calculateState;const oe=ne+"_state_bar",le=ne+"_tabs";class he{constructor(t){this.node_weight_range={min:-1/0,max:1/0,default:0},this.link_weight_range={min:-1/0,max:1/0,default:0},this.canvas_manager=null,this.out_controller=t}build(t,e,i){this.gui_configuration=e,this.translator=i,t.innerHTML=`\n        <aside id=scivi_fsgraph_graph_view class="split split-horizontal">\n            <div id=scivi_fsgraph_rotate_bar class="ui-slider-handle">\n                <div id=scivi_fsgraph_rotate_bar_handle class="ui-slider-handle"></div>\n            </div>\n            <canvas id=scivi_fsgraph_canvas tabindex=0></canvas>\n            \n            <div id=${oe} style="position: relative">\n                 <div id=${oe}_line></div>\n                 <div id=${oe}_labels></div>\n                 <div id=scivi_fsgraph_state_stub class="scivi_state_line_curtain scivi_state_line_curtain_bg">\n                    <div id=scivi_fsgraph_state_stub_btn class="scivi_state_line_curtain_lbl">\n                        ${this.translator.apply("LOC_STATECALCULATED")}\n                    </div>\n                </div>\n            </div>\n        </aside>`;const s=document.getElementById("scivi_fsgraph_state_stub");if(s.style.display="flex",s.style.flexDirection="column",s.style.justifyContent="center",s.style.alignItems="center",document.getElementById("scivi_fsgraph_state_stub_btn").onclick=()=>{he.hideStateBarStub();const t=$("#"+oe+"_line").slider("option","value"),e=Object.values(this.bound_graph.states)[t||0];this.setState(e)},he.hideStateBarStub(),Object.keys(e).length>0){const s=document.createElement("aside");s.className="split split-horizontal",s.id=le;const n=document.createElement("ul");s.appendChild(n),Object.keys(e).forEach(t=>{const e=document.createElement("li"),s="#"+t;e.innerHTML=`<a id=${ne+t+"_link"} href=${s}>${i.apply(s)}</a>`,n.appendChild(e)}),Object.keys(e).forEach(t=>{const e=document.createElement("div");e.id=t,s.appendChild(e)}),t.appendChild(s),l(["#scivi_fsgraph_graph_view","#"+le],{gutterSize:8,cursor:"col-resize",sizes:[55,45],onDrag:()=>this.canvas_manager.update()}),$("#"+le).tabs({heightStyle:"fill"})}this.initGraphViewPanel(),Object.keys(e).forEach(t=>{const s=document.getElementById(t);e[t].build(s,this.TabsController.bind(this),i)}),document.body.onresize=()=>this.canvas_manager.update()}bindGraph(t,e){t.states.length>0&&(this.bound_graph=t,t.states.length>1&&this.fillStateBar(),this.view_configuration=e,this.setState(re(t)),this.gui_configuration.calculator_tab&&this.gui_configuration.calculator_tab.fill(t),this.gui_configuration.filters_tab&&this.gui_configuration.filters_tab.fill(t))}initGraphViewPanel(){const t=document.getElementById("scivi_fsgraph_graph_view");t.style.display="flex",t.style.flexDirection="column";const e=document.getElementById("scivi_fsgraph_rotate_bar");e.style.marginTop="0.5rem",e.style.marginBottom="0.5rem",e.style.marginLeft="2rem",e.style.marginRight="2rem";const i=$("#scivi_fsgraph_rotate_bar_handle");$("#scivi_fsgraph_rotate_bar").slider({min:-180,max:180,value:0,step:5,slide:(t,e)=>{const s=e.value||0;i.text(s+"°"),this.canvas_manager.rotateGraph(s),this.canvas_manager.update()},create:()=>i.text("0°")});const s=document.getElementById("scivi_fsgraph_canvas");s.style.border="solid white 1px",s.style.flex="1 1 auto",s.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation()},this.canvas_manager=new Zt(s,this.CanvasManagerController.bind(this))}fillStateBar(){const t=Object.keys(this.bound_graph.states).length,e=100/t,i=document.getElementById(oe+"_line");i.style.marginTop="0.5rem",i.style.marginRight=e/2+"%",i.style.marginLeft=e/2+"%",$("#"+oe+"_line").slider({min:0,max:t-1,value:0,step:1,slide:(t,e)=>{const i=this.bound_graph.states[e.value||0];this.setState(i)}});const s=document.getElementById(oe+"_labels");this.bound_graph.states.forEach(t=>{const i=document.createElement("div");i.style.display="inline-block",i.style.textAlign="center",i.innerHTML=`<span>|</span><br/><label>${t.label}</label>`,i.classList.add("scivi_fsgraph_stateline_label"),i.style.width=e+"%",s.appendChild(i)})}setState(t){this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.fill(t),this.gui_configuration.about_graph_tab&&this.gui_configuration.about_graph_tab.fill(t),this.active_state=t,this.canvas_manager.bindGraph(t,this.view_configuration),this.FilterNodes(),this.canvas_manager.update()}static showStateBarStub(){document.getElementById("scivi_fsgraph_state_stub").style.display="flex"}static hideStateBarStub(){document.getElementById("scivi_fsgraph_state_stub").style.display="none"}FilterNodes(){this.active_state.source_graph.forEachNode(t=>{if(!this.active_state.isManuallyHiddenNode(t.id)){const e=t.data.weight;!e&&0!=e||e>=this.node_weight_range.min&&e<=this.node_weight_range.max?(this.active_state.showNode(t.id),this.canvas_manager.ShowNode(t.id)):(this.canvas_manager.HideNode(t.id),this.active_state.hideNode(t.id))}}),this.FilterLinks()}FilterLinks(){this.active_state.source_graph.forEachLink(t=>{const e=t.data.weight;!e&&0!=e||e>=this.link_weight_range.min&&e<=this.link_weight_range.max?(this.active_state.showLink(t.fromId,t.toId),this.canvas_manager.ShowLink(t.fromId,t.toId)):(this.canvas_manager.HideLink(t.fromId,t.toId),this.active_state.hideLink(t.fromId,t.toId))})}async CanvasManagerController(t,e){switch(t){case"OnToggleOnNode":this.gui_configuration.node_info_tab&&this.gui_configuration.node_info_tab.fill({graph:this.active_state,node_id:e.node_id});break;case"OnToggleOffNode":this.gui_configuration.node_info_tab&&this.gui_configuration.node_info_tab.clear();break;case"OnSelectNode":this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.onSelectedNode(e.node_id);break;case"OnDeselectNode":this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.onDeselectedNode(e.node_id)}}async TabsController(t,e){switch(t){case"layout":this.canvas_manager.layoutGraph(e.builder);break;case"SelectNode":this.canvas_manager.SelectNode(e.node_id);break;case"DeselectNode":this.canvas_manager.DeselectNode(e.node_id);break;case"ShowNode":{const t=e.node_id;this.active_state.showNode(t,!0),this.canvas_manager.ShowNode(t),this.FilterNodes()}break;case"HideNode":{const t=e.node_id;this.canvas_manager.HideNode(t),this.active_state.hideNode(t,!0)}break;case"ChangeNodeName":{const t=e.node_id,i=e.new_name;this.active_state.mutable_graph.getNode(t).data.label=i,this.active_state.source_graph.getNode(t).data.label=i,this.canvas_manager.SetNodeLabel(t,i)}break;case"FilterNodes":{const t=e.min,i=e.max;this.node_weight_range.min=t,this.node_weight_range.max=i,this.FilterNodes()}break;case"FilterLinks":{const t=e.min,i=e.max;this.link_weight_range.min=t,this.link_weight_range.max=i,this.FilterLinks()}break;case"SetNodeSizeRange":this.view_configuration.min_node_size=e.min,this.view_configuration.max_node_size=e.max,this.canvas_manager.updateViewConfiguration();break;case"SetLinkSizeRange":this.view_configuration.min_link_size=e.min,this.view_configuration.max_link_size=e.max,this.canvas_manager.updateViewConfiguration();break;case"SetNodeAlpha":Object.keys(this.view_configuration.node_colors_per_group).forEach(t=>{const i=B(this.view_configuration.node_colors_per_group[t]).alpha(e.alpha);this.view_configuration.node_colors_per_group[t]=i.hex("rgba")}),this.canvas_manager.updateViewConfiguration();break;case"SetBorderSize":{const t=e.size;this.view_configuration.node_border_width=t,this.canvas_manager.updateViewConfiguration()}break;case"Clusterise":{this.active_state.clusterize();const t=this.active_state.meta.groups_count,e=function(t,e){const i=[],s=Kt(e);if(i.push(s.hex("rgba")),t>1){const n=360/t;let r=s.hsl()[0]+n;for(let s=1;s<t;s++){const t=Kt(e).set("hsl.h",r);i.push(t.hex("rgba")),r+=n,r>360&&(r-=360)}}return i}(t,1);for(let i=0;i<t;i++)this.view_configuration.node_colors_per_group[i]=e[i],this.view_configuration.node_renderer_per_group[i]=this.view_configuration.node_renderer_per_group[0];this.setState(this.active_state)}break;case"SavePNG":{const t=document.getElementById("scivi_fsgraph_canvas");var i=document.createElement("a");i.download="graph.png",i.href=t.toDataURL(),i.click()}break;case"ToggleLabelsShowing":this.view_configuration.always_show_labels=!this.view_configuration.always_show_labels;break;case"ToggleWeightsShowing":this.view_configuration.always_show_weights=!this.view_configuration.always_show_weights;break;case"SetLabelFontSize":this.view_configuration.label_font_size=e.font_size;break;case"CalcState":{const t=e.expr,i=ae(this.bound_graph,t);this.setState(i),he.showStateBarStub()}break;case"SelectLabelLayoutStrategy":{const t=Number(e.strategy_id);this.view_configuration.label_layout_strategy=t,this.canvas_manager.updateViewConfiguration()}break;default:console.log("unknown event: ",t,e)}this.canvas_manager.update()}}var ce=Qt.GraphState,ue=Qt.EmptyMeta,de=Qt.updateGraphMeta;class ge{fromJSON(t){let e={states:[],meta:Object.assign({},ue)},i=t.states||t;if(console.log(i),i&&"function"==typeof i[Symbol.iterator])for(let t of i){const i=t.label;console.log(t),e.states.push(ge.fillState(i,t))}else e.states.push(ge.fillState("0",t));return de(e),e}static fillState(t,e){const i=new ce(t);i.source_graph.beginUpdate();const s=e.nodes,n=e.edges;for(let t of s){const e=t.id,s=t.group?t.group:0;let n={label:t.label?t.label:"#no_label",group:s,norm_weight:0};Object.keys(t).forEach(e=>{"id"!=e&&"group"!=e&&"label"!=e&&(n[e]=t[e])}),i.source_graph.addNode(e,n)}for(let t of n){const e=t.source,s=t.target;let n={norm_weight:0};Object.keys(t).forEach(e=>{"source"!=e&&"target"!=e&&(n[e]=t[e])}),i.source_graph.addLink(e,s,n)}return i.source_graph.endUpdate(),i.mutable_graph.beginUpdate(),i.source_graph.forEachNode(t=>{{const e=Object.assign({},t.data);i.mutable_graph.addNode(t.id,e)}}),i.source_graph.forEachLink(t=>{{const e=Object.assign({},t.data);i.mutable_graph.addLink(t.fromId,t.toId,e)}}),i.mutable_graph.endUpdate(),i.updateMeta(),i}}function pe(t,e){let i=new Float32Array(t);if(t>e.length)i.set(e,0);else for(let s=0;s<t;++s)i[s]=e[s];return i}function _e(t,e){let i=new Uint16Array(t);if(t>e.length)i.set(e,0);else for(let s=0;s<t;++s)i[s]=e[s];return i}ge.default_group_index=0;var fe=o.isNodeViewEmphasized;const me=8*Float32Array.BYTES_PER_ELEMENT,ve=Uint16Array.BYTES_PER_ELEMENT;class ye{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;    \n        attribute vec2 a_uv;     \n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        uniform float u_border_width;\n        varying vec2 v_uv;\n        varying vec4 v_color;\n        varying float b_width;\n\n        void main(void)\n        {\n            v_color = a_color;\n            v_uv = a_uv;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        uniform mediump float u_border_width;\n        varying vec2 v_uv;\n        varying vec4 v_color;\n        const float sharpness = 1.0;//резкость границ\n        const float base = 64.0;\n\n        void main(void) {\n            float R = length(v_uv);\n            //shape\n            float sh = pow(base, sharpness);\n            float alpha_m = max(1.0 - pow(R, sh), 0.0);\n            //border\n            float border_m = max(1.0 - pow(R + u_border_width, sh), 0.0);   \n            gl_FragColor = vec4(v_color.r * border_m, v_color.g * border_m, v_color.b * border_m, v_color.a * alpha_m);    \n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color","a_uv"],uniforms:["u_pv","u_border_width"]},this.geometry={vertices:new Float32Array(4*me*this.default_max_objects_count),indices:new Uint16Array(6*ve*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.gl=null,this.program=null,this.objects=[]}render(t,e){this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.uniform1f(this.program.uniforms.u_border_width,e),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,me,0),this.gl.enableVertexAttribArray(this.program.attributes.a_uv),this.gl.vertexAttribPointer(this.program.attributes.a_uv,2,this.gl.FLOAT,!1,me,2*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,me,4*Float32Array.BYTES_PER_ELEMENT),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.DYNAMIC_DRAW),this.gl.drawElements(this.gl.TRIANGLES,6*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_uv),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=pe(2*t.vertices.length,t.vertices),t.indices=_e(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=ye.makeVerticesArray(e);this.geometry.vertices.set(i,32*t)}else{const i=this.geometry.objects_count;this.offsets.set(e,i);const s=ye.makeVerticesArray(e),n=ye.makeIndicesArray(4*i);this.geometry.vertices.set(s,32*i),this.geometry.indices.set(n,6*i),this.objects.push(t),this.geometry.objects_count++}}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=this.geometry.objects_count-1;if(t!=i&&(this.offsets.set(this.objects[i],t),this.objects[t]=this.objects[i],this.geometry.vertices.copyWithin(32*t,32*i,32*i+32)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=pe(t.vertices.length/2,t.vertices),t.indices=_e(t.indices.length/2,t.indices),t.max_objects_count/=2}}}sortObjects(){}static makeVerticesArray(t){let e=t.base_color.gl();(fe(t)||t.selected_adjacent_vertex_count>0)&&(e=t.emphasized_color.gl());const i=t.size;return[t.position.x-i,t.position.y-i,-1,-1,e[0],e[1],e[2],e[3],t.position.x+i,t.position.y-i,1,-1,e[0],e[1],e[2],e[3],t.position.x+i,t.position.y+i,1,1,e[0],e[1],e[2],e[3],t.position.x-i,t.position.y+i,-1,1,e[0],e[1],e[2],e[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t]}}var be=o.isLinkViewEmphasized,xe=o.isNodeViewEmphasized;const we=6*Float32Array.BYTES_PER_ELEMENT,Ee=Uint16Array.BYTES_PER_ELEMENT;class ke{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;\n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        varying vec4 v_color;\n\n        void main(void)\n        {\n            v_color = a_color;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        varying vec4 v_color;\n\n        void main(void) {\n            gl_FragColor = v_color;\n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color"],uniforms:["u_pv"]},this.geometry={vertices:new Float32Array(7*we*this.default_max_objects_count),indices:new Uint16Array(9*Ee*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.objects=[]}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}render(t){this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,we,0),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,we,2*Float32Array.BYTES_PER_ELEMENT),this.gl.drawElements(this.gl.TRIANGLES,9*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=pe(2*t.vertices.length,t.vertices),t.indices=_e(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=ke.makeVerticesArray(e);this.geometry.vertices.set(i,42*t)}else{const t=this.geometry.objects_count;this.offsets.set(e,t),this.objects.push(e);const i=ke.makeVerticesArray(e),s=ke.makeIndicesArray(7*t);this.geometry.vertices.set(i,42*t),this.geometry.indices.set(s,9*t),this.geometry.objects_count++}}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=this.geometry.objects_count-1;if(t!=i&&(this.offsets.set(this.objects[i],t),this.objects[t]=this.objects[i],this.geometry.vertices.copyWithin(42*t,42*i,42*i+42)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=pe(t.vertices.length/2,t.vertices),t.indices=_e(t.indices.length/2,t.indices),t.max_objects_count/=2}}}sortObjects(){const t=[...this.objects];t.sort((t,e)=>t.zOrder-e.zOrder);const e=new Float32Array(this.geometry.vertices);for(let i=0;i<this.objects.length;i++){const s=t[i],n=this.offsets.get(s);for(let t=0;t<42;t++)e[42*i+t]=this.geometry.vertices[42*n+t];this.offsets.set(s,i)}this.geometry.vertices=e,this.objects=t}static makeVerticesArray(t){const e=t.from,i=t.to,s=i.position.y-e.position.y,n=i.position.x-e.position.x,r=Math.sqrt(s*s+n*n),a=n/r,o=s/r,l=a*t.size,h=o*t.size;let c,u;be(t)?(c=t.painter(t.from.emphasized_color.gl()),u=t.painter(t.to.emphasized_color.gl()),c[3]=1,u[3]=1):(c=xe(e)?t.painter(t.from.emphasized_color.gl()):t.painter(t.from.base_color.gl()),u=xe(i)?t.painter(t.to.emphasized_color.gl()):t.painter(t.to.base_color.gl()));const d=i.size+5*t.size;return[e.position.x+e.size*a-h,e.position.y+e.size*o+l,c[0],c[1],c[2],c[3],e.position.x+e.size*a+h,e.position.y+e.size*o-l,c[0],c[1],c[2],c[3],i.position.x-d*a+h,i.position.y-d*o-l,u[0],u[1],u[2],u[3],i.position.x-d*a-h,i.position.y-d*o+l,u[0],u[1],u[2],u[3],i.position.x-i.size*a,i.position.y-i.size*o,u[0],u[1],u[2],u[3],i.position.x-d*a-4*h,i.position.y-d*o+4*l,u[0],u[1],u[2],u[3],i.position.x-d*a+4*h,i.position.y-d*o-4*l,u[0],u[1],u[2],u[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t,t+4,t+5,t+6]}}var ze=o.isLinkViewEmphasized,Se=o.isNodeViewEmphasized;const Ae=6*Float32Array.BYTES_PER_ELEMENT,Ne=Uint16Array.BYTES_PER_ELEMENT;class je{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;\n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        varying vec4 v_color;\n\n        void main(void)\n        {\n            v_color = a_color;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        varying vec4 v_color;\n\n        void main(void) {\n            gl_FragColor = v_color;\n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color"],uniforms:["u_pv"]},this.geometry={vertices:new Float32Array(4*Ae*this.default_max_objects_count),indices:new Uint16Array(6*Ne*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.geometry.vertices.fill(0),this.objects=[]}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}render(t){this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,Ae,0),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,Ae,2*Float32Array.BYTES_PER_ELEMENT),this.gl.drawElements(this.gl.TRIANGLES,6*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=pe(2*t.vertices.length,t.vertices),t.indices=_e(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=je.makeVerticesArray(e);this.geometry.vertices.set(i,24*t)}else{const t=this.geometry.objects_count;this.offsets.set(e,t);const i=je.makeVerticesArray(e),s=je.makeIndicesArray(4*t);this.geometry.vertices.set(i,24*t),this.geometry.indices.set(s,6*t),this.geometry.objects_count=this.objects.push(e)}}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=this.geometry.objects_count-1;if(t!=i&&(this.offsets.set(this.objects[i],t),this.objects[t]=this.objects[i],this.geometry.vertices.copyWithin(24*t,24*i,24*i+24)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=pe(t.vertices.length/2,t.vertices),t.indices=_e(t.indices.length/2,t.indices),t.max_objects_count/=2}}}sortObjects(){const t=[...this.objects];t.sort((t,e)=>t.zOrder-e.zOrder);const e=new Float32Array(this.geometry.vertices);for(let i=0;i<this.objects.length;i++){const s=t[i],n=this.offsets.get(s);for(let t=0;t<24;t++)e[24*i+t]=this.geometry.vertices[24*n+t];this.offsets.set(s,i)}this.geometry.vertices=e,this.objects=t}static makeVerticesArray(t){const e=t.from,i=t.to,s=i.position.y-e.position.y,n=i.position.x-e.position.x,r=Math.sqrt(s*s+n*n),a=s/r,o=n/r*t.size,l=a*t.size;let h,c;return ze(t)?(h=t.painter(t.from.emphasized_color.gl()),c=t.painter(t.to.emphasized_color.gl()),h[3]=1,c[3]=1):(h=Se(e)?t.painter(t.from.emphasized_color.gl()):t.painter(t.from.base_color.gl()),c=Se(i)?t.painter(t.to.emphasized_color.gl()):t.painter(t.to.base_color.gl())),[e.position.x-l,e.position.y+o,h[0],h[1],h[2],h[3],e.position.x+l,e.position.y-o,h[0],h[1],h[2],h[3],i.position.x+l,i.position.y-o,c[0],c[1],c[2],c[3],i.position.x-l,i.position.y+o,c[0],c[1],c[2],c[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t]}}class Oe{constructor(t){this.ranges=t}layout(t,e){const i=this.ranges.R.value;if(this.ranges.use_cluster_splitting.value){const e=Object.keys(t.node_groups).sort((e,i)=>t.node_groups[i].length-t.node_groups[e].length),s=i/e.length;let n=i;e.forEach(e=>{const i=t.node_groups[e];Oe.layout_cluster(i,n),n-=s})}else Oe.layout_cluster(t.nodes,i);return t.onNodesReplaced(),!0}getParamsNames(){return["R","use_cluster_splitting"]}setConfiguration(t){this.ranges=t}getConfiguration(){return this.ranges}static layout_cluster(t,e){let i=0;const s=Object.keys(t).filter(e=>!t[e].is_hidden),n=2*Math.PI/s.length;s.forEach(s=>{const r=t[s];r.position.x=e*Math.cos(i),r.position.y=e*Math.sin(i),i+=n})}}var Le=o.isLinkViewDisabled;class Ce{constructor(t){this.ranges=t}layout(t,e){const i=e+20,s=this.ranges.iterations_count.value,n=this.ranges.optimal_vertex_distance.value,r=this.ranges.is_bounding.value,a=this.ranges.use_cluster_splitting.value,o=new _([0,0]),l=Object.keys(t.node_groups);if(a&&l.length>1){const e={};Object.keys(t.links).forEach(i=>{const s=t.links[i];s.from.group==s.to.group&&(e[s.from.group]||(e[s.from.group]=[]),e[s.from.group].push(s))});const a=.75*i;let h=0;const c=2*Math.PI/l.length;l.forEach(u=>{o.x=a*Math.cos(h),o.y=a*Math.sin(h),h+=c;const d=i*i/l.length,g=n/l.length,p=s/l.length;Ce.layout_cluster(g,d,p,r,o,t.node_groups[u],e[u])})}else{const e=Object.keys(t.links).map(e=>t.links[e]);Ce.layout_cluster(n,i,s,r,o,t.nodes,e)}return t.onNodesReplaced(),!0}getParamsNames(){return["iterations_count","optimal_vertex_distance","is_bounding","use_cluster_splitting"]}getConfiguration(){return this.ranges}setConfiguration(t){this.ranges=t}static layout_cluster(t,e,i,s,n,r,a){const o=Object.keys(r).filter(t=>!r[t].is_hidden),l=o.length,h=t*Math.sqrt(e/l);let c=10*Math.sqrt(l);const u=(t,e,i)=>t*t/h,d=(t,e,i)=>h*h/t,g={};o.forEach(t=>{g[t]=new _([0,0]);const e=h,i=2*Math.PI/l;let s=0;o.forEach(t=>{r[t].position.x=n.x+e*Math.cos(s),r[t].position.y=n.y+e*Math.sin(s),s+=i})});const p=new _;if(a)for(let t=0;t<i&&c>1e-5;t++)o.forEach(t=>{const e=r[t];o.forEach(i=>{if(t!=i){const s=r[i];_.difference(e.position,s.position,p);let n=p.length();const a=d(n,e.size,s.size);g[i].x-=p.x/n*a,g[i].y-=p.y/n*a,g[t].x+=p.x/n*a,g[t].y+=p.y/n*a}})}),a.forEach(t=>{if(!Le(t)){const e=t.from,i=t.to;_.difference(e.position,i.position,p);let s=p.length();const n=Math.min(u(s,e.size,i.size),s/2);g[i.id].x+=p.x/s*n,g[i.id].y+=p.y/s*n,g[e.id].x-=p.x/s*n,g[e.id].y-=p.y/s*n}}),o.forEach(t=>{const i=r[t];let a=g[t].length();a>0&&(i.position.x+=g[t].x/a*Math.min(c,a),i.position.y+=g[t].y/a*Math.min(c,a),s&&(i.position.x=n.x+Math.min(e,Math.max(-e,i.position.x-n.x)),i.position.y=n.y+Math.min(e,Math.max(-e,i.position.y-n.y)))),g[t].x=0,g[t].y=0}),c*=.9}}class Me{constructor(t){this.container=null,this.controller=null,this.translator=null}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%",this.clear()}clear(){this.container.innerHTML=`<p>${this.translator.apply("LOC_NO_SELECTED_NODE")}</p>`}fill(t){const e=t.graph,i=t.node_id,s=e.mutable_graph.getNode(i);this.container.innerHTML="";const n=document.createElement("div");{const t=document.createElement("input");t.type="text",t.style.fontWeight="bold",t.style.width="300px",t.style.marginRight="5px",t.value=s.data.label;const e=document.createElement("button");e.className="scivi_button",e.innerText=this.translator.apply("LOC_CHANGE"),e.onclick=e=>this.controller("ChangeNodeName",{node_id:i,new_name:t.value}),n.appendChild(t),n.appendChild(e)}{const t=document.createElement("ul");t.style.listStyleType="disc",s.data&&Object.keys(s.data).forEach(e=>{const i=document.createElement("li");i.innerText=`${e}: ${s.data[e]}`,t.appendChild(i)}),n.appendChild(t)}const r=document.createElement("div");r.innerHTML=`<label>${this.translator.apply("#out_links_text")}</label>`;{const t=document.createElement("ul");t.style.listStyleType="disc";const i=e.mutable_graph.getLinks(s.id);i&&i.filter(t=>t.fromId==s.id).forEach(i=>{const s=document.createElement("li");s.innerText=""+e.mutable_graph.getNode(i.toId).data.label,t.appendChild(s)}),r.appendChild(t)}this.container.appendChild(n),this.container.appendChild(r)}}var Te;!function(t){t[t.NoFilter=0]="NoFilter",t[t.SubstringFilter=1]="SubstringFilter",t[t.StringFilter=2]="StringFilter",t[t.RegExpFilter=3]="RegExpFilter"}(Te||(Te={}));const Ie=ne+"_node_list_tab_content";class Fe{constructor(t){this.container=null,this.controller=null,this.translator=null,this.bound_graph=null,this.filter_string=""}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";const s=document.createElement("div");s.id="scivi_fsgraph_node_list_tab_filter_panel";{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_NOT"),t.onclick=()=>{this.m_not=!this.m_not,this.m_not?t.classList.add("pushed"):t.classList.remove("pushed"),this.updateList()},s.appendChild(t)}{const t=document.createElement("input");t.type="text",t.style.marginRight="5px",t.width=200,t.oninput=()=>{this.filter_string=t.value,this.updateList()},s.appendChild(t)}{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_FINDSTRING"),t.onclick=()=>{},s.appendChild(t)}{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_FINDREGEXP"),t.onclick=()=>{},s.appendChild(t)}this.container.appendChild(s);const n=document.createElement("div");n.id="scivi_fsgraph_node_list_tab_header",n.style.marginTop="5px";{const t=document.createElement("div"),e=document.createElement("span");e.innerText=i.apply("LOC_VISIBLE"),e.style.textAlign="center",e.style.width="auto",e.style.display="inline-block";const s=document.createElement("span");s.innerText=i.apply("LOC_SELECTED"),s.style.textAlign="center",s.style.width="auto",s.style.display="inline-block",s.style.marginLeft="10px",t.appendChild(e),t.appendChild(s),n.appendChild(t)}{const t=document.createElement("button");t.innerText=this.translator.apply("LOC_ALL"),t.className="scivi_button",t.style.width="auto",t.style.textAlign="center",t.onclick=this.ShowAllFilteredNodes;const e=document.createElement("button");e.innerText=this.translator.apply("LOC_NONE"),e.className="scivi_button",e.style.width="auto",e.style.textAlign="center",e.onclick=this.HideAllFilteredNodes,n.appendChild(t),n.appendChild(e)}{const t=document.createElement("button");t.innerText=this.translator.apply("LOC_ALL"),t.className="scivi_button",t.style.width="auto",t.style.textAlign="center",t.style.marginLeft="17px",t.onclick=this.SelectAllFilteredNodes;const e=document.createElement("button");e.innerText=this.translator.apply("LOC_NONE"),e.className="scivi_button",e.style.width="auto",e.style.textAlign="center",e.onclick=this.DeselectAllFilteredNodes,n.appendChild(t),n.appendChild(e)}this.container.appendChild(n);const r=document.createElement("div");r.id=Ie,this.container.appendChild(r),this.clear()}clear(){document.getElementById(Ie).innerHTML=`<p>${this.translator.apply("LOC_NO_GRAPH")}</p>`,this.bound_graph=null}fill(t){this.bound_graph=t,this.updateList()}onSelectedNode(t){document.getElementById("node_info"+t).getElementsByTagName("input")[1].checked=!0}onDeselectedNode(t){document.getElementById("node_info"+t).getElementsByTagName("input")[1].checked=!1}updateList(){if(this.bound_graph){const t=document.getElementById(Ie);t.innerHTML="";const e=this.filter_string.length>0;this.bound_graph.source_graph.forEachNode(i=>(e&&!this.matchStr(i.data.label,this.filter_string,Te.SubstringFilter)||this.postNodeInfo(t,i),!1))}}matchStr(t,e,i){if(null===e||0===e.length)return!0;switch(i){case Te.NoFilter:return!0;case Te.SubstringFilter:return this.m_not?-1===t.indexOf(e):-1!==t.indexOf(e);case Te.StringFilter:return this.m_not?t!==e:t===e;case Te.RegExpFilter:return this.m_not?null===t.match(e):null!==t.match(e)}return!1}postNodeInfo(t,e){const i=document.createElement("li");i.id="node_info"+e.id,i.style.listStyleType="none";const s=document.createElement("input");s.type="checkbox",s.style.marginLeft="18px",s.checked=!this.bound_graph.isManuallyHiddenNode(e.id),s.onclick=()=>{s.checked?this.controller("ShowNode",{node_id:e.id}):this.controller("HideNode",{node_id:e.id})};const n=document.createElement("input");n.type="checkbox",n.style.marginLeft="55px",n.style.marginRight="18px",n.onclick=()=>{n.checked?this.controller("SelectNode",{node_id:e.id}):this.controller("DeselectNode",{node_id:e.id})};const r=document.createElement("span");return r.style.fontWeight="normal",r.innerText=e.data.label,i.appendChild(s),i.appendChild(n),i.appendChild(r),t.appendChild(i),!1}ShowAllFilteredNodes(){const t=document.getElementById(Ie);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[0];e.checked=!0,e.onclick.apply(e)})}HideAllFilteredNodes(){const t=document.getElementById(Ie);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[0];e.checked=!1,e.onclick.apply(e)})}SelectAllFilteredNodes(){const t=document.getElementById(Ie);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[1];e.checked=!0,e.onclick.apply(e)})}DeselectAllFilteredNodes(){const t=document.getElementById(Ie);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[1];e.checked=!1,e.onclick.apply(e)})}}var Pe;!function(t){t[t.UNKNONW=0]="UNKNONW",t[t.NUMBER=1]="NUMBER",t[t.BOOLEAN=2]="BOOLEAN"}(Pe||(Pe={}));class Re{Reset(){this._value=this._range.default}get range(){return this._range}get type(){return this._type}get value(){return this._value}}class Be extends Re{constructor(t,e,i,s){super(),i=i?Math.min(Math.max(i,t),e):t,this._range={min:t,max:e,default:i,step:s||0},this._value=i,this._type=Pe.NUMBER}get value(){return this._value}set value(t){this._value=Math.min(Math.max(t,this._range.min),this._range.max)}}class De extends Re{constructor(t){super(),this._value=t||!1,this._range={min:!1,max:!0,default:t||!1},this._type=Pe.BOOLEAN}get value(){return this._value}set value(t){this._value=t}}const Ue=ne+"_settings_tab_node_alpha_label",Ge=ne+"_settings_tab_link_alpha_label",Ve=ne+"_settings_tab_node_size_label",$e=ne+"_settings_tab_link_size_label",qe=ne+"_settings_tab_border_size_label",He=ne+"_settings_tab_layout_builder_selector";class We{constructor(t){this.container=null,this.controller=null,this.translator=null,t?(this.layouts=t.Layouts,this.view_config=t.view_config):(this.layouts=null,this.view_config=null)}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";const s=document.createElement("div");{const t=document.createElement("div");{const e=document.createElement("div");e.innerHTML=""+i.apply("LOC_PASSIVETEXTALPHA");const s=document.createElement("span");s.id=Ue,e.appendChild(s);const n=document.createElement("div");n.id="scivi_fsgraph_settings_tab_node_alpha_slider",n.style.margin="10px",t.appendChild(e),t.appendChild(n)}const e=document.createElement("div");{const t=document.createElement("div");t.innerHTML=""+i.apply("LOC_PASSIVEEDGEALPHA");const s=document.createElement("span");s.id=Ge,t.appendChild(s);const n=document.createElement("div");n.id="scivi_fsgraph_settings_tab_link_alpha_slider",n.style.margin="10px",e.appendChild(t),e.appendChild(n)}s.appendChild(t),s.appendChild(e)}this.container.appendChild(s),Ye(this.container),$("#scivi_fsgraph_settings_tab_node_alpha_slider").slider({min:0,max:1,step:.01,value:1,slide:(t,i)=>{const s=i.value||0;document.getElementById(Ue).innerText=" "+s,e("SetNodeAlpha",{alpha:s})},create:()=>document.getElementById(Ue).innerText="1"}),$("#scivi_fsgraph_settings_tab_link_alpha_slider").slider({min:0,max:1,step:.01,value:1,slide:(t,i)=>{const s=i.value||0;document.getElementById(Ge).innerText=" "+s,e("SetLinkAlpha",{alpha:s})},create:()=>document.getElementById(Ge).innerText="1"});const n=document.createElement("div");{const t=document.createElement("div");{const e=document.createElement("div");e.innerHTML=""+i.apply("LOC_NODE_SIZE_TEXT");const s=document.createElement("span");s.id=Ve,e.appendChild(s);const n=document.createElement("div");n.id="scivi_fsgraph_settings_tab_node_size_slider",n.style.margin="10px",t.appendChild(e),t.appendChild(n)}const e=document.createElement("div");{const t=document.createElement("div");t.innerHTML=""+i.apply("LOC_LINK_SIZE_TEXT");const s=document.createElement("span");s.id=$e,t.appendChild(s);const n=document.createElement("div");n.id="scivi_fsgraph_settings_tab_link_size_slider",n.style.margin="10px",e.appendChild(t),e.appendChild(n)}const s=document.createElement("div");{const t=document.createElement("div");t.innerHTML=""+i.apply("LOC_BORDER_SIZE_TEXT");const s=document.createElement("span");s.id=qe,t.appendChild(s);const n=document.createElement("div");n.id="scivi_fsgraph_settings_tab_border_size_slider",n.style.margin="10px",e.appendChild(t),e.appendChild(n)}n.appendChild(t),n.appendChild(e),n.appendChild(s)}this.container.appendChild(n),Ye(this.container);{const t={min:this.view_config.min_node_size,max:this.view_config.max_node_size};$("#scivi_fsgraph_settings_tab_node_size_slider").slider({range:!0,min:t.min,max:t.max,step:.01,values:[t.min,t.max],slide:(t,e)=>{const i=e.values[0],s=e.values[1];document.getElementById(Ve).innerText=`[${i.toFixed(2)} — ${s.toFixed(2)}]`,this.controller("SetNodeSizeRange",{min:i,max:s})},create:()=>{document.getElementById(Ve).innerText=`[${t.min.toFixed(2)} — ${t.max.toFixed(2)}]`}})}{const t={min:this.view_config.min_link_size,max:this.view_config.max_link_size};$("#scivi_fsgraph_settings_tab_link_size_slider").slider({range:!0,min:t.min,max:t.max,step:.01,values:[t.min,t.max],slide:(t,e)=>{const i=e.values[0],s=e.values[1];document.getElementById($e).innerText=`[${i.toFixed(2)} — ${s.toFixed(2)}]`,this.controller("SetLinkSizeRange",{min:i,max:s})},create:()=>{document.getElementById($e).innerText=`[${t.min.toFixed(2)} — ${t.max.toFixed(2)}]`}})}$("#scivi_fsgraph_settings_tab_border_size_slider").slider({min:0,max:.3,step:.01,value:.1,slide:(t,i)=>{const s=i.value||0;document.getElementById(qe).innerText=" "+s,e("SetBorderSize",{size:s})},create:()=>document.getElementById(qe).innerText=" 0.1"});const r=document.createElement("ul");r.style.display="flex",r.style.flexDirection="column",r.style.padding="0";{const t=document.createElement("li");t.style.listStyleType="none",t.style.display="flex",t.style.flexDirection="row";{const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="space-between",e.style.flex="1";const s=document.createElement("span");s.innerText=i.apply("LOC_NODEFONT");const n=document.createElement("input");n.id="scivi_fsgraph_settings_tab_node_font_size_input",n.style.width="70px",n.type="number",n.min="5",n.max="50",n.value="24",n.required=!0,e.appendChild(s),e.appendChild(n),t.appendChild(e)}const e=document.createElement("button");e.className="scivi_button",e.innerText=i.apply("LOC_APPLY"),e.style.marginLeft="10px",e.onclick=()=>{const t=document.getElementById("scivi_fsgraph_settings_tab_node_font_size_input");this.controller("SetLabelFontSize",{font_size:parseInt(t.value)})},t.appendChild(e),r.appendChild(t)}{const t=document.createElement("li");t.style.listStyleType="none";const s=document.createElement("span");s.innerText=i.apply("#always_show_labels")+":";const n=document.createElement("input");n.id="scivi_fsgraph_settings_tab_always_show_label_input",n.type="checkbox",n.value="false",n.onclick=()=>e("ToggleLabelsShowing",null),t.appendChild(s),t.appendChild(n),r.appendChild(t)}{const t=document.createElement("li");t.style.listStyleType="none";const s=document.createElement("span");s.innerText=i.apply("#always_show_weights")+":";const n=document.createElement("input");n.id="scivi_fsgraph_settings_tab_always_show_label_input",n.type="checkbox",n.value="false",n.onclick=()=>e("ToggleWeightsShowing",null),t.appendChild(s),t.appendChild(n),r.appendChild(t)}{const t=document.createElement("li");t.style.listStyleType="none";const s=document.createElement("span");s.innerText=i.apply("#label_layout_strategy")+":";const n=document.createElement("select");n.id="scivi_fsgraph_settings_tab_label_layout_stratefy",n.required=!0,n.onchange=()=>e("SelectLabelLayoutStrategy",{strategy_id:n.options[n.selectedIndex].value});const a=document.createElement("option");a.value="0",a.text=i.apply("#around_vertex_strategy"),a.selected=!0;const o=document.createElement("option");o.value="1",o.text=i.apply("#inside_vertex_strategy"),n.appendChild(o),n.appendChild(a),t.appendChild(s),t.appendChild(n),r.appendChild(t)}if(this.container.appendChild(r),Ye(this.container),Object.keys(this.layouts).length>0){const t=document.createElement("div");{const e=document.createElement("select");e.id=He,e.name=He;const s=document.createElement("ul");s.id="scivi_fsgraph_settings_tab_layout_builder_configuration",s.style.margin="10px 10px",e.onchange=()=>{s.innerHTML="";const t=this.layouts[e.value].getConfiguration();t&&Object.keys(t).forEach(e=>{const i=t[e],n=i.range,r=document.createElement("li");r.style.listStyleType="none",r.innerHTML=this.translator.apply("#"+e+"_text")+": ";const a=document.createElement("input");a.className="layout_input",a.id=e,i instanceof De?(a.type="checkbox",a.checked=i.value):(a.type="number",a.max=String(n.max),a.min=String(n.min),a.step=String(n.step),a.value=String(n.default)),r.appendChild(a),s.appendChild(r)})};const n=document.createElement("button");n.id="scivi_fsgraph_settings_tab_build_layout_button",n.innerText=i.apply("LOC_BUILD_LAYOUT"),n.className="scivi_button",n.onclick=()=>{const t=this.layouts[e.value].getConfiguration();Object.keys(t).forEach(e=>{const i=document.getElementById(e);switch(t[e].type){case Pe.NUMBER:t[e].value=parseFloat(i.value);break;case Pe.BOOLEAN:t[e].value=i.checked}}),this.controller("layout",{builder:this.layouts[e.value]})},t.appendChild(e),t.appendChild(s),t.appendChild(n)}this.container.appendChild(t),Ye(this.container),this.fillLayouts()}const a=document.createElement("div");{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_FIT_TO_SCREEN"),t.id="scivi_fsgraph_settings_tab_fit_to_screen_button",t.onclick=()=>this.controller("FitToScreen",null);const e=document.createElement("button");e.className="scivi_button",e.innerText=i.apply("LOC_CALC_MODULARITY"),e.id="scivi_fsgraph_settings_tab_calc_modularity_button",e.onclick=()=>this.controller("Clusterise",null);const s=document.createElement("button");s.className="scivi_button",s.innerText=i.apply("LOC_SAVE_GRAPH"),s.id="scivi_fsgraph_settings_tab_graph_export_button",s.onclick=()=>this.controller("ExportGraph",null);const n=document.createElement("button");n.className="scivi_button",n.innerText=i.apply("#save_as_png"),n.onclick=()=>this.controller("SavePNG",null),a.appendChild(t),a.appendChild(e),a.appendChild(s),a.appendChild(n)}this.container.appendChild(a),Ye(this.container);const o=document.createElement("button");o.className="scivi_button",o.innerText=i.apply("LOC_HELP"),this.container.appendChild(o)}clear(){}fill(t){}fillLayouts(){const t=document.getElementById(He);document.getElementById("scivi_fsgraph_settings_tab_layout_builder_configuration");Object.keys(this.layouts).forEach(e=>{const i=document.createElement("option");i.value=e,i.innerText=this.translator.apply("#"+e),e==Object.keys(this.layouts)[0]&&(i.selected=!0),t.appendChild(i)})}}function Ye(t){t.appendChild(document.createElement("br")),t.appendChild(document.createElement("hr")),t.appendChild(document.createElement("br"))}class Ke{constructor(t){this.container=null,this.controller=null,this.translator=null,this.min_node_weight=null,this.max_node_weight=null,this.min_link_weight=null,this.max_link_weight=null}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";{const t=document.createElement("div");{const e=document.createElement("p");e.innerHTML=i.apply("LOC_NODE_THRESHOLD")+'\n                               <input type="number" id="scivi_fsgraph_filters_tab_node_threshold_min" size="10" onkeydown="size=value.length||10">\n                                —\n                                <input type="number" id="scivi_fsgraph_filters_tab_node_threshold_max" size="10" onkeydown="size=value.length||10">',t.appendChild(e)}const e=document.createElement("div");e.id="scivi_fsgraph_filters_tab_node_threshold_slider",t.appendChild(e),this.container.appendChild(t)}{const t=document.createElement("div");{const e=document.createElement("p");e.innerHTML=i.apply("LOC_LINK_THRESHOLD")+'\n                               <input type="number" id="scivi_fsgraph_filters_tab_link_threshold_min">\n                                —\n                                <input type="number" id="scivi_fsgraph_filters_tab_link_threshold_max">',t.appendChild(e)}const e=document.createElement("div");e.id="scivi_fsgraph_filters_tab_link_threshold_slider",t.appendChild(e),this.container.appendChild(t)}}clear(){this.min_node_weight=new Be(0,1),this.max_node_weight=new Be(0,1),this.min_link_weight=new Be(0,1),this.max_link_weight=new Be(0,1),this.UpdateRanges()}fill(t){const e=t;if(e.meta.node_weight_range){const t=e.meta.node_weight_range,i=(t.max-t.min)/e.meta.nodes_count;this.min_node_weight=new Be(t.min,t.max,t.min,i),this.max_node_weight=new Be(t.min,t.max,t.max,i)}if(e.meta.link_weight_range){const t=e.meta.link_weight_range,i=(t.max-t.min)/e.meta.links_count;this.min_link_weight=new Be(t.min,t.max,t.min,i),this.max_link_weight=new Be(t.min,t.max,t.max,i)}this.UpdateRanges()}UpdateRanges(){{const t=document.getElementById("scivi_fsgraph_filters_tab_node_threshold_min");this.min_node_weight?(t.min=String(this.min_node_weight.range.min),t.max=String(this.min_node_weight.range.max),t.step=String(this.min_node_weight.range.step),t.value=String(this.min_node_weight.value)):t.disabled=!0;const e=document.getElementById("scivi_fsgraph_filters_tab_node_threshold_max");if(this.max_node_weight?(e.min=String(this.max_node_weight.range.min),e.max=String(this.max_node_weight.range.max),e.step=String(this.max_node_weight.range.step),e.value=String(this.max_node_weight.value)):e.disabled=!0,!t.disabled&&!e.disabled){const i=$("#scivi_fsgraph_filters_tab_node_threshold_slider");t.onchange=()=>{this.min_node_weight.value=parseFloat(t.value),i.slider({values:[this.min_node_weight.value,this.max_node_weight.value]}),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})},e.onchange=()=>{this.max_node_weight.value=parseFloat(e.value),i.slider({values:[this.min_node_weight.value,this.max_node_weight.value]}),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})},i.slider({range:!0,min:this.min_node_weight.range.min,max:this.max_node_weight.range.max,step:this.min_node_weight.range.step,values:[this.min_node_weight.value,this.max_node_weight.value],slide:(i,s)=>{this.min_node_weight.value=s.values[0],this.max_node_weight.value=s.values[1],t.value=String(this.min_node_weight.value),e.value=String(this.max_node_weight.value),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})}})}}{const t=document.getElementById("scivi_fsgraph_filters_tab_link_threshold_min");this.min_link_weight?(t.min=String(this.min_link_weight.range.min),t.max=String(this.min_link_weight.range.max),t.step=String(this.min_link_weight.range.step),t.value=String(this.min_link_weight.value)):t.disabled=!0;const e=document.getElementById("scivi_fsgraph_filters_tab_link_threshold_max");this.max_link_weight?(e.min=String(this.max_link_weight.range.min),e.max=String(this.max_link_weight.range.max),e.step=String(this.max_link_weight.range.step),e.value=String(this.max_link_weight.value)):e.disabled=!0;const i=$("#scivi_fsgraph_filters_tab_link_threshold_slider");t.disabled||e.disabled||(t.onchange=()=>{this.min_link_weight.value=parseFloat(t.value),i.slider({values:[this.min_link_weight.value,this.max_link_weight.value]}),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})},e.onchange=()=>{this.max_link_weight.value=parseFloat(e.value),i.slider({values:[this.min_link_weight.value,this.max_link_weight.value]}),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})},i.slider({range:!0,min:this.min_link_weight.range.min,max:this.max_link_weight.range.max,step:this.min_link_weight.range.step,values:[this.min_link_weight.value,this.max_link_weight.value],slide:(i,s)=>{this.min_link_weight.value=s.values[0],this.max_link_weight.value=s.values[1],t.value=String(this.min_link_weight.value),e.value=String(this.max_link_weight.value),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})}}))}}}var Xe;!function(t){t.UNION="UNION",t.INTERSECT="INTERSECT",t.DIFF="DIFF",t.SYMDIFF="SYMDIFF"}(Xe||(Xe={}));const Je=ne+"_calculator_tab_expression";class Ze{build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";const s=document.createElement("div");s.id=Je,s.style.marginBottom="1rem",this.container.appendChild(s),s.appendChild(document.createElement("br"));const n=document.createElement("button");n.className="scivi_button",n.innerText=this.translator.apply("LOC_ADDOPERAND"),this.container.appendChild(n),n.onclick=this.addOperand.bind(this);const r=document.createElement("button");r.className="scivi_button",r.innerText=this.translator.apply("LOC_CALCULATE"),this.container.appendChild(r),r.onclick=()=>this.controller("CalcState",{expr:Ze.buildExpression(s)});const a=document.createElement("button");a.className="scivi_button",a.innerText=this.translator.apply("LOC_CLEANCALC"),this.container.appendChild(a),a.onclick=this.initExpression.bind(this)}clear(){}fill(t){const e=t;this.states=e.states.map(t=>t.label),this.operators={},Object.keys(Xe).forEach(t=>{this.operators[t]=this.translator.apply("#"+t)}),this.initExpression()}initExpression(){const t=document.getElementById(Je);t.innerHTML="",t.appendChild(Ze.createOperandCombo(this.states)),t.appendChild(Ze.createOperatorCombo(this.operators)),t.appendChild(Ze.createOperandCombo(this.states)),t.appendChild(document.createElement("br"))}addOperand(){const t=document.getElementById(Je);t.appendChild(Ze.createOperatorCombo(this.operators)),t.appendChild(Ze.createOperandCombo(this.states)),t.appendChild(document.createElement("br"))}static createOperandCombo(t){const e=document.createElement("select");return t.forEach(i=>{const s=document.createElement("option");s.innerText=i,s.value=String(t.indexOf(i)),e.appendChild(s)}),e}static createOperatorCombo(t){const e=document.createElement("select");return Object.keys(t).forEach(i=>{const s=document.createElement("option");s.innerText=t[i],s.value=i,e.appendChild(s)}),e}static buildExpression(t){return Array.from(t.getElementsByTagName("select")).map(t=>t.value)}}class Qe{constructor(t){this.container=null,this.controller=null,this.translator=null}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%",this.clear()}clear(){this.container.innerHTML=`\n            <h3 id=scivi_fsgraph_about_tab_graph_name>no graph</h3>\n            <h3>${this.translator.apply("#metrics")}</h3>\n            <ul>\n                <li style="list-style-type: none">${this.translator.apply("#groups_count")}: <span id=scivi_fsgraph_about_tab_groups_count_metric></span></li>\n                <li style="list-style-type: none">${this.translator.apply("#nodes_count")}: <span id=scivi_fsgraph_about_tab_nodes_count_metric></span></li>\n                <li style="list-style-type: none">${this.translator.apply("#links_count")}: <span id=scivi_fsgraph_about_tab_links_count_metric></span></li>\n                \n            </ul>\n        `}fill(t){const e=t;document.getElementById("scivi_fsgraph_about_tab_graph_name").innerText="::"+e.label,document.getElementById("scivi_fsgraph_about_tab_nodes_count_metric").innerText=String(e.meta.nodes_count),document.getElementById("scivi_fsgraph_about_tab_links_count_metric").innerText=String(e.meta.links_count),document.getElementById("scivi_fsgraph_about_tab_groups_count_metric").innerText=String(e.meta.groups_count)}}function ti(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(i)return i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):""}}]);