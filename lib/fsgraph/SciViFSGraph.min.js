var SciViFSGraph="object"==typeof SciViFSGraph?SciViFSGraph:{};SciViFSGraph.main=function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="./src/index.ts")}({"./modified_modules/NonRandomLouvain/index.js":function(t,e,i){var n=i("./modified_modules/NonRandomLouvain/lib/createCommunityGraph.js"),s=i("./modified_modules/NonRandomLouvain/lib/createCommunity.js");t.exports=function(t,e){var i=n(t),r=s(i,e),o=r.modularity(),a=r.optimizeModularity(),l=r.modularity();return{canCoarse:function(){return a},originalModularity:o,newModularity:l,getClass:function(t){var e=i.getNodeIdFromNgraph(t);return r.getClass(e)}}}},"./modified_modules/NonRandomLouvain/lib/createCommunity.js":function(t,e){t.exports=function(t,e){for(var i=t.weight,n=t.nodeCount,s=new Float32Array(n),r=new Float32Array(n),o=new Uint32Array(n),a=0;a<n;++a)o[a]=a,s[a]=t.getWeightedDegree(a),r[a]=t.getSelfLoopsCount(a);return{modularity:d,optimizeModularity:function(){var e,i,s=function(){for(var t=[],e=0;e<n;++e)t[e]=e;return t}(),r=d(),a=!1;do{i=0,e=r;for(var p=0;p<s.length;++p){var g=s[p],m=o[g],_=l(g),f=_.get(m);u(g,m,f);var v=t.getWeightedDegree(g),y=m,b=0;_.forEach(function(t,e){var i=h(t,e,v);i<=b||(y=e,b=i)});var x=_.get(y);c(g,y,x),y!==m&&(i+=1)}r=d(),i>0&&(a=!0)}while(i>0&&r-e>1e-6);return a},getClass:function(t){return o[t]}};function l(e){var i=new Map;return i.set(o[e],0),t.forEachNeigbour(e,function(t,e){var n=o[t],s=i.get(n)||0;i.set(n,s+e)}),i}function h(t,e,n){var r=s[e];return t-r*n/i}function u(e,i,n){s[i]-=t.getWeightedDegree(e),r[i]-=2*n+t.getSelfLoopsCount(e),o[e]=-1}function c(e,i,n){s[i]+=t.getWeightedDegree(e),r[i]+=2*n+t.getSelfLoopsCount(e),o[e]=i}function d(){for(var t=0,e=0;e<n;++e)if(s[e]>0){var o=s[e]/i;t+=r[e]/i-o*o}return t}}},"./modified_modules/NonRandomLouvain/lib/createCommunityGraph.js":function(t,e){t.exports=function(t){var e=t.getNodesCount(),i=0,n=[],s=new Map;return t.forEachNode(function(t){var e,i;e=t.id,i=n.length,s.set(e,i),n.push({selfLoopsCount:0,weightedDegree:0,neighbours:null})}),t.forEachLink(function(t){var e,i=r(t.fromId),s=r(t.toId),a=(e=t.data)?"number"==typeof e?e:"number"==typeof e.weight?e.weight:1:1,l=n[i],h=n[s];i===s?(l.selfLoopsCount+=a,l.weightedDegree+=a):(o(l,s,a),o(h,i,a),l.weightedDegree+=a,h.weightedDegree+=a)}),i=function(){for(var t=0,i=0;i<e;++i)t+=a(i);return t}(),{nodeCount:e,weight:i,forEachNeigbour:function(t,e){var i=l(t);if(i.neighbours)for(var n=0;n<i.neighbours.length;++n){var s=i.neighbours[n];e(s.id,s.weight)}},getWeightedDegree:a,getSelfLoopsCount:function(t){return l(t).selfLoopsCount},getNodeIdFromNgraph:r};function r(t){var e=s.get(t);if(void 0===e)throw new Error("Unknown node id: "+t);return e}function o(t,e,i){var n={id:e,weight:i};t.neighbours?t.neighbours.push(n):t.neighbours=[n]}function a(t){return l(t).weightedDegree}function l(t){var e=n[t];if(!e)throw new Error("cannot find node with id: "+t);return e}}},"./modified_modules/tsm/constants.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"epsilon",function(){return n});const n=1e-5},"./modified_modules/tsm/mat2.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return r});var n=i("./modified_modules/tsm/vec2.ts"),s=i("./modified_modules/tsm/constants.ts");class r{constructor(t){this.values=new Float32Array(4),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<4;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<4;t++)this.values[t]=0}copy(t){t||(t=new r);for(let e=0;e<4;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<4;e++)t[e]=this.values[e];return t}row(t){return[this.values[2*t+0],this.values[2*t+1]]}col(t){return[this.values[t],this.values[t+2]]}equals(t,e=s.epsilon){for(let i=0;i<4;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}determinant(){return this.values[0]*this.values[3]-this.values[2]*this.values[1]}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=1,this}transpose(){const t=this.values[1];return this.values[1]=this.values[2],this.values[2]=t,this}inverse(){let t=this.determinant();if(!t)return null;t=1/t;const e=this.values[0];return this.values[0]=t*this.values[3],this.values[1]=t*-this.values[1],this.values[2]=t*-this.values[2],this.values[3]=t*e,this}multiply(t){const e=this.values[0],i=this.values[1],n=this.values[2],s=this.values[3];return this.values[0]=e*t.at(0)+i*t.at(2),this.values[1]=e*t.at(1)+i*t.at(3),this.values[2]=n*t.at(0)+s*t.at(2),this.values[3]=n*t.at(1)+s*t.at(3),this}rotate(t){const e=this.values[0],i=this.values[1],n=this.values[2],s=this.values[3],r=Math.sin(t),o=Math.cos(t);return this.values[0]=e*o+i*r,this.values[1]=e*-r+i*o,this.values[2]=n*o+s*r,this.values[3]=n*-r+s*o,this}multiplyVec2(t,e){const i=t.x,s=t.y;return e?(e.xy=[i*this.values[0]+s*this.values[1],i*this.values[2]+s*this.values[3]],e):new n.default([i*this.values[0]+s*this.values[1],i*this.values[2]+s*this.values[3]])}scale(t){const e=this.values[0],i=this.values[1],n=this.values[2],s=this.values[3],r=t.x,o=t.y;return this.values[0]=e*r,this.values[1]=i*o,this.values[2]=n*r,this.values[3]=s*o,this}static product(t,e,i){const n=t.at(0),s=t.at(1),o=t.at(2),a=t.at(3);return i?(i.init([n*e.at(0)+s*e.at(2),n*e.at(1)+s*e.at(3),o*e.at(0)+a*e.at(2),o*e.at(1)+a*e.at(3)]),i):new r([n*e.at(0)+s*e.at(2),n*e.at(1)+s*e.at(3),o*e.at(0)+a*e.at(2),o*e.at(1)+a*e.at(3)])}}r.identity=(new r).setIdentity()},"./modified_modules/tsm/mat3.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return l});var n=i("./modified_modules/tsm/mat4.ts"),s=i("./modified_modules/tsm/quat.ts"),r=i("./modified_modules/tsm/vec2.ts"),o=i("./modified_modules/tsm/vec3.ts"),a=i("./modified_modules/tsm/constants.ts");class l{constructor(t){this.values=new Float32Array(9),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<9;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<9;t++)this.values[t]=0}copy(t){t||(t=new l);for(let e=0;e<9;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<9;e++)t[e]=this.values[e];return t}row(t){return[this.values[3*t+0],this.values[3*t+1],this.values[3*t+2]]}col(t){return[this.values[t],this.values[t+3],this.values[t+6]]}equals(t,e=a.epsilon){for(let i=0;i<9;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}determinant(){const t=this.values[0],e=this.values[1],i=this.values[2],n=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8];return t*(l*s-r*a)+e*(-l*n+r*o)+i*(a*n-s*o)}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=1,this.values[5]=0,this.values[6]=0,this.values[7]=0,this.values[8]=1,this}transpose(){const t=this.values[1],e=this.values[2],i=this.values[5];return this.values[1]=this.values[3],this.values[2]=this.values[6],this.values[3]=t,this.values[5]=this.values[7],this.values[6]=e,this.values[7]=i,this}inverse(){const t=this.values[0],e=this.values[1],i=this.values[2],n=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8],h=l*s-r*a,u=-l*n+r*o,c=a*n-s*o;let d=t*h+e*u+i*c;return d?(d=1/d,this.values[0]=h*d,this.values[1]=(-l*e+i*a)*d,this.values[2]=(r*e-i*s)*d,this.values[3]=u*d,this.values[4]=(l*t-i*o)*d,this.values[5]=(-r*t+i*n)*d,this.values[6]=c*d,this.values[7]=(-a*t+e*o)*d,this.values[8]=(s*t-e*n)*d,this):null}multiply(t){const e=this.values[0],i=this.values[1],n=this.values[2],s=this.values[3],r=this.values[4],o=this.values[5],a=this.values[6],l=this.values[7],h=this.values[8],u=t.at(0),c=t.at(1),d=t.at(2),p=t.at(3),g=t.at(4),m=t.at(5),_=t.at(6),f=t.at(7),v=t.at(8);return this.values[0]=u*e+c*s+d*a,this.values[1]=u*i+c*r+d*l,this.values[2]=u*n+c*o+d*h,this.values[3]=p*e+g*s+m*a,this.values[4]=p*i+g*r+m*l,this.values[5]=p*n+g*o+m*h,this.values[6]=_*e+f*s+v*a,this.values[7]=_*i+f*r+v*l,this.values[8]=_*n+f*o+v*h,this}multiplyVec2(t,e){const i=t.x,n=t.y;return e?(e.xy=[i*this.values[0]+n*this.values[3]+this.values[6],i*this.values[1]+n*this.values[4]+this.values[7]],e):new r.default([i*this.values[0]+n*this.values[3]+this.values[6],i*this.values[1]+n*this.values[4]+this.values[7]])}multiplyVec3(t,e){const i=t.x,n=t.y,s=t.z;return e?(e.xyz=[i*this.values[0]+n*this.values[3]+s*this.values[6],i*this.values[1]+n*this.values[4]+s*this.values[7],i*this.values[2]+n*this.values[5]+s*this.values[8]],e):new o.default([i*this.values[0]+n*this.values[3]+s*this.values[6],i*this.values[1]+n*this.values[4]+s*this.values[7],i*this.values[2]+n*this.values[5]+s*this.values[8]])}toMat4(t){return t?(t.init([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1]),t):new n.default([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1])}toQuat(){const t=this.values[0],e=this.values[1],i=this.values[2],n=this.values[3],r=this.values[4],o=this.values[5],a=this.values[6],l=this.values[7],h=this.values[8],u=t-r-h,c=r-t-h,d=h-t-r;let p=0,g=t+r+h;u>g&&(g=u,p=1),c>g&&(g=c,p=2),d>g&&(g=d,p=3);const m=.5*Math.sqrt(g+1),_=.25/m,f=new s.default;switch(p){case 0:f.w=m,f.x=(o-l)*_,f.y=(a-i)*_,f.z=(e-n)*_;break;case 1:f.w=(o-l)*_,f.x=m,f.y=(e+n)*_,f.z=(a+i)*_;break;case 2:f.w=(a-i)*_,f.x=(e+n)*_,f.y=m,f.z=(o+l)*_;break;case 3:f.w=(e-n)*_,f.x=(a+i)*_,f.y=(o+l)*_,f.z=m}return f}rotate(t,e){let i=e.x,n=e.y,s=e.z,r=Math.sqrt(i*i+n*n+s*s);if(!r)return null;1!==r&&(i*=r=1/r,n*=r,s*=r);const o=Math.sin(t),a=Math.cos(t),l=1-a,h=this.values[0],u=this.values[1],c=this.values[2],d=this.values[4],p=this.values[5],g=this.values[6],m=this.values[8],_=this.values[9],f=this.values[10],v=i*i*l+a,y=n*i*l+s*o,b=s*i*l-n*o,x=i*n*l-s*o,w=n*n*l+a,E=s*n*l+i*o,k=i*s*l+n*o,S=n*s*l-i*o,z=s*s*l+a;return this.values[0]=h*v+d*y+m*b,this.values[1]=u*v+p*y+_*b,this.values[2]=c*v+g*y+f*b,this.values[3]=h*x+d*w+m*E,this.values[4]=u*x+p*w+_*E,this.values[5]=c*x+g*w+f*E,this.values[6]=h*k+d*S+m*z,this.values[7]=u*k+p*S+_*z,this.values[8]=c*k+g*S+f*z,this}static product(t,e,i){const n=t.at(0),s=t.at(1),r=t.at(2),o=t.at(3),a=t.at(4),h=t.at(5),u=t.at(6),c=t.at(7),d=t.at(8),p=e.at(0),g=e.at(1),m=e.at(2),_=e.at(3),f=e.at(4),v=e.at(5),y=e.at(6),b=e.at(7),x=e.at(8);return i?(i.init([p*n+g*o+m*u,p*s+g*a+m*c,p*r+g*h+m*d,_*n+f*o+v*u,_*s+f*a+v*c,_*r+f*h+v*d,y*n+b*o+x*u,y*s+b*a+x*c,y*r+b*h+x*d]),i):new l([p*n+g*o+m*u,p*s+g*a+m*c,p*r+g*h+m*d,_*n+f*o+v*u,_*s+f*a+v*c,_*r+f*h+v*d,y*n+b*o+x*u,y*s+b*a+x*c,y*r+b*h+x*d])}}l.identity=(new l).setIdentity()},"./modified_modules/tsm/mat4.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return a});var n=i("./modified_modules/tsm/mat3.ts"),s=i("./modified_modules/tsm/vec3.ts"),r=i("./modified_modules/tsm/vec4.ts"),o=i("./modified_modules/tsm/constants.ts");class a{constructor(t){this.values=new Float32Array(16),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<16;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<16;t++)this.values[t]=0}copy(t){t||(t=new a);for(let e=0;e<16;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<16;e++)t[e]=this.values[e];return t}row(t){return[this.values[4*t+0],this.values[4*t+1],this.values[4*t+2],this.values[4*t+3]]}col(t){return[this.values[t],this.values[t+4],this.values[t+8],this.values[t+12]]}equals(t,e=o.epsilon){for(let i=0;i<16;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}determinant(){const t=this.values[0],e=this.values[1],i=this.values[2],n=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8],h=this.values[9],u=this.values[10],c=this.values[11],d=this.values[12],p=this.values[13],g=this.values[14],m=this.values[15];return(t*r-e*s)*(u*m-c*g)-(t*o-i*s)*(h*m-c*p)+(t*a-n*s)*(h*g-u*p)+(e*o-i*r)*(l*m-c*d)-(e*a-n*r)*(l*g-u*d)+(i*a-n*o)*(l*p-h*d)}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=0,this.values[5]=1,this.values[6]=0,this.values[7]=0,this.values[8]=0,this.values[9]=0,this.values[10]=1,this.values[11]=0,this.values[12]=0,this.values[13]=0,this.values[14]=0,this.values[15]=1,this}transpose(){const t=this.values[1],e=this.values[2],i=this.values[3],n=this.values[6],s=this.values[7],r=this.values[11];return this.values[1]=this.values[4],this.values[2]=this.values[8],this.values[3]=this.values[12],this.values[4]=t,this.values[6]=this.values[9],this.values[7]=this.values[13],this.values[8]=e,this.values[9]=n,this.values[11]=this.values[14],this.values[12]=i,this.values[13]=s,this.values[14]=r,this}inverse(){const t=this.values[0],e=this.values[1],i=this.values[2],n=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8],h=this.values[9],u=this.values[10],c=this.values[11],d=this.values[12],p=this.values[13],g=this.values[14],m=this.values[15],_=t*r-e*s,f=t*o-i*s,v=t*a-n*s,y=e*o-i*r,b=e*a-n*r,x=i*a-n*o,w=l*p-h*d,E=l*g-u*d,k=l*m-c*d,S=h*g-u*p,z=h*m-c*p,j=u*m-c*g;let A=_*j-f*z+v*S+y*k-b*E+x*w;return A?(A=1/A,this.values[0]=(r*j-o*z+a*S)*A,this.values[1]=(-e*j+i*z-n*S)*A,this.values[2]=(p*x-g*b+m*y)*A,this.values[3]=(-h*x+u*b-c*y)*A,this.values[4]=(-s*j+o*k-a*E)*A,this.values[5]=(t*j-i*k+n*E)*A,this.values[6]=(-d*x+g*v-m*f)*A,this.values[7]=(l*x-u*v+c*f)*A,this.values[8]=(s*z-r*k+a*w)*A,this.values[9]=(-t*z+e*k-n*w)*A,this.values[10]=(d*b-p*v+m*_)*A,this.values[11]=(-l*b+h*v-c*_)*A,this.values[12]=(-s*S+r*E-o*w)*A,this.values[13]=(t*S-e*E+i*w)*A,this.values[14]=(-d*y+p*f-g*_)*A,this.values[15]=(l*y-h*f+u*_)*A,this):null}multiply(t){const e=this.values[0],i=this.values[1],n=this.values[2],s=this.values[3],r=this.values[4],o=this.values[5],a=this.values[6],l=this.values[7],h=this.values[8],u=this.values[9],c=this.values[10],d=this.values[11],p=this.values[12],g=this.values[13],m=this.values[14],_=this.values[15];let f=t.at(0),v=t.at(1),y=t.at(2),b=t.at(3);return this.values[0]=f*e+v*r+y*h+b*p,this.values[1]=f*i+v*o+y*u+b*g,this.values[2]=f*n+v*a+y*c+b*m,this.values[3]=f*s+v*l+y*d+b*_,f=t.at(4),v=t.at(5),y=t.at(6),b=t.at(7),this.values[4]=f*e+v*r+y*h+b*p,this.values[5]=f*i+v*o+y*u+b*g,this.values[6]=f*n+v*a+y*c+b*m,this.values[7]=f*s+v*l+y*d+b*_,f=t.at(8),v=t.at(9),y=t.at(10),b=t.at(11),this.values[8]=f*e+v*r+y*h+b*p,this.values[9]=f*i+v*o+y*u+b*g,this.values[10]=f*n+v*a+y*c+b*m,this.values[11]=f*s+v*l+y*d+b*_,f=t.at(12),v=t.at(13),y=t.at(14),b=t.at(15),this.values[12]=f*e+v*r+y*h+b*p,this.values[13]=f*i+v*o+y*u+b*g,this.values[14]=f*n+v*a+y*c+b*m,this.values[15]=f*s+v*l+y*d+b*_,this}multiplyVec3(t){const e=t.x,i=t.y,n=t.z;return new s.default([this.values[0]*e+this.values[4]*i+this.values[8]*n+this.values[12],this.values[1]*e+this.values[5]*i+this.values[9]*n+this.values[13],this.values[2]*e+this.values[6]*i+this.values[10]*n+this.values[14]])}multiplyVec4(t,e){e||(e=new r.default);const i=t.x,n=t.y,s=t.z,o=t.w;return e.x=this.values[0]*i+this.values[4]*n+this.values[8]*s+this.values[12]*o,e.y=this.values[1]*i+this.values[5]*n+this.values[9]*s+this.values[13]*o,e.z=this.values[2]*i+this.values[6]*n+this.values[10]*s+this.values[14]*o,e.w=this.values[3]*i+this.values[7]*n+this.values[11]*s+this.values[15]*o,e}toMat3(){return new n.default([this.values[0],this.values[1],this.values[2],this.values[4],this.values[5],this.values[6],this.values[8],this.values[9],this.values[10]])}toInverseMat3(){const t=this.values[0],e=this.values[1],i=this.values[2],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[8],l=this.values[9],h=this.values[10],u=h*r-o*l,c=-h*s+o*a,d=l*s-r*a;let p=t*u+e*c+i*d;return p?(p=1/p,new n.default([u*p,(-h*e+i*l)*p,(o*e-i*r)*p,c*p,(h*t-i*a)*p,(-o*t+i*s)*p,d*p,(-l*t+e*a)*p,(r*t-e*s)*p])):null}translate(t){const e=t.x,i=t.y,n=t.z;return this.values[12]+=this.values[0]*e+this.values[4]*i+this.values[8]*n,this.values[13]+=this.values[1]*e+this.values[5]*i+this.values[9]*n,this.values[14]+=this.values[2]*e+this.values[6]*i+this.values[10]*n,this.values[15]+=this.values[3]*e+this.values[7]*i+this.values[11]*n,this}scale(t){const e=t.x,i=t.y,n=t.z;return this.values[0]*=e,this.values[1]*=e,this.values[2]*=e,this.values[3]*=e,this.values[4]*=i,this.values[5]*=i,this.values[6]*=i,this.values[7]*=i,this.values[8]*=n,this.values[9]*=n,this.values[10]*=n,this.values[11]*=n,this}rotate(t,e){let i=e.x,n=e.y,s=e.z,r=Math.sqrt(i*i+n*n+s*s);if(!r)return null;1!==r&&(i*=r=1/r,n*=r,s*=r);const o=Math.sin(t),a=Math.cos(t),l=1-a,h=this.values[0],u=this.values[1],c=this.values[2],d=this.values[3],p=this.values[4],g=this.values[5],m=this.values[6],_=this.values[7],f=this.values[8],v=this.values[9],y=this.values[10],b=this.values[11],x=i*i*l+a,w=n*i*l+s*o,E=s*i*l-n*o,k=i*n*l-s*o,S=n*n*l+a,z=s*n*l+i*o,j=i*s*l+n*o,A=n*s*l-i*o,C=s*s*l+a;return this.values[0]=h*x+p*w+f*E,this.values[1]=u*x+g*w+v*E,this.values[2]=c*x+m*w+y*E,this.values[3]=d*x+_*w+b*E,this.values[4]=h*k+p*S+f*z,this.values[5]=u*k+g*S+v*z,this.values[6]=c*k+m*S+y*z,this.values[7]=d*k+_*S+b*z,this.values[8]=h*j+p*A+f*C,this.values[9]=u*j+g*A+v*C,this.values[10]=c*j+m*A+y*C,this.values[11]=d*j+_*A+b*C,this}static frustum(t,e,i,n,s,r){const o=e-t,l=n-i,h=r-s;return new a([2*s/o,0,0,0,0,2*s/l,0,0,(e+t)/o,(n+i)/l,-(r+s)/h,-1,0,0,-r*s*2/h,0])}static perspective(t,e,i,n){const s=i*Math.tan(t*Math.PI/360),r=s*e;return a.frustum(-r,r,-s,s,i,n)}static orthographic(t,e,i,n,s,r){const o=e-t,l=n-i,h=r-s;return new a([2/o,0,0,0,0,2/l,0,0,0,0,-2/h,0,-(t+e)/o,-(n+i)/l,-(r+s)/h,1])}static lookAt(t,e,i=s.default.up){if(t.equals(e))return this.identity;const n=s.default.difference(t,e).normalize(),r=s.default.cross(i,n).normalize(),o=s.default.cross(n,r).normalize();return new a([r.x,o.x,n.x,0,r.y,o.y,n.y,0,r.z,o.z,n.z,0,-s.default.dot(r,t),-s.default.dot(o,t),-s.default.dot(n,t),1])}static product(t,e,i){const n=t.at(0),s=t.at(1),r=t.at(2),o=t.at(3),l=t.at(4),h=t.at(5),u=t.at(6),c=t.at(7),d=t.at(8),p=t.at(9),g=t.at(10),m=t.at(11),_=t.at(12),f=t.at(13),v=t.at(14),y=t.at(15),b=e.at(0),x=e.at(1),w=e.at(2),E=e.at(3),k=e.at(4),S=e.at(5),z=e.at(6),j=e.at(7),A=e.at(8),C=e.at(9),N=e.at(10),O=e.at(11),L=e.at(12),M=e.at(13),T=e.at(14),I=e.at(15);return i?(i.init([b*n+x*l+w*d+E*_,b*s+x*h+w*p+E*f,b*r+x*u+w*g+E*v,b*o+x*c+w*m+E*y,k*n+S*l+z*d+j*_,k*s+S*h+z*p+j*f,k*r+S*u+z*g+j*v,k*o+S*c+z*m+j*y,A*n+C*l+N*d+O*_,A*s+C*h+N*p+O*f,A*r+C*u+N*g+O*v,A*o+C*c+N*m+O*y,L*n+M*l+T*d+I*_,L*s+M*h+T*p+I*f,L*r+M*u+T*g+I*v,L*o+M*c+T*m+I*y]),i):new a([b*n+x*l+w*d+E*_,b*s+x*h+w*p+E*f,b*r+x*u+w*g+E*v,b*o+x*c+w*m+E*y,k*n+S*l+z*d+j*_,k*s+S*h+z*p+j*f,k*r+S*u+z*g+j*v,k*o+S*c+z*m+j*y,A*n+C*l+N*d+O*_,A*s+C*h+N*p+O*f,A*r+C*u+N*g+O*v,A*o+C*c+N*m+O*y,L*n+M*l+T*d+I*_,L*s+M*h+T*p+I*f,L*r+M*u+T*g+I*v,L*o+M*c+T*m+I*y])}}a.identity=(new a).setIdentity()},"./modified_modules/tsm/quat.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return a});var n=i("./modified_modules/tsm/mat3.ts"),s=i("./modified_modules/tsm/mat4.ts"),r=i("./modified_modules/tsm/vec3.ts"),o=i("./modified_modules/tsm/constants.ts");class a{constructor(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get w(){return this.values[3]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}get xyzw(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set w(t){this.values[3]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set xyzw(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}at(t){return this.values[t]}reset(){for(let t=0;t<4;t++)this.values[t]=0}copy(t){t||(t=new a);for(let e=0;e<4;e++)t.values[e]=this.values[e];return t}roll(){const t=this.x,e=this.y,i=this.z,n=this.w;return Math.atan2(2*(t*e+n*i),n*n+t*t-e*e-i*i)}pitch(){const t=this.x,e=this.y,i=this.z,n=this.w;return Math.atan2(2*(e*i+n*t),n*n-t*t-e*e+i*i)}yaw(){return Math.asin(2*(this.x*this.z-this.w*this.y))}equals(t,e=o.epsilon){for(let i=0;i<4;i++)if(Math.abs(this.values[i]-t.at(i))>e)return!1;return!0}setIdentity(){return this.x=0,this.y=0,this.z=0,this.w=1,this}calculateW(){const t=this.x,e=this.y,i=this.z;return this.w=-Math.sqrt(Math.abs(1-t*t-e*e-i*i)),this}inverse(){const t=a.dot(this,this);if(!t)return this.xyzw=[0,0,0,0],this;const e=t?1/t:0;return this.x*=-e,this.y*=-e,this.z*=-e,this.w*=e,this}conjugate(){return this.values[0]*=-1,this.values[1]*=-1,this.values[2]*=-1,this}length(){const t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)}normalize(t){t||(t=this);const e=this.x,i=this.y,n=this.z,s=this.w;let r=Math.sqrt(e*e+i*i+n*n+s*s);return r?(r=1/r,t.x=e*r,t.y=i*r,t.z=n*r,t.w=s*r,t):(t.x=0,t.y=0,t.z=0,t.w=0,t)}add(t){for(let e=0;e<4;e++)this.values[e]+=t.at(e);return this}multiply(t){const e=this.values[0],i=this.values[1],n=this.values[2],s=this.values[3],r=t.x,o=t.y,a=t.z,l=t.w;return this.x=e*l+s*r+i*a-n*o,this.y=i*l+s*o+n*r-e*a,this.z=n*l+s*a+e*o-i*r,this.w=s*l-e*r-i*o-n*a,this}multiplyVec3(t,e){e||(e=new r.default);const i=t.x,n=t.y,s=t.z,o=this.x,a=this.y,l=this.z,h=this.w,u=h*i+a*s-l*n,c=h*n+l*i-o*s,d=h*s+o*n-a*i,p=-o*i-a*n-l*s;return e.x=u*h+p*-o+c*-l-d*-a,e.y=c*h+p*-a+d*-o-u*-l,e.z=d*h+p*-l+u*-a-c*-o,e}toMat3(t){t||(t=new n.default);const e=this.x,i=this.y,s=this.z,r=this.w,o=e+e,a=i+i,l=s+s,h=e*o,u=e*a,c=e*l,d=i*a,p=i*l,g=s*l,m=r*o,_=r*a,f=r*l;return t.init([1-(d+g),u+f,c-_,u-f,1-(h+g),p+m,c+_,p-m,1-(h+d)]),t}toMat4(t){t||(t=new s.default);const e=this.x,i=this.y,n=this.z,r=this.w,o=e+e,a=i+i,l=n+n,h=e*o,u=e*a,c=e*l,d=i*a,p=i*l,g=n*l,m=r*o,_=r*a,f=r*l;return t.init([1-(d+g),u+f,c-_,0,u-f,1-(h+g),p+m,0,c+_,p-m,1-(h+d),0,0,0,0,1]),t}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static sum(t,e,i){return i||(i=new a),i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i.w=t.w+e.w,i}static product(t,e,i){i||(i=new a);const n=t.x,s=t.y,r=t.z,o=t.w,l=e.x,h=e.y,u=e.z,c=e.w;return i.x=n*c+o*l+s*u-r*h,i.y=s*c+o*h+r*l-n*u,i.z=r*c+o*u+n*h-s*l,i.w=o*c-n*l-s*h-r*u,i}static cross(t,e,i){i||(i=new a);const n=t.x,s=t.y,r=t.z,o=t.w,l=e.x,h=e.y,u=e.z,c=e.w;return i.x=o*u+r*c+n*h-s*l,i.y=o*c-n*l-s*h-r*u,i.z=o*l+n*c+s*u-r*h,i.w=o*h+s*c+r*l-n*u,i}static shortMix(t,e,i,n){if(n||(n=new a),i<=0)return n.xyzw=t.xyzw,n;if(i>=1)return n.xyzw=e.xyzw,n;let s=a.dot(t,e);const r=e.copy();let o,l;if(s<0&&(r.inverse(),s=-s),s>.9999)o=1-i,l=0+i;else{const t=Math.sqrt(1-s*s),e=Math.atan2(t,s),n=1/t;o=Math.sin((1-i)*e)*n,l=Math.sin((0+i)*e)*n}return n.x=o*t.x+l*r.x,n.y=o*t.y+l*r.y,n.z=o*t.z+l*r.z,n.w=o*t.w+l*r.w,n}static mix(t,e,i,n){n||(n=new a);const s=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w;if(Math.abs(s)>=1)return n.xyzw=t.xyzw,n;const r=Math.acos(s),o=Math.sqrt(1-s*s);if(Math.abs(o)<.001)return n.x=.5*t.x+.5*e.x,n.y=.5*t.y+.5*e.y,n.z=.5*t.z+.5*e.z,n.w=.5*t.w+.5*e.w,n;const l=Math.sin((1-i)*r)/o,h=Math.sin(i*r)/o;return n.x=t.x*l+e.x*h,n.y=t.y*l+e.y*h,n.z=t.z*l+e.z*h,n.w=t.w*l+e.w*h,n}static fromAxisAngle(t,e,i){i||(i=new a),e*=.5;const n=Math.sin(e);return i.x=t.x*n,i.y=t.y*n,i.z=t.z*n,i.w=Math.cos(e),i}}a.identity=(new a).setIdentity()},"./modified_modules/tsm/tsm.ts":function(t,e,i){"use strict";i.r(e);var n=i("./modified_modules/tsm/mat2.ts");i.d(e,"mat2",function(){return n.default});var s=i("./modified_modules/tsm/mat3.ts");i.d(e,"mat3",function(){return s.default});var r=i("./modified_modules/tsm/mat4.ts");i.d(e,"mat4",function(){return r.default});var o=i("./modified_modules/tsm/quat.ts");i.d(e,"quat",function(){return o.default});var a=i("./modified_modules/tsm/vec2.ts");i.d(e,"vec2",function(){return a.default});var l=i("./modified_modules/tsm/vec3.ts");i.d(e,"vec3",function(){return l.default});var h=i("./modified_modules/tsm/vec4.ts");i.d(e,"vec4",function(){return h.default})},"./modified_modules/tsm/vec2.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return r});var n=i("./modified_modules/tsm/vec3.ts"),s=i("./modified_modules/tsm/constants.ts");class r{constructor(t){this.values=new Float32Array(2),void 0!==t&&(this.xy=t)}get x(){return this.values[0]}get y(){return this.values[1]}get xy(){return[this.values[0],this.values[1]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}at(t){return this.values[t]}reset(){this.x=0,this.y=0}copy(t){return t||(t=new r),t.x=this.x,t.y=this.y,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t}equals(t,e=s.epsilon){return!(Math.abs(this.x-t.x)>e)&&!(Math.abs(this.y-t.y)>e)}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y;return t*t+e*e}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}divide(t){return this.x/=t.x,this.y/=t.y,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x=0,t.y=0,t):(e=1/e,t.x*=e,t.y*=e,t)}multiplyMat2(t,e){return e||(e=this),t.multiplyVec2(this,e)}multiplyMat3(t,e){return e||(e=this),t.multiplyVec2(this,e)}static cross(t,e,i){i||(i=new n.default);const s=t.x,r=t.y,o=e.x,a=s*e.y-r*o;return i.x=0,i.y=0,i.z=a,i}static dot(t,e){return t.x*e.x+t.y*e.y}static distance(t,e){return Math.sqrt(this.squaredDistance(t,e))}static squaredDistance(t,e){const i=e.x-t.x,n=e.y-t.y;return i*i+n*n}static direction(t,e,i){i||(i=new r);const n=t.x-e.x,s=t.y-e.y;let o=Math.sqrt(n*n+s*s);return 0===o?(i.x=0,i.y=0,i):(o=1/o,i.x=n*o,i.y=s*o,i)}static mix(t,e,i,n){n||(n=new r);const s=t.x,o=t.y,a=e.x,l=e.y;return n.x=s+i*(a-s),n.y=o+i*(l-o),n}static sum(t,e,i){return i||(i=new r),i.x=t.x+e.x,i.y=t.y+e.y,i}static difference(t,e,i){return i||(i=new r),i.x=t.x-e.x,i.y=t.y-e.y,i}static product(t,e,i){return i||(i=new r),i.x=t.x*e.x,i.y=t.y*e.y,i}static quotient(t,e,i){return i||(i=new r),i.x=t.x/e.x,i.y=t.y/e.y,i}}r.zero=new r([0,0]),r.one=new r([1,1])},"./modified_modules/tsm/vec3.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return r});var n=i("./modified_modules/tsm/quat.ts"),s=i("./modified_modules/tsm/constants.ts");class r{constructor(t){this.values=new Float32Array(3),void 0!==t&&(this.xyz=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}at(t){return this.values[t]}reset(){this.x=0,this.y=0,this.z=0}copy(t){return t||(t=new r),t.x=this.x,t.y=this.y,t.z=this.z,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t}equals(t,e=s.epsilon){return!(Math.abs(this.x-t.x)>e)&&(!(Math.abs(this.y-t.y)>e)&&!(Math.abs(this.z-t.z)>e))}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e.z*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x=0,t.y=0,t.z=0,t):(e=1/e,t.x*=e,t.y*=e,t.z*=e,t)}multiplyByMat3(t,e){return e||(e=this),t.multiplyVec3(this,e)}multiplyByQuat(t,e){return e||(e=this),t.multiplyVec3(this,e)}toQuat(t){t||(t=new n.default);const e=new r,i=new r;return e.x=Math.cos(.5*this.x),i.x=Math.sin(.5*this.x),e.y=Math.cos(.5*this.y),i.y=Math.sin(.5*this.y),e.z=Math.cos(.5*this.z),i.z=Math.sin(.5*this.z),t.x=i.x*e.y*e.z-e.x*i.y*i.z,t.y=e.x*i.y*e.z+i.x*e.y*i.z,t.z=e.x*e.y*i.z-i.x*i.y*e.z,t.w=e.x*e.y*e.z+i.x*i.y*i.z,t}static cross(t,e,i){i||(i=new r);const n=t.x,s=t.y,o=t.z,a=e.x,l=e.y,h=e.z;return i.x=s*h-o*l,i.y=o*a-n*h,i.z=n*l-s*a,i}static dot(t,e){const i=t.x,n=t.y,s=t.z;return i*e.x+n*e.y+s*e.z}static distance(t,e){e.x,t.x,e.y,t.y,e.z,t.z;return Math.sqrt(this.squaredDistance(t,e))}static squaredDistance(t,e){const i=e.x-t.x,n=e.y-t.y,s=e.z-t.z;return i*i+n*n+s*s}static direction(t,e,i){i||(i=new r);const n=t.x-e.x,s=t.y-e.y,o=t.z-e.z;let a=Math.sqrt(n*n+s*s+o*o);return 0===a?(i.x=0,i.y=0,i.z=0,i):(a=1/a,i.x=n*a,i.y=s*a,i.z=o*a,i)}static mix(t,e,i,n){return n||(n=new r),n.x=t.x+i*(e.x-t.x),n.y=t.y+i*(e.y-t.y),n.z=t.z+i*(e.z-t.z),n}static sum(t,e,i){return i||(i=new r),i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i}static difference(t,e,i){return i||(i=new r),i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i}static product(t,e,i){return i||(i=new r),i.x=t.x*e.x,i.y=t.y*e.y,i.z=t.z*e.z,i}static quotient(t,e,i){return i||(i=new r),i.x=t.x/e.x,i.y=t.y/e.y,i.z=t.z/e.z,i}}r.zero=new r([0,0,0]),r.one=new r([1,1,1]),r.up=new r([0,1,0]),r.right=new r([1,0,0]),r.forward=new r([0,0,1])},"./modified_modules/tsm/vec4.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return s});var n=i("./modified_modules/tsm/constants.ts");class s{constructor(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get w(){return this.values[3]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}get xyzw(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set w(t){this.values[3]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set xyzw(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}get r(){return this.values[0]}get g(){return this.values[1]}get b(){return this.values[2]}get a(){return this.values[3]}get rg(){return[this.values[0],this.values[1]]}get rgb(){return[this.values[0],this.values[1],this.values[2]]}get rgba(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set r(t){this.values[0]=t}set g(t){this.values[1]=t}set b(t){this.values[2]=t}set a(t){this.values[3]=t}set rg(t){this.values[0]=t[0],this.values[1]=t[1]}set rgb(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set rgba(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}at(t){return this.values[t]}reset(){this.x=0,this.y=0,this.z=0,this.w=0}copy(t){return t||(t=new s),t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t}equals(t,e=n.epsilon){return!(Math.abs(this.x-t.x)>e)&&(!(Math.abs(this.y-t.y)>e)&&(!(Math.abs(this.z-t.z)>e)&&!(Math.abs(this.w-t.w)>e)))}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e.z*=t,e.w*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x*=0,t.y*=0,t.z*=0,t.w*=0,t):(e=1/e,t.x*=e,t.y*=e,t.z*=e,t.w*=e,t)}multiplyMat4(t,e){return e||(e=this),t.multiplyVec4(this,e)}static mix(t,e,i,n){return n||(n=new s),n.x=t.x+i*(e.x-t.x),n.y=t.y+i*(e.y-t.y),n.z=t.z+i*(e.z-t.z),n.w=t.w+i*(e.w-t.w),n}static sum(t,e,i){return i||(i=new s),i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i.w=t.w+e.w,i}static difference(t,e,i){return i||(i=new s),i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i.w=t.w-e.w,i}static product(t,e,i){return i||(i=new s),i.x=t.x*e.x,i.y=t.y*e.y,i.z=t.z*e.z,i.w=t.w*e.w,i}static quotient(t,e,i){return i||(i=new s),i.x=t.x/e.x,i.y=t.y/e.y,i.z=t.z/e.z,i.w=t.w/e.w,i}}s.zero=new s([0,0,0,1]),s.one=new s([1,1,1,1])},"./node_modules/call-bind/callBound.js":function(t,e,i){"use strict";var n=i("./node_modules/get-intrinsic/index.js"),s=i("./node_modules/call-bind/index.js"),r=s(n("String.prototype.indexOf"));t.exports=function(t,e){var i=n(t,!!e);return"function"==typeof i&&r(t,".prototype.")>-1?s(i):i}},"./node_modules/call-bind/index.js":function(t,e,i){"use strict";var n=i("./node_modules/function-bind/index.js"),s=i("./node_modules/get-intrinsic/index.js"),r=s("%Function.prototype.apply%"),o=s("%Function.prototype.call%"),a=s("%Reflect.apply%",!0)||n.call(o,r),l=s("%Object.getOwnPropertyDescriptor%",!0),h=s("%Object.defineProperty%",!0),u=s("%Math.max%");if(h)try{h({},"a",{value:1})}catch(t){h=null}t.exports=function(t){var e=a(n,o,arguments);l&&h&&(l(e,"length").configurable&&h(e,"length",{value:1+u(0,t.length-(arguments.length-1))}));return e};var c=function(){return a(n,r,arguments)};h?h(t.exports,"apply",{value:c}):t.exports.apply=c},"./node_modules/chroma.ts/dist/index.es.js":function(t,e,i){"use strict";i.r(e),i.d(e,"Color",function(){return k}),i.d(e,"CubeHelix",function(){return N}),i.d(e,"Scale",function(){return J}),i.d(e,"analyze",function(){return it}),i.d(e,"average",function(){return H}),i.d(e,"bezier",function(){return W}),i.d(e,"black",function(){return S}),i.d(e,"blend",function(){return Y}),i.d(e,"brewer",function(){return j}),i.d(e,"cmyk",function(){return T}),i.d(e,"color",function(){return E}),i.d(e,"contrast",function(){return Q}),i.d(e,"css",function(){return M}),i.d(e,"cubehelix",function(){return C}),i.d(e,"deltaE",function(){return et}),i.d(e,"distance",function(){return tt}),i.d(e,"gl",function(){return I}),i.d(e,"hcg",function(){return R}),i.d(e,"hsi",function(){return P}),i.d(e,"hsl",function(){return B}),i.d(e,"hsv",function(){return D}),i.d(e,"kelvin",function(){return U}),i.d(e,"lab",function(){return G}),i.d(e,"lch",function(){return F}),i.d(e,"limits",function(){return nt}),i.d(e,"mix",function(){return L}),i.d(e,"num",function(){return $}),i.d(e,"random",function(){return O}),i.d(e,"rgb",function(){return V}),i.d(e,"scale",function(){return X}),i.d(e,"scales",function(){return Z}),i.d(e,"w3cx11",function(){return A}),i.d(e,"white",function(){return z}),i.d(e,"xyz",function(){return q});const{abs:n,atan2:s,cos:r,floor:o,log:a,min:l,max:h,round:u,sign:c,sin:d,sqrt:p,cbrt:g,PI:m,hypot:_}=Math;function f(t,e,i){return t+(e-t)*i}function v(t,e=0,i=1){return t<e?e:t>i?i:t}function y(t,e,i,s=1e-8){let r,o=e;for(;i--&&n(r=t(o))>s;){const e=(t(o+s)-r)/s;console.log("fx / dfdx",r/e,"fx",r,"x",o),o-=r/e}return o}const b=2*m,x=m/180,w=180/m;function E(...t){return t[0]instanceof k?t[0]:t.length>1&&"string"==typeof t[t.length-1]?ot(t.slice(0,t.length-1),t[t.length-1]):Array.isArray(t[0])?ot(t[0]):ot(t)}class k{constructor(t,e,i,n=1){this.r=t,this.g=e,this.b=i,this.a=n}mix(t,e,i="rgb"){return L(this,t,e,i)}rgb(t=!0,e=!0){const i=i=>(t&&(i=u(i)),e&&(i=v(i,0,255)),i),{r:n,g:s,b:r}=this;return[i(n),i(s),i(r)]}rgba(t=!0,e=!0){const i=i=>(t&&(i=u(i)),e&&(i=v(i,0,255)),i),{r:n,g:s,b:r,a:o}=this;return[i(n),i(s),i(r),o]}hex(t="rgb"){const{r:e,g:i,b:n,a:s}=this;return function(t,e,i,n,s="rgb"){t=v(u(t),0,255),e=v(u(e),0,255),i=v(u(i),0,255);const r=(t<<16|e<<8|i).toString(16).padStart(6,"0"),o=u(255*v(n)).toString(16).padStart(2,"0");return"#"+("argb"==s?o+r:"rgba"==s?r+o:r)}(e,i,n,s,t)}hsl(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[n,s,r]=St(t/255,e/255,i/255),o=(r+s)/2;let a;a=r==s?0:o<.5?(r-s)/(r+s):(r-s)/(2-r-s);return[n,a,o]}(t,e,i)}hsv(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[n,s,r]=St(t,e,i),o=r-s;return[n,0==r?0:o/r,r/255]}(t,e,i)}hcg(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[n,s,r]=St(t,e,i),o=(r-s)/255;return[n,o,o<1?s/255/(1-o):0]}(t,e,i)}css(t="rgb"){if("rgb"==t){const{r:t,g:e,b:i,a:n}=this;return function(t,e,i,n=1){return n>=1?"rgb("+[t,e,i].map(u).join(",")+")":"rgba("+[t,e,i].map(u).join(",")+","+n+")"}(t,e,i,n)}if("hsl"==t)return function([t,e,i],n){const s=n<1?"hsla":"hsl";return s+"("+yt(t)+","+yt(100*e)+"%,"+yt(100*i)+"%"+("hsla"==s?","+yt(n):"")+")"}(this.hsl(),this.alpha());throw new Error}name(t=!1){const e=this.num(),i=Object.keys(A).find(t=>A[t]==e);if(!i&&t){const[t,e,i]=this.lab();return(n=Object.keys(A))[Bt(n,n=>{const[s,r,o]=$(A[n]).lab();return-_(t-s,e-r,i-o)})]}var n;return i}cmyk(){const{r:t,g:e,b:i}=this;return function(t,e,i){const n=1-h(t/=255,e/=255,i/=255);return 1==n?[0,0,0,1]:[(1-t-n)/(1-n),(1-e-n)/(1-n),(1-i-n)/(1-n),n]}(t,e,i)}gl(){const{r:t,g:e,b:i,a:n}=this;return[t/255,e/255,i/255,n]}luminance(t){const{r:e,g:i,b:n,a:s}=this,[,r]=Ft(e,i,n);if(void 0===t)return r;const o=(t,e,i)=>(i-t)/(e-t);return t>r?L(this,z,o(r,1,t),"xyz").alpha(s):L(S,this,o(0,r,t),"xyz").alpha(s)}temperature(){const{r:t,g:e,b:i}=this;return n=t,s=e,r=i,console.log(r-n),s+r<158.61?(console.log("0 < t < 20"),u(100*y(t=>s-(-155.25485562709179-.44596950469579133*(t-2)+104.49216199393888*a(t-2)),15,4))):r-n<0?(console.log("20 < t < 66"),u(100*y(t=>r-(.8274096064007395*(t-10)-254.76935184120902+115.67994401066147*a(t-10)),43,4))):(console.log("0 < t < 400, start= "+(-1.4*(n+s)+755)),u(100*y(t=>n-(351.97690566805693+.114206453784165*(t-55)-40.25366309332127*a(t-55)),-1.4*(n+s)+755,8)));var n,s,r}set(t,e){const[i,n]=t.split("."),s=this[i](),r=i.indexOf(n);if(-1==r)throw new Error("invalid channel");return s[r]="number"==typeof e?e:e(s[r]),E(s,i).alpha(this.a)}clipped(){const{r:t,g:e,b:i}=this;return!(0<=t&&t<=255&&0<=e&&e<=255&&0<=i&&i<=255)}textColor(){return this.luminance()>.5?S:z}alpha(t){if(void 0===t)return this.a;const{r:e,g:i,b:n}=this;return V(e,i,n,t)}darker(t=1){const[e,i,n]=this.lab();return G(e-Ct*t,i,n,this.alpha())}brighter(t=1){return this.darker(-t)}saturate(t=1){const[e,i,n]=this.lch();return F(e,h(0,i+t*Ct),n,this.alpha())}desaturate(t=1){return this.saturate(-t)}premultiplied(){const{r:t,g:e,b:i,a:n}=this;return V(t*n,e*n,i*n,n)}hsi(){const{r:t,g:e,b:i}=this;return function(t,e,i){const n=t/255,r=e/255,o=i/255,a=(n+r+o)/3;if(n==r&&r==o)return[0,0,a];{const t=.5*(2*n-r-o),e=p(3)/2*(r-o),i=s(e,t),h=l(n,r,o),u=1-h/a;return[(i<0?2*m+i:i)*w,u,a]}}(t,e,i)}lab(){const{r:t,g:e,b:i}=this;return Rt(t,e,i)}num(t="rgb"){const{r:e,g:i,b:n,a:s}=this;return function(t,e,i,n=1,s="rgb"){const r=u(t)<<16|u(e)<<8|u(i);return"rgb"===s?r:"rgba"===s?r<<8|u(255*n)<<24:u(255*n)<<24|r}(e,i,n,s,t)}lch(){const{r:t,g:e,b:i}=this;return function(t,e,i){const[n,r,o]=Rt(t,e,i);return function(t,e,i){const n=_(e,i),r=(s(i,e)*w+360)%360;return[t,n,r]}(n,r,o)}(t,e,i)}xyz(){const{r:t,g:e,b:i}=this;return Ft(t,e,i)}equals(t){const{r:e,g:i,b:n,a:s}=this,{r:r,g:o,b:a,a:l}=t;return e==r&&i==o&&n==a&&s==l}hashCode(){return this.num("rgba")}toSource(){const{r:t,g:e,b:i,a:n}=this;return"chroma.rgb("+t+", "+e+", "+i+(1===n?")":", "+n+")")}}k.prototype.toString=k.prototype.css,k.prototype.kelvin=k.prototype.temperature;const S=new k(0,0,0,1),z=new k(255,255,255,1),j={OrRd:[16775148,16705736,16635038,16628612,16551257,15689032,14102559,11730944,8323072],PuBu:[16775163,15525874,13685222,10927579,7645647,3576e3,356528,285325,145496],BuPu:[16252157,14740724,12571622,10403034,9213638,9202609,8929693,8458108,5046347],Oranges:[16774635,16705230,16634018,16625259,16616764,15821075,14239745,10892803,8333060],BuGn:[16252157,15070713,13429990,10082505,6734500,4304502,2329413,27948,17435],YlOrBr:[16777189,16775100,16704401,16696399,16685353,15495188,13388802,10040324,6694150],YlGn:[16777189,16252089,14282915,11394446,7915129,4303709,2327619,26679,17705],Reds:[16774640,16703698,16563105,16552562,16476746,15678252,13309981,10817301,6750221],RdPu:[16775155,16638173,16565696,16424885,16214177,14496919,11403646,7995767,4784234],Greens:[16252149,15070688,13101504,10607003,7652470,4303709,2329413,27948,17435],YlGnBu:[16777177,15595697,13101492,8375739,4306628,1937856,2252456,2438292,531800],Purples:[16579581,15724021,14342891,12369372,10394312,8420794,6967715,5515151,4128893],GnBu:[16252144,14742491,13429701,11066805,8113348,5157843,2854078,551084,540801],Greys:[16777215,15790320,14277081,12434877,9868950,7566195,5395026,2434341,0],YlOrRd:[16777164,16772512,16701814,16691788,16616764,16535082,14883356,12386342,8388646],PuRd:[16250105,15196655,13941210,13210823,14640560,15149450,13505110,9961539,6750239],Blues:[16251903,14609399,13032431,10406625,7057110,4362950,2191797,545180,536683],PuBuGn:[16775163,15524592,13685222,10927579,6793679,3576e3,164234,93273,83510],Viridis:[4456788,4728695,4147850,3237774,2524047,2071946,7130714,11984427,16705573],Spectral:[10355010,13975119,16018755,16625249,16703627,16777151,15136152,11263396,6734501,3311805,6180770],RdYlGn:[10813478,14102567,16018755,16625249,16703627,16777151,14282635,10934634,6733155,1742928,26679],RdBu:[6750239,11671595,14049357,16033154,16636871,16250871,13755888,9618910,4428739,2188972,340065],PiYG:[9306450,12917629,14579630,15840986,16638191,16250871,15136208,12116358,8371265,5083681,2581529],PRGn:[4194379,7744131,10055851,12756431,15193320,16250871,14282963,10935200,5942881,1800247,17435],RdYlBu:[10813478,14102567,16018755,16625249,16703632,16777151,14742520,11262441,7646673,4552116,3225237],BrBG:[5517317,9195786,12550445,14664317,16181443,16119285,13101797,8441281,3512207,91742,15408],RdGy:[6750239,11671595,14049357,16033154,16636871,16777215,14737632,12237498,8882055,5066061,1710618],PuOr:[8338184,11753478,14713364,16627811,16703670,16250871,14211819,11709394,8418220,5515144,2949195],Set2:[6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947],Accent:[8374655,12496596,16629894,16777113,3697840,15729279,12540695,6710886],Set1:[14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329],Set3:[9294791,16777139,12499674,16482418,8434131,16626786,11787881,16567781,14277081,12353725,13429701,16772463],Dark2:[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886],Paired:[10931939,2062516,11722634,3383340,16489113,14883356,16629615,16744192,13284054,6962586,16777113,11622696],Pastel2:[11789005,16633260,13358568,16042724,15136201,16773806,15852236,13421772],Pastel1:[16495790,11783651,13429701,14601188,16701862,16777164,15063229,16636652,15921906]},A={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflower:6591981,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,laserlemon:16777044,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrod:16448210,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,maroon2:8323072,maroon3:11546720,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,purple2:8323199,purple3:10494192,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function C(t=300,e=-1.5,i=1,n=1,s=[0,1]){const r=t=>r.at(t);return Object.getOwnPropertyNames(N.prototype).forEach(t=>r[t]=N.prototype[t]),r.start(t),r.rotations(e),r.hue(i),r.gamma(n),r.lightness(s),r}class N{start(t){return void 0===t?this._start:(this._start=t,this)}rotations(t){return void 0===t?this._rotations:(this._rotations=t,this)}gamma(t){return void 0===t?this._gamma:(this._gamma=t,this)}hue(t){return void 0===t?this._hue:(this._hue=Array.isArray(t)?t:[t,t],this)}lightness(t){return void 0===t?this._lightness:(this._lightness=Array.isArray(t)?t:[t,t],this)}scale(){return X(this)}at(t){const e=b*((this._start+120)/360+this._rotations*t),i=f(this._lightness[0],this._lightness[1],t)**this._gamma,n=f(this._hue[0],this._hue[1],t)*i*(1-i)/2,s=r(e),o=d(e);return V([255*(i+n*(-.14861*s+1.78277*o)),255*(i+n*(-.29227*s-.90649*o)),255*(i+n*(1.97294*s)),1])}}function O(t=Math.random){return $(16777216*t()|0)}function L(t,e,i=.5,n="rgb"){const s=E(t),r=E(e),o=st[n]&&st[n](s,r,i,n);if(!o)throw new Error("color mode "+n+" is not supported");return o.alpha(f(s.alpha(),r.alpha(),i))}function M(t){const[e,i,n,s]=vt(t);return new k(e,i,n,s)}function T(...t){return ot(t,"cmyk")}function I(...t){return ot(t,"gl")}function R(...t){return ot(t,"hcg")}function F(...t){return ot(t,"lch")}function P(...t){return ot(t,"hsi")}function B(...t){return ot(t,"hsl")}function D(...t){return ot(t,"hsv")}function U(t){const[e,i,n]=wt(t);return new k(e,i,n)}function G(...t){return ot(t,"lab")}function $(t){const[e,i,n]=ht(t);return new k(e,i,n)}function V(...t){return ot(t,"rgb")}function q(...t){return ot(t,"xyz")}function H(t,e="rgb"){const i=t.map(t=>E(t));if("lrgb"==e)return function(t){let e=0,i=0,n=0,s=0;for(const r of t){const[t,o,a,l]=r.rgba(!1,!1);e+=t**2,i+=o**2,n+=a**2,s+=l}return new k(p(e)/t.length,p(i)/t.length,p(n)/t.length,s/t.length)}(i);if("num"==e){let t=0,e=0;for(const n of i)t+=n.num(),e+=n.alpha();return $(t/i.length).alpha(e/i.length)}const n=[0,0,0];let o=0,a=0,l=0;for(const t of i){const i=t[e]();l+=t.alpha();for(let t=0;t<n.length;t++)if("h"==e.charAt(t)){const e=i[t]*x;o+=r(e),a+=d(e)}else n[t]+=i[t]}for(let t=0;t<n.length;t++)if("h"==e.charAt(t)){const e=s(a/i.length,o/i.length)*w;n[t]=(e+360)%360}else n[t]=n[t]/i.length;return ot(n,e).alpha(l/i.length)}function W(...t){const e=function t(e){const i=e.map(t=>E(t));const[n,s,r,o]=i.map(t=>t.lab());if(2==e.length)return t=>G([0,1,2].map(e=>f(n[e],s[e],t)));if(3==e.length){const t=(t,e,i,n)=>(1-n)**2*t+2*(1-n)*n*e+n**2*i;return e=>G([0,1,2].map(i=>t(n[i],s[i],r[i],e)))}if(4==e.length){const t=(t,e,i,n,s)=>(1-s)**3*t+3*(1-s)**2*s*e+3*(1-s)*s**2*i+s**3*n;return e=>G([0,1,2].map(i=>t(n[i],s[i],r[i],o[i],e)))}if(5==e.length){const e=t(i.slice(0,3)),n=t(i.slice(2,5));return t=>t<.5?e(2*t):n(2*(t-.5))}throw new Error}(Array.isArray(t[0])?t[0]:t);return e.scale=N.prototype.scale,e}function Y(t,e,i){if(!K[i])throw new Error("unknown blend mode "+i);return K[i](t,e)}const K={normal:Et(kt((t,e)=>t)),multiply:Et(kt((t,e)=>t*e/255)),screen:Et(kt(function(t,e){return 255*(1-(1-t/255)*(1-e/255))})),overlay:Et(kt(function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))})),darken:Et(kt(l)),lighten:Et(kt(h)),dodge:Et(kt(function(t,e){if(255==t)return 255;return 255*l(1,e/255/(1-t/255))})),burn:Et(kt(function(t,e){return 255*(1-(1-e/255)/(t/255))}))};function X(...t){const e=t=>e._at(t);return Object.getOwnPropertyNames(J.prototype).forEach(t=>e[t]=J.prototype[t]),Array.isArray(t[0])&&(t=t[0]),1==t.length&&"string"==typeof t[0]&&(t=j[t[0]]),e._init("function"==typeof t[0]?t[0]:t.map(t=>E(t))),e}class J{classes(t){if(void 0===t)return this._classes;if(Array.isArray(t))this._classes=t,this.domain(t[0],t[t.length-1]);else{if(t%1!=0||t<1)throw new Error("invalid classes param");this._classes=nt(this.domain(),"e",t)}return this}domain(...t){if(void 0===t[0])return"function"!=typeof this._colors?this._pos.map(t=>f(this._min,this._max,t)):[this._min,this._max];if(this._min=t[0],this._max=t[t.length-1],2==t.length)"function"!=typeof this._colors&&(this._pos=this._colors.map((t,e)=>e/(this._colors.length-1)));else{if("function"==typeof this._colors||t.length!=this._colors.length)throw new Error("invalid domain "+t);this._pos=t.map(t=>(function(t,e,i){return(i-t)/(e-t)})(this._min,this._max,t))}return this}mode(t){return void 0===t?this._mode:(this._mode=t,this._resetCache(),this)}out(t){return this._out=t,this}correctLightness(t=!0){if(this._correctLightness!=t){this._resetCache();const e=this._colors;if(t&&"function"!=typeof e){let t=0;for(let i=1;i<e.length;i++){const n=e[i].lab()[0]-e[i-1].lab()[0];if(0==t)t=n;else if(t*n<0)throw new Error("scale color lightnesses must be monotonic")}}}return this._correctLightness=t,this}padding(t,e=t){return t?(this._paddingLeft=t,this._paddingRight=e,this):[this._paddingLeft,this._paddingRight]}colors(t,e="hex"){let i;if(void 0===t)i=this._colors.slice();else if(1==t)i=[this._color((this._min+this._max)/2)];else if(t>1)i=Array.from({length:t},(e,i)=>this._color(f(this._min,this._max,i/(t-1))));else{let t;i=(t=this._classes&&this._classes.length>2?Array.from({length:this._classes.length-1},(t,e)=>.5*(this._classes[e]+this._classes[e+1])):this.domain()).map(t=>this._color(t))}return"color"!=e?i.map(t=>t[e]()):i}cache(t){return void 0===t?!!this._cache:(this._cache=t?this._cache||new Map:void 0,this)}gamma(t){return void 0===t?this._gamma:(this._gamma=t,this)}_at(t){const e=this._color(t);return this._out?e[this._out]():e}_init(t){this._colors=t,"function"!=typeof t&&(this._pos=t.map((e,i)=>i/(t.length-1))),this._mode="rgb",this.domain(0,1),this._paddingLeft=0,this._paddingRight=0,this._correctLightness=!1,this._cache=new Map,this._gamma=1}_getClass(t){return this._classes.findIndex(e=>t<=e)-1}_color(t,e=!1){let i;if(e)i=t;else{const e=this._min,n=this._max;if(this._classes&&this._classes.length>2){i=this._getClass(t)/(this._classes.length-2)}else i=n!==e?(t-e)/(n-e):1;this._correctLightness&&(i=this._tCorrectedLightness(i))}i=i**this._gamma;const n=i=v(i=(this._paddingLeft+i)/(1+this._paddingLeft+this._paddingRight),0,1),s=this._cache&&this._cache.get(n);if(s)return s;{let t;if(Array.isArray(this._colors))for(let e=0;e<this._pos.length;e++){const n=this._pos[e];if(i<=n){t=this._colors[e];break}if(i>=n&&e==this._pos.length-1){t=this._colors[e];break}if(i>n&&i<this._pos[e+1]){i=(i-n)/(this._pos[e+1]-n),t=L(this._colors[e],this._colors[e+1],i,this._mode);break}}else t=this._colors(i);return this._cache&&this._cache.set(n,t),t}}_tCorrectedLightness(t){const e=f(this._color(0,!0).lab()[0],this._color(1,!0).lab()[0],t);return function(t,e,i,n){let s=t(e);for(;n--;){const n=(e+i)/2,r=t(n);c(s)==c(r)?(e=n,s=r):i=n}return(e+i)/2}(t=>this._color(t,!0).lab()[0]-e,0,1,8)}_resetCache(){this._cache&&this._cache.clear()}}var Z;function Q(t,e){const i=E(t).luminance(),n=E(e).luminance();return i>n?(i+.05)/(n+.05):(n+.05)/(i+.05)}function tt(t,e,i="lab"){const n=E(t)[i](),s=E(e)[i](),r=n.map((t,e)=>t-s[e]);return _(...r)}function et(t,e,i=1,o=1){const[a,l,h]=E(t).lab(),[u,c,d]=E(e).lab(),g=p(l*l+h*h),m=p(c*c+d*d),_=a<16?.511:.040975*a/(1+.01765*a),f=.0638*g/(1+.0131*g)+.638,v=lt(g<1e-6?0:s(h,l)*w),y=v>=164&&v<=345?.56+n(.2*r((v+168)*x)):.36+n(.4*r((v+35)*x)),b=g*g*g*g,k=p(b/(b+1900)),S=f*(k*y+1-k),z=g-m,j=l-c,A=h-d,C=(a-u)/(i*_),N=z/(o*f);return p(C*C+N*N+(j*j+A*A-z*z)/(S*S))}function it(t){const e={min:1/0,max:-1/0,sum:0,values:[],count:0};return t.forEach(t=>(function(t){null==t||isNaN(t)||(e.values.push(t),e.sum+=t,t<e.min&&(e.min=t),t>e.max&&(e.max=t),e.count+=1)})(t)),e.domain=[e.min,e.max],e.limits=function(t,e){return nt(this,t,e)},e}function nt(t,e="e",i=7){const s=Array.isArray(t)?it(t):t,{min:r,max:l,values:h}=s;if(h.sort((t,e)=>t-e),1==i)return[r,l];if(e.startsWith("c"))return[r,l];if(e.startsWith("e"))return Array.from({length:i+1},(t,e)=>f(r,l,e/i));if(e.startsWith("l")){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");const t=Math.LOG10E*a(r),e=Math.LOG10E*a(l);return Array.from({length:i+1},(n,s)=>10**f(t,e,s/i))}if(e.startsWith("q"))return Array.from({length:i+1},(t,e)=>{const n=(h.length-1)*e/i,s=o(n);return s==n?h[s]:f(h[s],h[s+1],n-s)});if(e.startsWith("k")){const t=h.length,e=new Array(t),s=new Array(i);let o=!0,a=0,u=Array.from({length:i+1},(t,e)=>f(r,l,e/i));do{s.fill(0);for(let t=0;t<h.length;t++){const i=h[t],r=Bt(u,t=>-n(t-i));s[r]++,e[t]=r}const t=new Array(i).fill(0);for(let i=0;i<e.length;i++){t[e[i]]+=h[i]}for(let e=0;e<t.length;e++)t[e]/=s[e];o=t.some((t,e)=>t!=u[e]),u=t}while(a++<200&&o);const c=Array.from({length:i},()=>[]);for(let t=0;t<e.length;t++){c[e[t]].push(h[t])}const d=[];for(const t of c)d.push(t[0],t[t.length-1]);d.sort((t,e)=>t-e);const p=[];p.push(d[0]);for(let t=1;t<d.length;t+=2){const e=d[t];isNaN(e)||-1!=p.indexOf(e)||p.push(e)}return p}throw new Error("unknown mode")}!function(t){t.cool=function(){return X([B(180,1,.9),B(250,.7,.4)])},t.hot=function(){return X(["#000","#f00","#ff0","#fff"]).mode("rgb")}}(Z||(Z={}));const st={},rt={};function ot(t,e){if(Array.isArray(t[0])&&(t=t[0]),!e)if(1==t.length&&t[0]in A)e="name";else if(1==t.length&&"string"==typeof t[0])e="css";else if(3==t.length)e="rgb";else if(4==t.length&&"number"==typeof t[3]&&t[3]>=0&&t[3]<=1)e="rgb";else{if(!(1==t.length&&"number"==typeof t[0]&&t[0]>=0&&t[0]<=16777215))throw new Error("could not guess mode. args "+JSON.stringify(t));e="num"}const i=rt[e](...t);return new k(i[0],i[1],i[2],void 0!==i[3]?i[3]:1)}function at(t){let e;if(e=t.match(/^#?([A-F\d]{2})([A-F\d]{2})([A-F\d]{2})([A-F\d]{2})?$/i))return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?parseInt(e[4],16)/255:1];if(e=t.match(/^#?([A-F\d])([A-F\d])([A-F\d])([A-F\d])?$/i))return[17*parseInt(e[1],16),17*parseInt(e[2],16),17*parseInt(e[3],16),e[4]?17*parseInt(e[4],16)/255:1];throw new Error("invalid hex color: "+t)}function lt(t){return(t%360+360)%360}function ht(t){if(!("number"==typeof t&&t>=0&&t<=16777215))throw new Error("unknown num color: "+t);return[t>>16,t>>8&255,255&t,1]}st.xyz=st.rgb=st.lab=function(t,e,i,n){const s=t[n](),r=e[n]();return ot([f(s[0],r[0],i),f(s[1],r[1],i),f(s[2],r[2],i),f(t.alpha(),e.alpha(),i)],n)},st.num=function(t,e,i){return $(f(t.num(),e.num(),i))},st.lrgb=function(t,e,i){const[n,s,r,o]=t.rgba(!1,!1),[a,l,h,u]=e.rgba(!1,!1);return new k(p(n**2*(1-i)+a**2*i),p(s**2*(1-i)+l**2*i),p(r**2*(1-i)+h**2*i),f(o,u,i))},rt.lrgb=rt.rgb,rt.hex=at,rt.hsl=jt,rt.hsv=function(t,e,i,s=1){t=lt(t);const r=i*e;return zt(t,r,r*(1-n(t/60%2-1)),i-r,s)},rt.num=ht;const ut="\\s*",ct="([+-]?(?:\\d*\\.?)?\\d+(?:[eE][+-]?\\d+)?)",dt=new RegExp(["^rgba?\\(",ct,",",ct,",",ct,"(?:,",ct+"(%)?",")?\\)$"].join(ut),"i"),pt=new RegExp(["^rgba?\\(",ct,ct,ct,"(?:/",ct+"(%)?",")?\\)$"].join(ut),"i"),gt=new RegExp(["^rgba?\\(",ct+"%",",",ct+"%",",",ct+"%","(?:,",ct+"(%)?",")?\\)$"].join(ut),"i"),mt=new RegExp(["^rgba?\\(",ct+"%",ct+"%",ct+"%","(?:/",ct+"(%)?",")?\\)$"].join(ut),"i"),_t=new RegExp(["^hsla?\\(",ct+"(deg|rad|turn)?",",",ct+"%",",",ct+"%","(?:,",ct+"(%)?",")?\\)$"].join(ut),"i"),ft=new RegExp(["^hsla?\\(",ct+"(deg|rad|turn)?\\s+"+ct+"%",ct+"%","(?:/",ct+"(%)?",")?\\)$"].join(ut),"i");function vt(t){if(A&&A.hasOwnProperty(t))return ht(A[t.toLowerCase()]);let e;if(e=t.match(dt)||t.match(pt))return[v(+e[1],0,255),v(+e[2],0,255),v(+e[3],0,255),e[4]?v(e[5]?+e[4]/100:+e[4]):1];if(e=t.match(gt)||t.match(mt))return[255*v(+e[1]/100),255*v(+e[2]/100),255*v(+e[3]/100),e[4]?v(e[5]?+e[4]/100:+e[4]):1];if(e=t.match(_t)||t.match(ft)){const t={deg:1,rad:w,turn:360},i=e[2]?e[2].toLowerCase():"deg";return jt((+e[1]*t[i]%360+360)%360,v(+e[3]/100),v(+e[4]/100),e[5]?v(e[6]?+e[5]/100:+e[5]):1)}return at(t)}function yt(t){return u(100*t)/100}function bt(t){const e=t/255;return e<=.04045?e/12.92:((e+.055)/1.055)**2.4}function xt(t){return t<=.0031308?12.92*t*255:255*(1.055*t**(1/2.4)-.055)}function wt(t){const e=t/100;let i,n,s;return e<66?(i=255,n=-155.25485562709179-.44596950469579133*(e-2)+104.49216199393888*a(e-2),s=e<20?0:.8274096064007395*(e-10)-254.76935184120902+115.67994401066147*a(e-10)):(i=351.97690566805693+.114206453784165*(e-55)-40.25366309332127*a(e-55),n=325.4494125711974+.07943456536662342*(e-50)-28.0852963507957*a(e-50),s=255),[i,n,s]}function Et(t){return function(e,i){const[n,s,r]=t(E(i).rgb(),E(e).rgb());return V(n,s,r)}}function kt(t){return function(e,i){return e.map((e,n)=>t(e,i[n]))}}function St(t,e,i){const n=l(t,e,i),s=h(t,e,i),r=s-n;let o;return[60*(o=0==r?0:t==s?(e-i)/r+(e<i?6:0):e==s?2+(i-t)/r:4+(t-e)/r),n,s]}function zt(t,e,i,n,s){const r=255*n,o=255*e+r,a=255*i+r;return t<60?[o,a,r,s]:t<120?[a,o,r,s]:t<180?[r,o,a,s]:t<240?[r,a,o,s]:t<300?[a,r,o,s]:[o,r,a,s]}function jt(t,e,i,s=1){t=lt(t);const r=(1-n(2*i-1))*e;return zt(t,r,r*(1-n(t/60%2-1)),i-r/2,s)}function At(t,e,i,n=1){const[s,r,o]=function(t,e,i){function n(t){return t>Mt?t**3:Tt*(t-4/29)}return[Nt*n((t+16)/116+e/500),Ot*n((t+16)/116),Lt*n((t+16)/116-i/200)]}(t,e,i);return Pt(s,r,o,n)}rt.css=vt,rt.name=function(t){return ht(A[t])},rt.lch=function(t,e,i,n=1){const[,s,o]=function(t,e,i){return[t,r(i*x)*e,d(i*x)*e]}(t,e,i);return At(t,s,o,n)},rt.cmyk=function(t,e,i,n,s=1){return 1==n?[0,0,0,s]:[255*(1-t)*(1-n),255*(1-e)*(1-n),255*(1-i)*(1-n),s]},rt.gl=function(t,e,i,n=1){return[255*t,255*e,255*i,n]},rt.rgb=((...t)=>t),rt.temperature=rt.kelvin=rt.K=wt,rt.hcg=function(t,e,i,s=1){const r=i*(1-e);return zt(t=lt(t),e,e*(1-n(t/60%2-1)),r,s)};const Ct=18,Nt=.95047,Ot=1,Lt=1.08883,Mt=.206896552,Tt=.12841855,It=.008856452;function Rt(t,e,i){const[n,s,r]=Ft(t,e,i);return function(t,e,i){function n(t){return t>It?g(t):t/Tt+4/29}return[116*n(e/Ot)-16,500*(n(t/Nt)-n(e/Ot)),200*(n(e/Ot)-n(i/Lt))]}(n,s,r)}function Ft(t,e,i){const n=bt(t),s=bt(e),r=bt(i);return[.4124564*n+.3575761*s+.1804375*r,.2126729*n+.7151522*s+.072175*r,.0193339*n+.119192*s+.9503041*r]}function Pt(t,e,i,n=1){const s=-.969266*t+1.8760108*e+.041556*i,r=.0556434*t-.2040259*e+1.0572252*i;return[xt(3.2404542*t-1.5371385*e-.4985314*i),xt(s),xt(r),n]}function Bt(t,e){let i=-1/0,n=-1;for(let s=0;s<t.length;s++){const r=e(t[s]);r>i&&(i=r,n=s)}return n}rt.xyz=Pt,rt.lab=At,rt.hsi=function(t,e,i,n=1){let s,o,a,l=t*x;return l<2*m/3?o=1-((a=(1-e)/3)+(s=(1+e*r(l)/r(m/3-l))/3)):l<4*m/3?a=1-((s=(1-e)/3)+(o=(1+e*r(l-=2*m/3)/r(m/3-l))/3)):s=1-((o=(1-e)/3)+(a=(1+e*r(l-=4*m/3)/r(m/3-l))/3)),[3*i*s*255,3*i*o*255,3*i*a*255,n]},st.hsv=st.hsl=st.hsi=st.lch=st.hcg=function(t,e,i,n){const[s,r,o]=t[n](),[a,l,h]=e[n]();function u(t,e,i){return t+i*(lt(e-t+180)-180)}return E(("h"==n.charAt(0)?u:f)(s,a,i),f(r,l,i),("h"==n.charAt(2)?u:f)(o,h,i),n)}},"./node_modules/define-properties/index.js":function(t,e,i){"use strict";var n=i("./node_modules/object-keys/index.js"),s="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),r=Object.prototype.toString,o=Array.prototype.concat,a=Object.defineProperty,l=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),h=function(t,e,i,n){var s;e in t&&("function"!=typeof(s=n)||"[object Function]"!==r.call(s)||!n())||(l?a(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},u=function(t,e){var i=arguments.length>2?arguments[2]:{},r=n(e);s&&(r=o.call(r,Object.getOwnPropertySymbols(e)));for(var a=0;a<r.length;a+=1)h(t,r[a],e[r[a]],i[r[a]])};u.supportsDescriptors=!!l,t.exports=u},"./node_modules/es-abstract/2020/RequireObjectCoercible.js":function(t,e,i){"use strict";t.exports=i("./node_modules/es-abstract/5/CheckObjectCoercible.js")},"./node_modules/es-abstract/2020/ToString.js":function(t,e,i){"use strict";var n=i("./node_modules/get-intrinsic/index.js"),s=n("%String%"),r=n("%TypeError%");t.exports=function(t){if("symbol"==typeof t)throw new r("Cannot convert a Symbol value to a string");return s(t)}},"./node_modules/es-abstract/5/CheckObjectCoercible.js":function(t,e,i){"use strict";var n=i("./node_modules/get-intrinsic/index.js")("%TypeError%");t.exports=function(t,e){if(null==t)throw new n(e||"Cannot call method on "+t);return t}},"./node_modules/for-each/index.js":function(t,e,i){"use strict";var n=i("./node_modules/is-callable/index.js"),s=Object.prototype.toString,r=Object.prototype.hasOwnProperty;t.exports=function(t,e,i){if(!n(e))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=i),"[object Array]"===s.call(t)?function(t,e,i){for(var n=0,s=t.length;n<s;n++)r.call(t,n)&&(null==i?e(t[n],n,t):e.call(i,t[n],n,t))}(t,e,o):"string"==typeof t?function(t,e,i){for(var n=0,s=t.length;n<s;n++)null==i?e(t.charAt(n),n,t):e.call(i,t.charAt(n),n,t)}(t,e,o):function(t,e,i){for(var n in t)r.call(t,n)&&(null==i?e(t[n],n,t):e.call(i,t[n],n,t))}(t,e,o)}},"./node_modules/function-bind/implementation.js":function(t,e,i){"use strict";var n=Array.prototype.slice,s=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==s.call(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var i,r=n.call(arguments,1),o=Math.max(0,e.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof i){var s=e.apply(this,r.concat(n.call(arguments)));return Object(s)===s?s:this}return e.apply(t,r.concat(n.call(arguments)))}),e.prototype){var h=function(){};h.prototype=e.prototype,i.prototype=new h,h.prototype=null}return i}},"./node_modules/function-bind/index.js":function(t,e,i){"use strict";var n=i("./node_modules/function-bind/implementation.js");t.exports=Function.prototype.bind||n},"./node_modules/get-intrinsic/index.js":function(t,e,i){"use strict";var n=SyntaxError,s=Function,r=TypeError,o=function(t){try{return s('"use strict"; return ('+t+").constructor;")()}catch(t){}},a=Object.getOwnPropertyDescriptor;if(a)try{a({},"")}catch(t){a=null}var l=function(){throw new r},h=a?function(){try{return arguments.callee,l}catch(t){try{return a(arguments,"callee").get}catch(t){return l}}}():l,u=i("./node_modules/has-symbols/index.js")(),c=Object.getPrototypeOf||function(t){return t.__proto__},d={},p="undefined"==typeof Uint8Array?void 0:c(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":u?c([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?c(c([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&u?c((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&u?c((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u?c(""[Symbol.iterator]()):void 0,"%Symbol%":u?Symbol:void 0,"%SyntaxError%":n,"%ThrowTypeError%":h,"%TypedArray%":p,"%TypeError%":r,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},m={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},_=i("./node_modules/function-bind/index.js"),f=i("./node_modules/has/src/index.js"),v=_.call(Function.call,Array.prototype.concat),y=_.call(Function.apply,Array.prototype.splice),b=_.call(Function.call,String.prototype.replace),x=_.call(Function.call,String.prototype.slice),w=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,E=/\\(\\)?/g,k=function(t,e){var i,s=t;if(f(m,s)&&(s="%"+(i=m[s])[0]+"%"),f(g,s)){var a=g[s];if(a===d&&(a=function t(e){var i;if("%AsyncFunction%"===e)i=o("async function () {}");else if("%GeneratorFunction%"===e)i=o("function* () {}");else if("%AsyncGeneratorFunction%"===e)i=o("async function* () {}");else if("%AsyncGenerator%"===e){var n=t("%AsyncGeneratorFunction%");n&&(i=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var s=t("%AsyncGenerator%");s&&(i=c(s.prototype))}return g[e]=i,i}(s)),void 0===a&&!e)throw new r("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:s,value:a}}throw new n("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new r("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new r('"allowMissing" argument must be a boolean');var i=function(t){var e=x(t,0,1),i=x(t,-1);if("%"===e&&"%"!==i)throw new n("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==e)throw new n("invalid intrinsic syntax, expected opening `%`");var s=[];return b(t,w,function(t,e,i,n){s[s.length]=i?b(n,E,"$1"):e||t}),s}(t),s=i.length>0?i[0]:"",o=k("%"+s+"%",e),l=o.name,h=o.value,u=!1,c=o.alias;c&&(s=c[0],y(i,v([0,1],c)));for(var d=1,p=!0;d<i.length;d+=1){var m=i[d],_=x(m,0,1),S=x(m,-1);if(('"'===_||"'"===_||"`"===_||'"'===S||"'"===S||"`"===S)&&_!==S)throw new n("property names with quotes must have matching quotes");if("constructor"!==m&&p||(u=!0),f(g,l="%"+(s+="."+m)+"%"))h=g[l];else if(null!=h){if(!(m in h)){if(!e)throw new r("base intrinsic for "+t+" exists, but the property is not available.");return}if(a&&d+1>=i.length){var z=a(h,m);h=(p=!!z)&&"get"in z&&!("originalValue"in z.get)?z.get:h[m]}else p=f(h,m),h=h[m];p&&!u&&(g[l]=h)}}return h}},"./node_modules/has-symbols/index.js":function(t,e,i){"use strict";var n="undefined"!=typeof Symbol&&Symbol,s=i("./node_modules/has-symbols/shams.js");t.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&s())))}},"./node_modules/has-symbols/shams.js":function(t,e,i){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),i=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(t,e);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},"./node_modules/has/src/index.js":function(t,e,i){"use strict";var n=i("./node_modules/function-bind/index.js");t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},"./node_modules/is-callable/index.js":function(t,e,i){"use strict";var n,s,r=Function.prototype.toString,o="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof o&&"function"==typeof Object.defineProperty)try{n=Object.defineProperty({},"length",{get:function(){throw s}}),s={},o(function(){throw 42},null,n)}catch(t){t!==s&&(o=null)}else o=null;var a=/^\s*class\b/,l=function(t){try{var e=r.call(t);return a.test(e)}catch(t){return!1}},h=Object.prototype.toString,u="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,c="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};t.exports=o?function(t){if(t===c)return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if("function"==typeof t&&!t.prototype)return!0;try{o(t,null,n)}catch(t){if(t!==s)return!1}return!l(t)}:function(t){if(t===c)return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if("function"==typeof t&&!t.prototype)return!0;if(u)return function(t){try{return!l(t)&&(r.call(t),!0)}catch(t){return!1}}(t);if(l(t))return!1;var e=h.call(t);return"[object Function]"===e||"[object GeneratorFunction]"===e}},"./node_modules/ngraph.events/index.js":function(t,e){t.exports=function(t){!function(t){if(!t)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],i=0;i<e.length;++i)if(t.hasOwnProperty(e[i]))throw new Error("Subject cannot be eventified, since it already has property '"+e[i]+"'")}(t);var e=function(t){var e=Object.create(null);return{on:function(i,n,s){if("function"!=typeof n)throw new Error("callback is expected to be a function");var r=e[i];return r||(r=e[i]=[]),r.push({callback:n,ctx:s}),t},off:function(i,n){var s=void 0===i;if(s)return e=Object.create(null),t;if(e[i]){var r="function"!=typeof n;if(r)delete e[i];else for(var o=e[i],a=0;a<o.length;++a)o[a].callback===n&&o.splice(a,1)}return t},fire:function(i){var n,s=e[i];if(!s)return t;arguments.length>1&&(n=Array.prototype.splice.call(arguments,1));for(var r=0;r<s.length;++r){var o=s[r];o.callback.apply(o.ctx,n)}return t}}}(t);return t.on=e.on,t.off=e.off,t.fire=e.fire,t}},"./node_modules/ngraph.graph/index.js":function(t,e,i){t.exports=function(t){"uniqueLinkId"in(t=t||{})&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n","\n","Note: there is also change in default behavior: From now on each graph\nis considered to be not a multigraph by default (each edge is unique)."),t.multigraph=t.uniqueLinkId);void 0===t.multigraph&&(t.multigraph=!1);if("function"!=typeof Map)throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,i=[],h={},u=0,c=t.multigraph?function(t,e,i){var n=l(t,e),s=h.hasOwnProperty(n);if(s||j(t,e)){s||(h[n]=0);var r="@"+ ++h[n];n=l(t+r,e+r)}return new a(t,e,i,n)}:function(t,e,i){var n=l(t,e);return new a(t,e,i,n)},d=[],p=A,g=A,m=A,_=A,f={addNode:x,addLink:function(t,e,n){m();var s=w(t)||x(t),r=w(e)||x(e),a=c(t,e,n);i.push(a),o(s,a),t!==e&&o(r,a);return p(a,"add"),_(),a},removeLink:z,removeNode:E,getNode:w,getNodeCount:k,getLinkCount:S,getLinksCount:S,getNodesCount:k,getLinks:function(t){var e=w(t);return e?e.links:null},forEachNode:O,forEachLinkedNode:function(t,i,n){var s=w(t);if(s&&s.links&&"function"==typeof i)return n?function(t,i,n){for(var s=0;s<t.length;++s){var r=t[s];if(r.fromId===i&&n(e.get(r.toId),r))return!0}}(s.links,t,i):function(t,i,n){for(var s=0;s<t.length;++s){var r=t[s],o=r.fromId===i?r.toId:r.fromId;if(n(e.get(o),r))return!0}}(s.links,t,i)},forEachLink:function(t){var e,n;if("function"==typeof t)for(e=0,n=i.length;e<n;++e)t(i[e])},beginUpdate:m,endUpdate:_,clear:function(){m(),O(function(t){E(t.id)}),_()},hasLink:j,hasNode:w,getLink:j};return n(f),v=f.on,f.on=function(){return f.beginUpdate=m=C,f.endUpdate=_=N,p=y,g=b,f.on=v,v.apply(f,arguments)},f;var v;function y(t,e){d.push({link:t,changeType:e})}function b(t,e){d.push({node:t,changeType:e})}function x(t,i){if(void 0===t)throw new Error("Invalid node identifier");m();var n=w(t);return n?(n.data=i,g(n,"update")):(n=new r(t,i),g(n,"add")),e.set(t,n),_(),n}function w(t){return e.get(t)}function E(t){var i=w(t);if(!i)return!1;m();var n=i.links;if(n){i.links=null;for(var s=0;s<n.length;++s)z(n[s])}return e.delete(t),g(i,"remove"),_(),!0}function k(){return e.size}function S(){return i.length}function z(t){if(!t)return!1;var e=s(t,i);if(e<0)return!1;m(),i.splice(e,1);var n=w(t.fromId),r=w(t.toId);return n&&(e=s(t,n.links))>=0&&n.links.splice(e,1),r&&(e=s(t,r.links))>=0&&r.links.splice(e,1),p(t,"remove"),_(),!0}function j(t,e){var i,n=w(t);if(!n||!n.links)return null;for(i=0;i<n.links.length;++i){var s=n.links[i];if(s.fromId===t&&s.toId===e)return s}return null}function A(){}function C(){u+=1}function N(){0===(u-=1)&&d.length>0&&(f.fire("changed",d),d.length=0)}function O(t){if("function"!=typeof t)throw new Error("Function is expected to iterate over graph nodes. You passed "+t);for(var i=e.values(),n=i.next();!n.done;){if(t(n.value))return!0;n=i.next()}}};var n=i("./node_modules/ngraph.events/index.js");function s(t,e){if(!e)return-1;if(e.indexOf)return e.indexOf(t);var i,n=e.length;for(i=0;i<n;i+=1)if(e[i]===t)return i;return-1}function r(t,e){this.id=t,this.links=null,this.data=e}function o(t,e){t.links?t.links.push(e):t.links=[e]}function a(t,e,i,n){this.fromId=t,this.toId=e,this.data=i,this.id=n}function l(t,e){return t.toString()+"👉 "+e.toString()}},"./node_modules/node-polyglot/index.js":function(t,e,i){"use strict";var n=i("./node_modules/for-each/index.js"),s=i("./node_modules/node-polyglot/node_modules/warning/warning.js"),r=i("./node_modules/has/src/index.js"),o=i("./node_modules/string.prototype.trim/index.js"),a=function(t){s(!1,t)},l=String.prototype.replace,h=String.prototype.split,u="||||",c=function(t){var e=t%100,i=e%10;return 11!==e&&1===i?0:2<=i&&i<=4&&!(e>=12&&e<=14)?1:2},d={pluralTypes:{arabic:function(t){if(t<3)return t;var e=t%100;return e>=3&&e<=10?3:e>=11?4:5},bosnian_serbian:c,chinese:function(){return 0},croatian:c,french:function(t){return t>1?1:0},german:function(t){return 1!==t?1:0},russian:c,lithuanian:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){if(1===t)return 0;var e=t%10;return 2<=e&&e<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!=1||t%100==11?1:0},slovenian:function(t){var e=t%100;return 1===e?0:2===e?1:3===e||4===e?2:3}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]}};function p(t,e){var i,s,r=(i=t.pluralTypeToLanguages,s={},n(i,function(t,e){n(t,function(t){s[t]=e})}),s);return r[e]||r[h.call(e,/-/,1)[0]]||r.en}function g(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var m=/%\{(.*?)\}/g;function _(t,e,i,n,s){if("string"!=typeof t)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==e)return t;var a=t,c=n||m,g=s||d,_="number"==typeof e?{smart_count:e}:e;if(null!=_.smart_count&&a){var f=h.call(a,u);a=o(f[function(t,e,i){return t.pluralTypes[p(t,e)](i)}(g,i||"en",_.smart_count)]||f[0])}return a=l.call(a,c,function(t,e){return r(_,e)&&null!=_[e]?_[e]:t})}function f(t){var e=t||{};this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en";var i=e.allowMissing?_:null;this.onMissingKey="function"==typeof e.onMissingKey?e.onMissingKey:i,this.warn=e.warn||a,this.tokenRegex=function(t){var e=t&&t.prefix||"%{",i=t&&t.suffix||"}";if(e===u||i===u)throw new RangeError('"'+u+'" token is reserved for pluralization');return new RegExp(g(e)+"(.*?)"+g(i),"g")}(e.interpolation),this.pluralRules=e.pluralRules||d}f.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},f.prototype.extend=function(t,e){n(t,function(t,i){var n=e?e+"."+i:i;"object"==typeof t?this.extend(t,n):this.phrases[n]=t},this)},f.prototype.unset=function(t,e){"string"==typeof t?delete this.phrases[t]:n(t,function(t,i){var n=e?e+"."+i:i;"object"==typeof t?this.unset(t,n):delete this.phrases[n]},this)},f.prototype.clear=function(){this.phrases={}},f.prototype.replace=function(t){this.clear(),this.extend(t)},f.prototype.t=function(t,e){var i,n,s=null==e?{}:e;if("string"==typeof this.phrases[t])i=this.phrases[t];else if("string"==typeof s._)i=s._;else if(this.onMissingKey){n=(0,this.onMissingKey)(t,s,this.currentLocale,this.tokenRegex,this.pluralRules)}else this.warn('Missing translation for key: "'+t+'"'),n=t;return"string"==typeof i&&(n=_(i,s,this.currentLocale,this.tokenRegex,this.pluralRules)),n},f.prototype.has=function(t){return r(this.phrases,t)},f.transformPhrase=function(t,e,i){return _(t,e,i)},t.exports=f},"./node_modules/node-polyglot/node_modules/warning/warning.js":function(t,e,i){"use strict";var n=function(){};n=function(t,e,i){var n=arguments.length;i=new Array(n>2?n-2:0);for(var s=2;s<n;s++)i[s-2]=arguments[s];if(void 0===e)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");t||function(t,e){var i=arguments.length;e=new Array(i>1?i-1:0);for(var n=1;n<i;n++)e[n-1]=arguments[n];var s=0,r="Warning: "+t.replace(/%s/g,function(){return e[s++]});"undefined"!=typeof console&&console.error(r);try{throw new Error(r)}catch(t){}}.apply(null,[e].concat(i))},t.exports=n},"./node_modules/object-keys/implementation.js":function(t,e,i){"use strict";var n;if(!Object.keys){var s=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=i("./node_modules/object-keys/isArguments.js"),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),h=a.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&s.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{c(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();n=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===r.call(t),n=o(t),a=e&&"[object String]"===r.call(t),d=[];if(!e&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var g=h&&i;if(a&&t.length>0&&!s.call(t,0))for(var m=0;m<t.length;++m)d.push(String(m));if(n&&t.length>0)for(var _=0;_<t.length;++_)d.push(String(_));else for(var f in t)g&&"prototype"===f||!s.call(t,f)||d.push(String(f));if(l)for(var v=function(t){if("undefined"==typeof window||!p)return c(t);try{return c(t)}catch(t){return!1}}(t),y=0;y<u.length;++y)v&&"constructor"===u[y]||!s.call(t,u[y])||d.push(u[y]);return d}}t.exports=n},"./node_modules/object-keys/index.js":function(t,e,i){"use strict";var n=Array.prototype.slice,s=i("./node_modules/object-keys/isArguments.js"),r=Object.keys,o=r?function(t){return r(t)}:i("./node_modules/object-keys/implementation.js"),a=Object.keys;o.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return s(t)?a(n.call(t)):a(t)}):Object.keys=o;return Object.keys||o},t.exports=o},"./node_modules/object-keys/isArguments.js":function(t,e,i){"use strict";var n=Object.prototype.toString;t.exports=function(t){var e=n.call(t),i="[object Arguments]"===e;return i||(i="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),i}},"./node_modules/quadtree-lib/build/js/quadtree.min.js":function(t,e,i){var n,s,r;s=[],void 0===(r="function"==typeof(n=function(){return function(){function t(e){var i,n;if(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.maxElements=e.maxElements,null==this.width||null==this.height)throw new Error("Missing quadtree dimensions.");if(null==this.x&&(this.x=0),null==this.y&&(this.y=0),null==this.maxElements&&(this.maxElements=1),this.contents=[],this.oversized=[],this.size=0,this.width<1||this.height<1)throw new Error("Dimensions must be positive integers.");if(!Number.isInteger(this.x)||!Number.isInteger(this.y))throw new Error("Coordinates must be integers");if(this.maxElements<1)throw new Error("The maximum number of elements before a split must be a positive integer.");for(i in n=this,this.children={NW:{create:function(){return new t({x:n.x,y:n.y,width:Math.max(Math.floor(n.width/2),1),height:Math.max(Math.floor(n.height/2),1),maxElements:n.maxElements})},tree:null},NE:{create:function(){return new t({x:n.x+Math.max(Math.floor(n.width/2),1),y:n.y,width:Math.ceil(n.width/2),height:Math.max(Math.floor(n.height/2),1),maxElements:n.maxElements})},tree:null},SW:{create:function(){return new t({x:n.x,y:n.y+Math.max(Math.floor(n.height/2),1),width:Math.max(Math.floor(n.width/2),1),height:Math.ceil(n.height/2),maxElements:n.maxElements})},tree:null},SE:{create:function(){return new t({x:n.x+Math.max(Math.floor(n.width/2),1),y:n.y+Math.max(Math.floor(n.height/2),1),width:Math.ceil(n.width/2),height:Math.ceil(n.height/2),maxElements:n.maxElements})},tree:null}},this.children)this.children[i].get=function(){return null!=this.tree?this.tree:(this.tree=this.create(),this.tree)}}var e,i,n,s,r,o,a,l;return s=function(t){var e,i;return{x:Math.floor((null!=(e=t.width)?e:1)/2)+t.x,y:Math.floor((null!=(i=t.height)?i:1)/2)+t.y}},e=function(t,e){var i,n,s,r;return!(t.x>=e.x+(null!=(i=e.width)?i:1)||t.x+(null!=(n=t.width)?n:1)<=e.x||t.y>=e.y+(null!=(s=e.height)?s:1)||t.y+(null!=(r=t.height)?r:1)<=e.y)},i=function(t,e){var i;return i=s(e),t.x<i.x?t.y<i.y?"NW":"SW":t.y<i.y?"NE":"SE"},l=function(t){if("object"!=typeof t)throw new Error("Element must be an Object.");if(null==t.x||null==t.y)throw new Error("Coordinates properties are missing.");if((null!=t?t.width:void 0)<0||(null!=t?t.height:void 0)<0)throw new Error("Width and height must be positive integers.")},o=function(t){var e,i,n,s;return i=Math.max(Math.floor(t.width/2),1),n=Math.ceil(t.width/2),s=Math.max(Math.floor(t.height/2),1),e=Math.ceil(t.height/2),{NW:{x:t.x,y:t.y,width:i,height:s},NE:{x:t.x+i,y:t.y,width:n,height:s},SW:{x:t.x,y:t.y+s,width:i,height:e},SE:{x:t.x+i,y:t.y+s,width:n,height:e}}},n=function(t,i){var n,s,r,a;for(s in a=[],r=o(i))n=r[s],e(t,n)&&a.push(s);return a},r=function(t,e){var i;return(i=function(i){return t["_"+i]=t[i],Object.defineProperty(t,i,{set:function(t){return e.remove(this,!0),this["_"+i]=t,e.push(this)},get:function(){return this["_"+i]},configurable:!0})})("x"),i("y"),i("width"),i("height")},a=function(t){var e;return(e=function(e){if(null!=t["_"+e])return delete t[e],t[e]=t["_"+e],delete t["_"+e]})("x"),e("y"),e("width"),e("height")},t.prototype.clear=function(){var t,e;for(t in this.contents=[],this.oversized=[],this.size=0,e=[],this.children)e.push(this.children[t].tree=null);return e},t.prototype.push=function(t,e){return this.pushAll([t],e)},t.prototype.pushAll=function(t,e){var i,s,o,a,h,u,c,d,p,g,m,_,f,v,y,b,x,w,E,k;for(m=0,v=t.length;m<v;m++)g=t[m],l(g),e&&r(g,this);for(c=[{tree:this,elements:t}];c.length>0;){for(k=(x=c.shift()).tree,d={NW:null,NE:null,SW:null,SE:null},_=0,y=(u=x.elements).length;_<y;_++)if(h=u[_],k.size++,1!==(p=n(h,k)).length||1===k.width||1===k.height)k.oversized.push(h);else if(k.size-k.oversized.length<=k.maxElements)k.contents.push(h);else{for(a=p[0],E=k.children[a],null==d[a]&&(d[a]={tree:E.get(),elements:[]}),d[a].elements.push(h),f=0,b=(w=k.contents).length;f<b;f++)s=w[f],null==d[o=n(s,k)[0]]&&(d[o]={tree:k.children[o].get(),elements:[]}),d[o].elements.push(s);k.contents=[]}for(a in d)null!=(i=d[a])&&c.push(i)}return this},t.prototype.remove=function(t,e){var n,s;return l(t),(n=this.oversized.indexOf(t))>-1?(this.oversized.splice(n,1),this.size--,e||a(t),!0):(n=this.contents.indexOf(t))>-1?(this.contents.splice(n,1),this.size--,e||a(t),!0):!(null==(s=this.children[i(t,this)]).tree||!s.tree.remove(t,e)||(this.size--,0===s.tree.size&&(s.tree=null),0))},t.prototype.colliding=function(t,i){var s,r,o,a,h,u,c,d,p,g,m,_,f,v;for(null==i&&(i=e),l(t),h=[],o=[this];o.length>0;){for(u=0,p=(_=(v=o.shift()).oversized).length;u<p;u++)(r=_[u])!==t&&i(t,r)&&h.push(r);for(c=0,g=(f=v.contents).length;c<g;c++)(r=f[c])!==t&&i(t,r)&&h.push(r);for(0===(a=n(t,v)).length&&(a=[],t.x>=v.x+v.width&&a.push("NE"),t.y>=v.y+v.height&&a.push("SW"),a.length>0&&(1===a.length?a.push("SE"):a=["SE"])),d=0,m=a.length;d<m;d++)s=a[d],null!=v.children[s].tree&&o.push(v.children[s].tree)}return h},t.prototype.onCollision=function(t,i,s){var r,o,a,h,u,c,d,p,g,m,_,f,v;for(null==s&&(s=e),l(t),a=[this];a.length>0;){for(u=0,p=(_=(v=a.shift()).oversized).length;u<p;u++)(o=_[u])!==t&&s(t,o)&&i(o);for(c=0,g=(f=v.contents).length;c<g;c++)(o=f[c])!==t&&s(t,o)&&i(o);for(0===(h=n(t,v)).length&&(h=[],t.x>=v.x+v.width&&h.push("NE"),t.y>=v.y+v.height&&h.push("SW"),h.length>0&&(1===h.length?h.push("SE"):h=["SE"])),d=0,m=h.length;d<m;d++)r=h[d],null!=v.children[r].tree&&a.push(v.children[r].tree)}return null},t.prototype.get=function(t){return this.where(t)},t.prototype.where=function(t){var e,n,s,r,o,a,h,u,c,d,p,g,m;if("object"==typeof t&&(null==t.x||null==t.y))return this.find(function(e){var i,n;for(n in i=!0,t)t[n]!==e[n]&&(i=!1);return i});for(l(t),r=[],s=[this];s.length>0;){for(o=0,u=(d=(m=s.shift()).oversized).length;o<u;o++){for(h in n=d[o],e=!0,t)t[h]!==n[h]&&(e=!1);e&&r.push(n)}for(a=0,c=(p=m.contents).length;a<c;a++){for(h in n=p[a],e=!0,t)t[h]!==n[h]&&(e=!1);e&&r.push(n)}null!=(g=m.children[i(t,m)]).tree&&s.push(g.tree)}return r},t.prototype.each=function(t){var e,i,n,s,r,o,a,l,h,u;for(i=[this];i.length>0;){for(s=0,o=(l=(u=i.shift()).oversized).length;s<o;s++)n=l[s],"function"==typeof t&&t(n);for(r=0,a=(h=u.contents).length;r<a;r++)n=h[r],"function"==typeof t&&t(n);for(e in u.children)null!=u.children[e].tree&&i.push(u.children[e].tree)}return this},t.prototype.find=function(t){var e,i,n,s,r,o,a,l,h,u,c;for(i=[this],s=[];i.length>0;){for(r=0,a=(h=(c=i.shift()).oversized).length;r<a;r++)n=h[r],("function"==typeof t?t(n):void 0)&&s.push(n);for(o=0,l=(u=c.contents).length;o<l;o++)n=u[o],("function"==typeof t?t(n):void 0)&&s.push(n);for(e in c.children)null!=c.children[e].tree&&i.push(c.children[e].tree)}return s},t.prototype.filter=function(e){var i;return(i=function(n){var s,r,o,a,l,h,u,c,d,p,g;for(s in(r=new t({x:n.x,y:n.y,width:n.width,height:n.height,maxElements:n.maxElements})).size=0,n.children)null!=n.children[s].tree&&(r.children[s].tree=i(n.children[s].tree),r.size+=null!=(c=null!=(d=r.children[s].tree)?d.size:void 0)?c:0);for(a=0,h=(p=n.oversized).length;a<h;a++)o=p[a],(null==e||("function"==typeof e?e(o):void 0))&&r.oversized.push(o);for(l=0,u=(g=n.contents).length;l<u;l++)o=g[l],(null==e||("function"==typeof e?e(o):void 0))&&r.contents.push(o);return r.size+=r.oversized.length+r.contents.length,0===r.size?null:r})(this)},t.prototype.reject=function(t){return this.filter(function(e){return!("function"==typeof t?t(e):void 0)})},t.prototype.visit=function(t){var e,i,n;for(i=[this];i.length>0;)for(e in n=i.shift(),t.bind(n)(),n.children)null!=n.children[e].tree&&i.push(n.children[e].tree);return this},t.prototype.pretty=function(){var t,e,i,n,s,r,o;for(r="",i=function(t){var e,i,n;for(n="",e=i=t;i<=0?e<0:e>0;i<=0?++e:--e)n+="   ";return n},e=[{label:"ROOT",tree:this,level:0}];e.length>0;){for(t in r+=(n=i((o=e.shift()).level))+"| "+o.label+"\n"+n+"| ------------\n",o.tree.oversized.length>0&&(r+=n+"| * Oversized elements *\n"+n+"|   "+o.tree.oversized+"\n"),o.tree.contents.length>0&&(r+=n+"| * Leaf content *\n"+n+"|   "+o.tree.contents+"\n"),s=!1,o.tree.children)null!=o.tree.children[t].tree&&(s=!0,e.unshift({label:t,tree:o.tree.children[t].tree,level:o.level+1}));s&&(r+=n+"└──┐\n")}return r},t}()})?n.apply(e,s):n)||(t.exports=r)},"./node_modules/split.js/split.js":function(t,e,i){t.exports=function(){"use strict";var t=window,e=t.document,i="addEventListener",n="removeEventListener",s="getBoundingClientRect",r=function(){return!1},o=t.attachEvent&&!t[i],a=["","-webkit-","-moz-","-o-"].filter(function(t){var i=e.createElement("div");return i.style.cssText="width:"+t+"calc(9px)",!!i.style.length}).shift()+"calc",l=function(t){return"string"==typeof t||t instanceof String?e.querySelector(t):t};return function(h,u){var c,d,p,g;void 0===u&&(u={});var m=l(h[0]).parentNode,_=t.getComputedStyle(m).flexDirection,f=u.sizes||h.map(function(){return 100/h.length}),v=void 0!==u.minSize?u.minSize:100,y=Array.isArray(v)?v:h.map(function(){return v}),b=void 0!==u.gutterSize?u.gutterSize:10,x=void 0!==u.snapOffset?u.snapOffset:30,w=u.direction||"horizontal",E=u.cursor||("horizontal"===w?"ew-resize":"ns-resize"),k=u.gutter||function(t,i){var n=e.createElement("div");return n.className="gutter gutter-"+i,n},S=u.elementStyle||function(t,e,i){var n={};return"string"==typeof e||e instanceof String?n[t]=e:n[t]=o?e+"%":a+"("+e+"% - "+i+"px)",n},z=u.gutterStyle||function(t,e){return(i={})[t]=e+"px",i;var i};function j(t,e,i){var n=S(c,e,i);Object.keys(n).forEach(function(e){return t.style[e]=n[e]})}function A(t){var e=g[this.a],i=g[this.b],n=e.size+i.size;e.size=t/this.size*n,i.size=n-t/this.size*n,j(e.element,e.size,this.aGutterSize),j(i.element,i.size,this.bGutterSize)}function C(){var t=g[this.a].element,e=g[this.b].element;this.size=t[s]()[c]+e[s]()[c]+this.aGutterSize+this.bGutterSize,this.start=t[s]()[p]}function N(e){var s=g[this.a].element,o=g[this.b].element;!this.dragging&&u.onDragStart&&u.onDragStart(),e.preventDefault(),this.dragging=!0,this.move=function(t){var e;this.dragging&&((e="touches"in t?t.touches[0][d]-this.start:t[d]-this.start)<=g[this.a].minSize+x+this.aGutterSize?e=g[this.a].minSize+this.aGutterSize:e>=this.size-(g[this.b].minSize+x+this.bGutterSize)&&(e=this.size-(g[this.b].minSize+this.bGutterSize)),A.call(this,e),u.onDrag&&u.onDrag())}.bind(this),this.stop=function(){var e=g[this.a].element,i=g[this.b].element;this.dragging&&u.onDragEnd&&u.onDragEnd(),this.dragging=!1,t[n]("mouseup",this.stop),t[n]("touchend",this.stop),t[n]("touchcancel",this.stop),this.parent[n]("mousemove",this.move),this.parent[n]("touchmove",this.move),delete this.stop,delete this.move,e[n]("selectstart",r),e[n]("dragstart",r),i[n]("selectstart",r),i[n]("dragstart",r),e.style.userSelect="",e.style.webkitUserSelect="",e.style.MozUserSelect="",e.style.pointerEvents="",i.style.userSelect="",i.style.webkitUserSelect="",i.style.MozUserSelect="",i.style.pointerEvents="",this.gutter.style.cursor="",this.parent.style.cursor=""}.bind(this),t[i]("mouseup",this.stop),t[i]("touchend",this.stop),t[i]("touchcancel",this.stop),this.parent[i]("mousemove",this.move),this.parent[i]("touchmove",this.move),s[i]("selectstart",r),s[i]("dragstart",r),o[i]("selectstart",r),o[i]("dragstart",r),s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",this.gutter.style.cursor=E,this.parent.style.cursor=E,C.call(this)}"horizontal"===w?(c="width",d="clientX",p="left"):"vertical"===w&&(c="height",d="clientY",p="top");var O=[];function L(t){t.forEach(function(e,i){if(i>0){var n=O[i-1],s=g[n.a],r=g[n.b];s.size=t[i-1],r.size=e,j(s.element,s.size,n.aGutterSize),j(r.element,r.size,n.bGutterSize)}})}function M(){O.forEach(function(t){t.parent.removeChild(t.gutter),g[t.a].element.style[c]="",g[t.b].element.style[c]=""})}return g=h.map(function(t,e){var n,r={element:l(t),size:f[e],minSize:y[e]};if(e>0&&((n={a:e-1,b:e,dragging:!1,isFirst:1===e,isLast:e===h.length-1,direction:w,parent:m}).aGutterSize=b,n.bGutterSize=b,n.isFirst&&(n.aGutterSize=b/2),n.isLast&&(n.bGutterSize=b/2),"row-reverse"===_||"column-reverse"===_)){var a=n.a;n.a=n.b,n.b=a}if(!o&&e>0){var u=k(e,w);!function(t,e){var i=z(c,e);Object.keys(i).forEach(function(e){return t.style[e]=i[e]})}(u,b),u[i]("mousedown",N.bind(n)),u[i]("touchstart",N.bind(n)),m.insertBefore(u,r.element),n.gutter=u}0===e||e===h.length-1?j(r.element,r.size,b/2):j(r.element,r.size,b);var d=r.element[s]()[c];return d<r.minSize&&(r.minSize=d),e>0&&O.push(n),r}),o?{setSizes:L,destroy:M}:{setSizes:L,getSizes:function(){return g.map(function(t){return t.size})},collapse:function(t){if(t===O.length){var e=O[t-1];C.call(e),o||A.call(e,e.size-e.bGutterSize)}else{var i=O[t];C.call(i),o||A.call(i,i.aGutterSize)}},destroy:M}}}()},"./node_modules/string.prototype.trim/implementation.js":function(t,e,i){"use strict";var n=i("./node_modules/es-abstract/2020/RequireObjectCoercible.js"),s=i("./node_modules/es-abstract/2020/ToString.js"),r=i("./node_modules/call-bind/callBound.js")("String.prototype.replace"),o=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;t.exports=function(){var t=s(n(this));return r(r(t,o,""),a,"")}},"./node_modules/string.prototype.trim/index.js":function(t,e,i){"use strict";var n=i("./node_modules/call-bind/index.js"),s=i("./node_modules/define-properties/index.js"),r=i("./node_modules/string.prototype.trim/implementation.js"),o=i("./node_modules/string.prototype.trim/polyfill.js"),a=i("./node_modules/string.prototype.trim/shim.js"),l=n(o());s(l,{getPolyfill:o,implementation:r,shim:a}),t.exports=l},"./node_modules/string.prototype.trim/polyfill.js":function(t,e,i){"use strict";var n=i("./node_modules/string.prototype.trim/implementation.js");t.exports=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:n}},"./node_modules/string.prototype.trim/shim.js":function(t,e,i){"use strict";var n=i("./node_modules/define-properties/index.js"),s=i("./node_modules/string.prototype.trim/polyfill.js");t.exports=function(){var t=s();return n(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t}},"./src/@types/Color.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"createColorsForGraphView",function(){return r}),i.d(e,"getEmphasizedColor",function(){return o});var n=i("./node_modules/chroma.ts/dist/index.es.js");function s(t){const e=360*Math.random();let i=Math.random(),s=Math.random();return i=.4*i+.2,s=.25*s+.65,n.color(e,i,s,"hsl").alpha(t)}function r(t,e){const i=[],n=s(e);if(i.push(n.hex("rgba")),t>1){const r=360/t;let o=n.hsl()[0]+r;for(let n=1;n<t;n++){const t=s(e).set("hsl.h",o);i.push(t.hex("rgba")),(o+=r)>360&&(o-=360)}}return i}function o(t){return t.set("hsl.l",.5).saturate(1)}},"./src/@types/GUI.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"id_prefix",function(){return n});const n="scivi_fsgraph"},"./src/@types/Graph.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"GraphControlling",function(){return n});var n,s=i("./modified_modules/NonRandomLouvain/index.js"),r=i.n(s),o=i("./node_modules/ngraph.graph/index.js"),a=i.n(o),l=i("./src/index.ts");!function(t){t.EmptyMeta={groups_count:0,nodes_count:0,links_count:0};class e{constructor(e){this.label=e||"",this.mutable_graph=a()(),this.source_graph=a()(),this.manually_hidden_node_ids=[],this.meta=Object.assign({},t.EmptyMeta)}isManuallyHiddenNode(t){return-1!=this.manually_hidden_node_ids.indexOf(t)}hideNode(t,e=!1){this.mutable_graph.removeNode(t)&&e&&this.manually_hidden_node_ids.push(t)}showNode(t,e=!1){const i=this.source_graph.getNode(t),n=this.source_graph.getLinks(t);if(i&&!this.mutable_graph.hasNode(t)&&(this.mutable_graph.beginUpdate(),this.mutable_graph.addNode(t,Object.assign({},i.data)),n&&n.forEach(t=>{const e=this.mutable_graph.getNode(t.fromId),i=this.mutable_graph.getNode(t.toId);if(e&&i&&null==this.mutable_graph.hasLink(e.id,i.id)){const e=Object.assign({},t.data);this.mutable_graph.addLink(t.fromId,t.toId,e)}}),this.mutable_graph.endUpdate(),e)){const e=this.manually_hidden_node_ids.indexOf(t),i=this.manually_hidden_node_ids.length;let n=this.manually_hidden_node_ids[e];this.manually_hidden_node_ids[e]=this.manually_hidden_node_ids[i-1],this.manually_hidden_node_ids[i-1]=n,this.manually_hidden_node_ids.pop()}}hideLink(t,e){const i=this.mutable_graph.getLink(t,e);i&&this.mutable_graph.removeLink(i)}showLink(t,e){const i=this.source_graph.getLink(t,e),n=this.mutable_graph.getNode(t),s=this.mutable_graph.getNode(e);if(i&&n&&s&&null==this.mutable_graph.hasLink(t,e)){const n=Object.assign({},i.data);this.mutable_graph.addLink(t,e,n)}}updateMeta(){let t=!1,e=!1;const i=[];if(this.source_graph.forEachNode(t=>{e=e||t.data.weight}),this.source_graph.forEachLink(e=>{t=t||e.data.weight}),this.mutable_graph.forEachNode(t=>{const e=t.data.group;i.includes(e)||i.push(e)}),this.meta.groups_count=i.length,this.meta.links_count=this.mutable_graph.getLinksCount(),this.meta.nodes_count=this.mutable_graph.getNodesCount(),e){const t={min:1/0,max:-1/0,avg:0};this.source_graph.forEachNode(e=>(t.max=Math.max(t.max,e.data.weight),t.min=Math.min(t.min,e.data.weight),t.avg+=e.data.weight,!1)),t.avg/=this.source_graph.getNodesCount(),this.meta.node_weight_range=t,this.source_graph.forEachNode(t=>{const e=t.data.weight,i=this.meta.node_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)}),this.mutable_graph.forEachNode(t=>{const e=t.data.weight,i=this.meta.node_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)})}if(t){const t={min:1/0,max:-1/0,avg:0};this.source_graph.forEachLink(e=>(t.max=Math.max(t.max,e.data.weight),t.min=Math.min(t.min,e.data.weight),t.avg+=e.data.weight,!1)),t.avg/=this.source_graph.getLinksCount(),this.meta.link_weight_range=t,this.source_graph.forEachLink(t=>{const e=t.data.weight,i=this.meta.link_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)}),this.mutable_graph.forEachLink(t=>{const e=t.data.weight,i=this.meta.link_weight_range;e&&(i.min!=i.max?t.data.norm_weight=(e-i.min)/(i.max-i.min):t.data.norm_weight=1)})}}clusterize(){const t=r()(this.mutable_graph),e=[];this.mutable_graph.forEachNode(function(i){const n=t.getClass(i.id);let s=e.indexOf(n);-1==s&&(e.push(n),s=e.length-1),i.data.group=s}),console.log(e),this.meta.groups_count=e.length}copy(){const t=new e(this.label);return this.source_graph.forEachNode(e=>{const i=Object.assign({},e.data);t.source_graph.addNode(e.id,i)}),this.source_graph.forEachLink(e=>{const i=Object.assign({},e.data);t.source_graph.addLink(e.fromId,e.toId,i)}),this.mutable_graph.forEachNode(e=>{const i=Object.assign({},e.data);t.mutable_graph.addNode(e.id,i)}),this.mutable_graph.forEachLink(e=>{const i=Object.assign({},e.data);t.mutable_graph.addLink(e.fromId,e.toId,i)}),t.meta=Object.assign(this.meta),t}}t.GraphState=e,t.getFirstState=function(t){return t.states[Object.keys(t.states)[0]]},t.updateGraphMeta=function(t){t.meta.node_weight_range=void 0,t.meta.link_weight_range=void 0,Object.values(t.states).forEach(e=>{t.meta.groups_count=Math.max(e.meta.groups_count,t.meta.groups_count),t.meta.links_count=Math.max(e.meta.links_count,t.meta.links_count),t.meta.nodes_count=Math.max(e.meta.nodes_count,t.meta.nodes_count),e.meta.link_weight_range&&(t.meta.link_weight_range||(t.meta.link_weight_range={min:1/0,max:-1/0,avg:0}),t.meta.link_weight_range.min=Math.min(t.meta.link_weight_range.min,e.meta.link_weight_range.min),t.meta.link_weight_range.max=Math.max(t.meta.link_weight_range.max,e.meta.link_weight_range.max),t.meta.link_weight_range.avg+=e.meta.link_weight_range.avg),e.meta.node_weight_range&&(t.meta.node_weight_range||(t.meta.node_weight_range={min:1/0,max:-1/0,avg:0}),t.meta.node_weight_range.min=Math.min(t.meta.node_weight_range.min,e.meta.node_weight_range.min),t.meta.node_weight_range.max=Math.max(t.meta.node_weight_range.max,e.meta.node_weight_range.max),t.meta.node_weight_range.avg+=e.meta.node_weight_range.avg)});const e=Object.keys(t.states).length;t.meta.link_weight_range&&(t.meta.link_weight_range.avg/=e),t.meta.node_weight_range&&(t.meta.node_weight_range.avg/=e)},t.calculateState=function(t,e){e.length%2==0&&console.log("incorrect expression for calculation: extra symbols");let i=0;function n(t,e){let i=null;return t.mutable_graph.forEachNode(t=>{t.data.label==e&&(i=t)}),i}function s(t,e,i){let n=null;return t.mutable_graph.forEachLink(s=>{if(!n){const r=t.mutable_graph.getNode(s.fromId),o=t.mutable_graph.getNode(s.toId);r.data.label==e&&o.data.label==i&&(n=s)}}),n}function r(t,e){t.mutable_graph.beginUpdate(),e.mutable_graph.forEachNode(e=>{const s=n(t,e.data.label);if(s)s.data.weight=Math.max(s.data.weight,e.data.weight);else{const n=Object.assign({},e.data);t.mutable_graph.addNode(++i,n)}}),e.mutable_graph.forEachLink(i=>{let r=e.mutable_graph.getNode(i.fromId),o=e.mutable_graph.getNode(i.toId);const a=s(t,r.data.label,o.data.label);if(a)a.data.weight=Math.max(a.data.weight,i.data.weight);else if(r=n(t,r.data.label),o=n(t,o.data.label),r&&o){const e=Object.assign({},i.data);t.mutable_graph.addLink(r.id,o.id,e)}}),t.mutable_graph.endUpdate()}function o(t,e){const i=[],r=[];t.mutable_graph.forEachLink(i=>{const n=t.mutable_graph.getNode(i.fromId),o=t.mutable_graph.getNode(i.toId);s(e,n.data.label,o.data.label)||r.push(i)}),t.mutable_graph.forEachNode(t=>{n(e,t.data.label)||i.push(t.id)}),t.mutable_graph.beginUpdate(),r.forEach(e=>t.mutable_graph.removeLink(e)),i.forEach(e=>t.mutable_graph.removeNode(e)),t.mutable_graph.endUpdate()}function a(t,e){const i=[],r=[];t.mutable_graph.forEachLink(i=>{const n=t.mutable_graph.getNode(i.fromId),o=t.mutable_graph.getNode(i.toId);s(e,n.data.label,o.data.label)&&r.push(i)}),t.mutable_graph.forEachNode(t=>{n(e,t.data.label)&&i.push(t.id)}),t.mutable_graph.beginUpdate(),r.forEach(e=>t.mutable_graph.removeLink(e)),i.forEach(e=>t.mutable_graph.removeNode(e)),t.mutable_graph.endUpdate()}function h(t,e){const r=[],o=[];t.mutable_graph.forEachLink(i=>{const n=t.mutable_graph.getNode(i.fromId),r=t.mutable_graph.getNode(i.toId);s(e,n.data.label,r.data.label)&&o.push(i)}),t.mutable_graph.forEachNode(t=>{n(e,t.data.label)&&r.push(t.id)}),e.mutable_graph.forEachNode(e=>{n(t,e.data.label)||t.mutable_graph.addNode(++i,e.data)}),e.mutable_graph.forEachLink(i=>{let r=e.mutable_graph.getNode(i.fromId),o=e.mutable_graph.getNode(i.toId);s(t,r.data.label,o.data.label)||(r=n(t,r.data.label),o=n(t,o.data.label),r&&o&&t.mutable_graph.addLink(r.id,o.id,i.data))}),t.mutable_graph.beginUpdate(),o.forEach(e=>t.mutable_graph.removeLink(e)),r.forEach(e=>t.mutable_graph.removeNode(e)),t.mutable_graph.endUpdate()}const u=t.states[parseInt(e[0])].copy();u.label="calculated",u.mutable_graph.forEachNode(t=>{"number"==typeof t.id&&t.id>i&&(i=t.id)});for(let i=1;i<e.length;i+=2){const n=parseInt(e[i+1]);switch(e[i]){case l.StateCalculatorOperand.UNION:r(u,t.states[n]);break;case l.StateCalculatorOperand.INTERSECT:o(u,t.states[n]);break;case l.StateCalculatorOperand.DIFF:a(u,t.states[n]);break;case l.StateCalculatorOperand.SYMDIFF:h(u,t.states[n]);break;default:console.log("incorrect expression: invalid operation")}}return u.source_graph.clear(),u.mutable_graph.forEachNode(t=>{const e=Object.assign({},t.data);u.source_graph.addNode(t.id,e)}),u.mutable_graph.forEachLink(t=>{const e=Object.assign({},t.data);u.source_graph.addLink(t.fromId,t.toId,e)}),u.updateMeta(),u}}(n||(n={}))},"./src/@types/GraphView.ts":function(t,e,i){"use strict";var n;i.r(e),i.d(e,"GraphView",function(){return n}),function(t){t.isNodeViewEmphasized=function(t){return!t.is_hidden&&(t.is_hovered||t.is_selected||t.is_toggled||t.selected_adjacent_vertex_count>0)},t.isLinkViewEmphasized=function(t){const e=t.from,i=t.to;if(e.is_hidden||i.is_hidden)return!1;{const t=e.is_hovered||e.is_selected||e.is_toggled,n=i.is_hovered||i.is_selected||i.is_toggled;return t&&n||t&&i.selected_adjacent_vertex_count>0||n&&e.selected_adjacent_vertex_count>0}},t.isLinkViewDisabled=function(t){return t.is_hidden||t.to.is_hidden||t.from.is_hidden},t.onNodesReplaced=function(){this.quad_tree.clear(),Object.values(this.aabbs).forEach(t=>{const e=t.scene_object;t.x=e.position.x-e.size,t.y=e.position.y-e.size,e.is_hidden||this.quad_tree.push(t)})}}(n||(n={}))},"./src/@types/Param.ts":function(t,e,i){"use strict";var n;i.r(e),i.d(e,"ParamType",function(){return n}),i.d(e,"Param",function(){return s}),i.d(e,"ScalarParam",function(){return r}),i.d(e,"BooleanParam",function(){return o}),function(t){t[t.UNKNONW=0]="UNKNONW",t[t.NUMBER=1]="NUMBER",t[t.BOOLEAN=2]="BOOLEAN"}(n||(n={}));class s{Reset(){this._value=this._range.default}get range(){return this._range}get type(){return this._type}get value(){return this._value}}class r extends s{constructor(t,e,i,s){super(),i=i?Math.min(Math.max(i,t),e):t,this._range={min:t,max:e,default:i,step:s||0},this._value=i,this._type=n.NUMBER}get value(){return this._value}set value(t){this._value=Math.min(Math.max(t,this._range.min),this._range.max)}}class o extends s{constructor(t){super(),this._value=t||!1,this._range={min:!1,max:!0,default:t||!1},this._type=n.BOOLEAN}get value(){return this._value}set value(t){this._value=t}}},"./src/CanvasManager/CanvasManager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"CanvasManager",function(){return d});var n=i("./node_modules/quadtree-lib/build/js/quadtree.min.js"),s=i("./src/@types/GraphView.ts"),r=i("./modified_modules/tsm/vec2.ts"),o=i("./src/CanvasManager/InputManager.ts"),a=i("./src/CanvasManager/GraphRenderer.ts"),l=i("./src/CanvasManager/EventHandlers.ts"),h=i("./node_modules/chroma.ts/dist/index.es.js"),u=i("./src/@types/Color.ts"),c=s.GraphView.onNodesReplaced;class d{constructor(t,e){this.graph_view=null,this.view_configuration=null,this.controller=e,this.canvas=t,this.toggled_node=null,this.inputManager=new o.InputManager,this.inputManager.bindCanvas(t,this.detectObjectsUnderCursor.bind(this)),this.renderer=new a.default(t)}bindGraph(t,e){if(this.view_configuration=e,!e)throw new DOMException("There's no view configuration for graph");let i=[];const n=this.makeGraphView(t,this.view_configuration);if(this.graph_view&&(i=Object.keys(this.graph_view.nodes).filter(t=>this.graph_view.nodes[t].is_selected),Object.keys(n.nodes).forEach(t=>{const i=n.nodes[t];this.graph_view.nodes.hasOwnProperty(t)&&(i.position=this.graph_view.nodes[t].position,i.position.length()>e.scene_size&&i.position.normalize().scale(e.scene_size))}),n.onNodesReplaced()),this.graph_view=n,this.toggled_node){const t=this.toggled_node.id;this.toggled_node=null,this.ToggleNode(t)}i.forEach(t=>{this.SelectNode(t)}),this.inputManager.bindScene(this.graph_view),this.renderer.bindGraphView(this.graph_view,this.view_configuration)}updateViewConfiguration(){const t=this.view_configuration;Object.values(this.graph_view.nodes).forEach(e=>{const i=e.data.norm_weight;e.size=Math.max(Math.min(t.node_sizer(i),t.max_node_size),t.min_node_size);const n=this.view_configuration.node_colors_per_group[e.group];e.base_color=h.color(n),e.emphasized_color=Object(u.getEmphasizedColor)(e.base_color)}),Object.values(this.graph_view.links).forEach(e=>{const i=e.data.norm_weight;e.size=Math.max(Math.min(t.link_sizer(i),t.max_link_size),t.min_link_size)})}update(){this.renderer.render()}layoutGraph(t){t.layout(this.graph_view,this.view_configuration.scene_size)}translateGraph(t){this.renderer.moveCamera(t)}zoomAt(t){this.renderer.scaleGraph(t)}rotateGraph(t){this.renderer.rotation=t/180*Math.PI}translateNode(t,e){const i=this.graph_view.nodes[t];if(i){const t=Math.cos(this.renderer.rotation),n=Math.sin(this.renderer.rotation),s=this.view_configuration.scene_size/this.scaleFactor,r=e.x*s,o=e.y*s;i.position.x+=r*t-o*n,i.position.y+=r*n+o*t}}HideNode(t){const e=this.graph_view.nodes[t];e&&!e.is_hidden&&(e.is_hidden=!0,this.graph_view.quad_tree.remove(this.graph_view.aabbs[t]),e.is_selected&&this.DeselectNode(t),e.is_hovered&&this.HoverOffNode(t),e.is_toggled&&this.ToggleNode(t))}ShowNode(t){const e=this.graph_view.nodes[t];e&&e.is_hidden&&(e.is_hidden=!1,this.graph_view.quad_tree.push(this.graph_view.aabbs[t]))}SetNodeLabel(t,e){const i=this.graph_view.nodes[t];i&&(i.data.label=e)}ToggleNode(t){const e=this.graph_view.nodes[t];this.toggled_node&&t==this.toggled_node.id?(this.toggled_node.is_toggled=!1,this.DeselectAdjacentNodes(this.toggled_node.id),this.controller("OnToggleOffNode",{node_id:this.toggled_node.id}),this.toggled_node=null):(this.toggled_node&&(this.toggled_node.is_toggled=!1,this.DeselectAdjacentNodes(this.toggled_node.id),this.controller("OnToggleOffNode",{node_id:this.toggled_node.id})),this.toggled_node=e,this.toggled_node.is_toggled=!0,this.SelectAdjacentNodes(this.toggled_node.id),this.controller("OnToggleOnNode",{node_id:this.toggled_node.id}))}SelectNode(t){const e=this.graph_view.nodes[t];e&&!e.is_hidden&&(e.is_selected=!0,this.SelectAdjacentNodes(t),this.controller("OnSelectNode",{node_id:t}))}DeselectNode(t){const e=this.graph_view.nodes[t];e&&(e.is_selected=!1,this.DeselectAdjacentNodes(t),this.controller("OnDeselectNode",{node_id:t}))}HoverOnNode(t){const e=this.graph_view.nodes[t];e&&!e.is_hidden&&(e.is_hovered=!0,this.SelectAdjacentNodes(t))}HoverOffNode(t){const e=this.graph_view.nodes[t];e&&(e.is_hovered=!1,this.DeselectAdjacentNodes(t))}ShowLink(t,e){const i=this.graph_view.links_from_node[t][e];if(i&&i.is_hidden){const t=i.to,e=i.from;t.is_hidden||e.is_hidden||(i.is_hidden=!1,(e.is_selected||e.is_toggled||e.is_hovered)&&t.selected_adjacent_vertex_count++)}}HideLink(t,e){const i=this.graph_view.links_from_node[t][e];if(i&&!i.is_hidden){const t=i.to,e=i.from;i.is_hidden=!0,(e.is_toggled||e.is_selected||e.is_hovered)&&t.selected_adjacent_vertex_count--,(t.is_toggled||t.is_selected||t.is_hovered)&&(e.selected_adjacent_vertex_count--,console.log("hide link to",e.data.label))}}detectObjectsUnderCursor(t){this.renderer.CursorPos=t;const e=this.renderer.CursorPosAtScene,i={x:e.x,y:e.y,width:.05,height:.05};return this.graph_view.quad_tree.colliding(i)}get scaleFactor(){return this.renderer.scaleFactor}makeGraphView(t,e){const i={nodes:{},node_groups:{},links:[],links_from_node:{},quad_tree:new n({width:e.scene_size,height:e.scene_size,maxElements:3}),aabbs:{},onDrag:l.onDragScene.bind(this),onDragEnd:null,onZoom:l.onZoom.bind(this)};return i.onNodesReplaced=c.bind(i),t.source_graph.forEachNode(n=>{const s=t.mutable_graph.getNode(n.id),r=s?s.data:n.data,o=d.makeNodeView(e,i,n.id,r);o.is_hidden=t.isManuallyHiddenNode(n.id),i.node_groups[r.group]||(i.node_groups[r.group]={}),i.nodes[n.id]=o,i.node_groups[r.group][n.id]=o,i.links_from_node[n.id]={}}),t.source_graph.forEachLink(n=>{const s=i.nodes[n.fromId],r=i.nodes[n.toId],o=d.makeLinkView(s,r,n,e);o.is_hidden=t.isManuallyHiddenNode(n.fromId)||t.isManuallyHiddenNode(n.toId),i.links.push(o),i.links_from_node[n.fromId][n.toId]=o}),i.quad_tree.clear(),Object.keys(i.nodes).forEach(t=>{const e=this.makeAABB(i.nodes[t]);i.aabbs[t]=e,i.quad_tree.push(e)}),i}static makeNodeView(t,e,i,n){const s=new r.default([120*Math.random()-60,120*Math.random()-60]),o=t.node_colors_per_group[n.group];return{group:n.group,position:s,base_color:h.color(o),emphasized_color:Object(u.getEmphasizedColor)(h.color(o)),is_hovered:!1,is_selected:!1,is_toggled:!1,selected_adjacent_vertex_count:0,is_hidden:!1,size:Math.max(Math.min(t.node_sizer(n.norm_weight),t.max_node_size),t.min_node_size),zOrder:0,id:i,data:Object.assign({},n),graph_view:e}}static makeLinkView(t,e,i,n){const s=i.data.norm_weight;return{from:t,to:e,size:Math.max(Math.min(n.link_sizer(s),n.max_link_size),n.min_link_size),alpha:1,zOrder:0,is_hidden:!1,painter:n.link_painter,data:Object.assign({},i.data)}}makeAABB(t){return{x:t.position.x-t.size,y:t.position.y-t.size,width:2*t.size,height:2*t.size,scene_object:t,onClick:l.onClickNode.bind(this),onDrag:l.onDragNode.bind(this),onDragEnd:l.onDragEndNode.bind(this),onEnter:l.onEnterNode.bind(this),onLeave:l.onLeaveNode.bind(this)}}SelectAdjacentNodes(t){Object.values(this.graph_view.links_from_node[t]).forEach(t=>{t.is_hidden||t.to.selected_adjacent_vertex_count++})}DeselectAdjacentNodes(t){Object.values(this.graph_view.links_from_node[t]).forEach(t=>{t.is_hidden||t.to.selected_adjacent_vertex_count--})}}},"./src/CanvasManager/EventHandlers.ts":function(t,e,i){"use strict";async function n(t,e){this.translateGraph(e),this.update()}async function s(t,e,i){this.zoomAt(e),this.update()}async function r(t,e){const i=this,n=t.scene_object;e.shiftKey&&0==e.button?n.is_selected?i.DeselectNode(n.id):i.SelectNode(n.id):0==e.button?i.ToggleNode(n.id):e.button,i.update()}async function o(t,e){const i=t.scene_object;this.translateNode(i.id,e),this.update()}async function a(t){const e=t,i=e.scene_object,n=i.graph_view.quad_tree;n.remove(e),e.x=i.position.x-i.size,e.y=i.position.y-i.size,n.push(e)}async function l(t){const e=t.scene_object;this.HoverOnNode(e.id),this.update()}async function h(t){const e=t.scene_object;this.HoverOffNode(e.id),this.update()}i.r(e),i.d(e,"onDragScene",function(){return n}),i.d(e,"onZoom",function(){return s}),i.d(e,"onClickNode",function(){return r}),i.d(e,"onDragNode",function(){return o}),i.d(e,"onDragEndNode",function(){return a}),i.d(e,"onEnterNode",function(){return l}),i.d(e,"onLeaveNode",function(){return h})},"./src/CanvasManager/GraphRenderer.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return c});var n=i("./modified_modules/tsm/mat3.ts"),s=i("./modified_modules/tsm/vec2.ts"),r=i("./src/@types/GraphView.ts"),o=i("./src/Renderers/_ShaderCompiler.ts"),a=i("./node_modules/chroma.ts/dist/index.es.js"),l=r.GraphView.isLinkViewEmphasized,h=r.GraphView.isNodeViewEmphasized,u=r.GraphView.isLinkViewDisabled;class c{constructor(t){this.canvas=t,this.context2D=this.canvas.getContext("2d",{alpha:!1}),this.gl_canvas=document.createElement("canvas");try{this.gl=this.gl_canvas.getContext("webgl",{premultipliedAlpha:!1})}catch(t){this.gl=null,console.error("Can't create webgl context")}this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.ALWAYS),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.enable(this.gl.CULL_FACE),this.camera_pos=new s.default([0,0]),this.zoom_direction=new s.default([0,0]),this.cursor_pos_Scene=new s.default([0,0]),this.PV=n.default.identity.copy(),this.PV_inv=n.default.identity.copy(),this.P=n.default.identity.copy(),this.S=n.default.identity.copy(),this.rotation_angle=0}bindGraphView(t,e){this.graph_view=t,this.view_configuration=e,e.scroll_value.Reset(),e.link_renderer.bindContext(this.gl,o.ShaderCompiler_default),Object.keys(e.node_renderer_per_group).forEach(t=>{e.node_renderer_per_group[t].bindContext(this.gl,o.ShaderCompiler_default)}),e.link_renderer.clearObjects(),Object.keys(e.node_renderer_per_group).forEach(t=>e.node_renderer_per_group[t].clearObjects())}render(){const t={x:0,y:0,width:this.canvas.clientWidth,height:this.canvas.clientHeight},e=t.width/t.height,i=this.view_configuration;c.resizeCanvasFramebuffer(this.canvas,t.width,t.height),c.resizeCanvasFramebuffer(this.gl_canvas,t.width*c.samples_count,t.height*c.samples_count),this.gl.viewport(0,0,t.width*c.samples_count,t.height*c.samples_count);const s=Math.cos(this.rotation_angle),r=Math.sin(this.rotation_angle),o=1/e/i.scene_size,a=1/i.scene_size,d=this.camera_pos.x*o,p=this.camera_pos.y*a;this.P.init([o*s,-r*a,0,o*r,a*s,0,d,p,1]);const g=this.view_configuration.scroll_value.value,m=-this.zoom_direction.x*g+this.zoom_direction.x,_=-this.zoom_direction.y*g+this.zoom_direction.y;this.S.init([g,0,0,0,g,0,m,_,1]),n.default.product(this.P,this.S,this.PV),this.PV_inv.init(this.PV.all()),this.PV_inv.inverse();const f=Object.values(this.graph_view.nodes),v=Object.values(this.graph_view.links);this.drawn_nodes=[],this.drawn_links=[],v.forEach(t=>{t.zOrder=0,l(t)?t.zOrder=3:(h(t.from)&&t.zOrder++,h(t.to)&&t.zOrder++),u(t)?this.view_configuration.link_renderer.deleteObject(t):(this.drawn_links.push(t),this.view_configuration.link_renderer.addObject(t))}),f.forEach(t=>{t.zOrder=0,h(t)&&(t.zOrder=1),t.is_hidden?this.view_configuration.node_renderer_per_group[t.group].deleteObject(t):(this.drawn_nodes.push(t),this.view_configuration.node_renderer_per_group[t.group].addObject(t))}),this.context2D.fillStyle="white",this.context2D.fillRect(0,0,this.canvas.width,this.canvas.height),this.drawGraph(),this.view_configuration.always_show_weights&&this.drawEdgeWeights(),this.drawLabels(),c.draw_aabb&&this.drawAABBs()}moveCamera(t){this.camera_pos.x+=t.x*this.view_configuration.scene_size,this.camera_pos.y+=t.y*this.view_configuration.scene_size}scaleGraph(t){t=Math.pow(1.25,t);let e=s.default.difference(this.cursor_pos_Scene,this.zoom_direction);this.view_configuration.scroll_value.value*=t,this.zoom_direction.x+=e.x*t,this.zoom_direction.y+=e.y*t}set rotation(t){this.rotation_angle=t}get rotation(){return this.rotation_angle}get scaleFactor(){return this.view_configuration.scroll_value.value}get CursorPosAtScene(){return this.cursor_pos_Scene}set CursorPos(t){this.cursor_pos_Scene.x=t.x,this.cursor_pos_Scene.y=t.y,this.ClientToScene(this.cursor_pos_Scene)}SceneToClient(t){this.PV.multiplyVec2(t,t),t.x=(t.x+1)*this.canvas.clientWidth/2,t.y=(1-t.y)*this.canvas.clientHeight/2}ClientToScene(t){const e=this.canvas.getBoundingClientRect();t.x=2*(t.x-e.left)/e.width-1,t.y=2*(t.y-e.top)/e.height-1,t.y*=-1,this.PV_inv.multiplyVec2(t,t)}drawGraph(){const t=this.view_configuration;t.link_renderer.sortObjects(),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),t.link_renderer.render(this.PV,0),Object.keys(t.node_renderer_per_group).forEach(e=>{t.node_renderer_per_group[e].render(this.PV,t.node_border_width)}),this.context2D.drawImage(this.gl_canvas,0,0,this.canvas.width,this.canvas.height)}drawLabels(){this.view_configuration.label_painter;const t=new s.default,e=new s.default,i={font_size:this.view_configuration.label_font_size,is_bordered:!0,is_bold:!1,padding:5,text_color:"#000000",background_color:"#ffffff"},n=this.drawn_nodes.filter(t=>this.view_configuration.always_show_labels||t.is_toggled||t.is_selected||t.is_hovered||t.selected_adjacent_vertex_count>0);n.forEach(s=>{if(0==this.view_configuration.label_layout_strategy){t.x=0,t.y=0,e.x=0,e.y=0,n.forEach(t=>{const i=t.position.x-s.position.x,n=t.position.y-s.position.y,r=Math.sqrt(i*i+n*n);r>0&&(e.x+=i/r,e.y+=n/r)});const i=e.y/e.x;e.x>0&&i>1||e.x<0&&i<-1?(e.x=0,e.y=1):i<=1&&i>-1?(e.y=0,e.x>0?e.x=1:e.x=-1):(e.x>0&&i<-1||e.x<0&&i>1)&&(e.x=0,e.y=-1);const r=Math.cos(this.rotation_angle),o=Math.sin(this.rotation_angle);e.x=-e.x,e.y=-e.y,t.x=s.position.x+(e.x*s.size*r-e.y*s.size*o),t.y=s.position.y+(e.x*s.size*o+e.y*s.size*r)}else 1==this.view_configuration.label_layout_strategy&&(t.x=s.position.x,t.y=s.position.y);this.SceneToClient(t),i.is_bold=s.is_toggled,this.drawLabel(s.data.label,t,e,i)})}drawLabel(t,e,i,n){this.context2D.font=`${n.is_bold?"bold":""} ${n.font_size}px sans-serif`;const s=this.context2D.measureText(t).width,r=s+2*n.padding,o=n.font_size+2*n.padding;e.x+=i.x*(r/2),e.y-=i.y*n.font_size,this.context2D.fillStyle=a.color(n.background_color).css(),this.context2D.fillRect(e.x-r/2,e.y-o/2,r,o),this.context2D.fillStyle=a.color(n.text_color).css(),this.context2D.fillText(t,e.x-s/2,e.y+n.padding),n.is_bordered&&this.context2D.strokeRect(e.x-r/2,e.y-o/2,r,o)}drawEdgeWeights(){const t=new s.default([0,0]);this.drawn_links.forEach(e=>{const i=e.data.weight;if(i){const n=String(i.toFixed(1));t.x=e.to.position.x-e.from.position.x,t.y=e.to.position.y-e.from.position.y;const s=t.length(),r=t.x/s,o=t.y/s;t.x=e.from.position.x+t.x/2-(e.size+1)*o,t.y=e.from.position.y+t.y/2+(e.size+1)*r,this.SceneToClient(t);const a=this.context2D.measureText(n).width,l=this.view_configuration.label_font_size;this.context2D.fillStyle="black",this.context2D.fillText(n,t.x-a/2,t.y+l/2)}})}drawAABBs(){var t=new s.default,e=new s.default;this.graph_view.quad_tree.each(i=>{t.x=i.x,t.y=i.y,e.x=i.x+i.width,e.y=i.y+i.height,this.SceneToClient(t),this.SceneToClient(e),this.context2D.strokeRect(t.x,t.y,e.x-t.x,e.y-t.y)})}drawCursor(){var t=new s.default(this.cursor_pos_Scene.xy);this.SceneToClient(t),this.context2D.fillRect(t.x-2.5,t.y-2.5,5,5)}static resizeCanvasFramebuffer(t,e,i){t.width===e&&t.height===i||(t.width=e,t.height=i)}}c.dScale=1.25,c.samples_count=2,c.draw_aabb=!1},"./src/CanvasManager/InputManager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"InputManager",function(){return s});var n=i("./modified_modules/tsm/tsm.ts");class s{constructor(){this.hovered_objects=[],this.cursor_pos=new n.vec2([0,0]),this.old_cursor_pos=new n.vec2([0,0]),this.cursor_offset=new n.vec2([0,0])}bindCanvas(t,e){this.canvas=t,document.onmousedown=this.onMouseDown.bind(this),document.onmouseup=this.onMouseUp.bind(this),document.onmousemove=this.onMouseMove.bind(this),this.canvas.onwheel=this.onCanvasScroll.bind(this),this.canvas.ondblclick=this.onDblCLick.bind(this),this.object_detector=e}bindScene(t){this.scene=t}onMouseDown(t){const e=this.canvas.getBoundingClientRect();t.clientX>e.left&&t.clientX<e.right&&t.clientY>e.top&&t.clientY<e.bottom&&(this.old_cursor_pos.xy=[t.clientX,t.clientY],this.cursor_pos.xy=this.old_cursor_pos.xy,this.mouse_moved=!1,this.mouse_pressed=!0)}onMouseUp(t){this.mouse_pressed&&this.hovered_objects.length>0&&(this.mouse_moved?this.hovered_objects[0].onDragEnd&&this.hovered_objects[0].onDragEnd(this.hovered_objects[0]):this.hovered_objects[0].onClick&&this.hovered_objects[0].onClick(this.hovered_objects[0],t)),this.mouse_moved=!1,this.mouse_pressed=!1}onMouseMove(t){const e=this.canvas.width/this.canvas.height;if(this.cursor_pos.x=t.clientX,this.cursor_pos.y=t.clientY,this.mouse_pressed)this.cursor_offset.x=2*(this.cursor_pos.x-this.old_cursor_pos.x)*s.mouse_sensitivity*e/this.canvas.width,this.cursor_offset.y=-2*(this.cursor_pos.y-this.old_cursor_pos.y)*s.mouse_sensitivity/this.canvas.height,this.hovered_objects.length>0&&this.hovered_objects[0].onDrag?this.hovered_objects[0].onDrag(this.hovered_objects[0],this.cursor_offset):0==this.hovered_objects.length&&this.scene.onDrag&&this.scene.onDrag(this.scene,this.cursor_offset),this.old_cursor_pos.x=this.cursor_pos.x,this.old_cursor_pos.y=this.cursor_pos.y,this.mouse_moved=!0;else{const t=this.object_detector(this.cursor_pos);this.hovered_objects.filter(e=>-1==t.indexOf(e)&&e.onLeave).forEach(t=>t.onLeave(t)),t.filter(t=>-1==this.hovered_objects.indexOf(t)&&t.onEnter).forEach(t=>t.onEnter(t)),this.hovered_objects=t}}onDblCLick(t){this.hovered_objects.length>0&&this.hovered_objects[0].onDblClick&&this.hovered_objects[0].onDblClick(this.hovered_objects[0],t)}onCanvasScroll(t){this.scene.onZoom&&this.scene.onZoom(this.scene,t.deltaY/-100,this.cursor_pos)}}s.mouse_sensitivity=1},"./src/GUI.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"GUI",function(){return v});var n=i("./node_modules/split.js/split.js"),s=i("./src/CanvasManager/CanvasManager.ts"),r=i("./src/@types/Graph.ts"),o=i("./src/@types/GUI.ts"),a=i("./node_modules/chroma.ts/dist/index.es.js"),l=i("./src/@types/Color.ts"),h=r.GraphControlling.getFirstState,u=r.GraphControlling.calculateState;const c=o.id_prefix+"_graph_view",d=o.id_prefix+"_canvas",p=o.id_prefix+"_rotate_bar",g=o.id_prefix+"_state_bar",m=o.id_prefix+"_state_stub",_=o.id_prefix+"_state_stub_btn",f=o.id_prefix+"_tabs";class v{constructor(t){this.node_weight_range={min:-1/0,max:1/0,default:0},this.link_weight_range={min:-1/0,max:1/0,default:0},this.canvas_manager=null,this.out_controller=t}build(t,e,i){this.gui_configuration=e,this.translator=i,t.innerHTML=`\n        <aside id=${c} class="split split-horizontal">\n            <div id=${p} class="ui-slider-handle">\n                <div id=${p}_handle class="ui-slider-handle"></div>\n            </div>\n            <canvas id=${d} tabindex=0></canvas>\n            \n            <div id=${g} style="position: relative">\n                 <div id=${g}_line></div>\n                 <div id=${g}_labels></div>\n                 <div id=${m} class="scivi_state_line_curtain scivi_state_line_curtain_bg">\n                    <div id=${_} class="scivi_state_line_curtain_lbl">\n                        ${this.translator.apply("LOC_STATECALCULATED")}\n                    </div>\n                </div>\n            </div>\n        </aside>`;const s=document.getElementById(m);if(s.style.display="flex",s.style.flexDirection="column",s.style.justifyContent="center",s.style.alignItems="center",document.getElementById(_).onclick=(()=>{v.hideStateBarStub();const t=$("#"+g+"_line").slider("option","value"),e=Object.values(this.bound_graph.states)[t||0];this.setState(e)}),v.hideStateBarStub(),Object.keys(e).length>0){const s=document.createElement("aside");s.className="split split-horizontal",s.id=f;const r=document.createElement("ul");s.appendChild(r),Object.keys(e).forEach(t=>{const e=document.createElement("li"),n="#"+t;e.innerHTML=`<a id=${o.id_prefix+t+"_link"} href=${n}>${i.apply(n)}</a>`,r.appendChild(e)}),Object.keys(e).forEach(t=>{const e=document.createElement("div");e.id=t,s.appendChild(e)}),t.appendChild(s),n(["#"+c,"#"+f],{gutterSize:8,cursor:"col-resize",sizes:[55,45],onDrag:()=>this.canvas_manager.update()}),$("#"+f).tabs({heightStyle:"fill"})}this.initGraphViewPanel(),Object.keys(e).forEach(t=>{const n=document.getElementById(t);e[t].build(n,this.TabsController.bind(this),i)}),document.body.onresize=(()=>this.canvas_manager.update())}bindGraph(t,e){t.states.length>0&&(this.bound_graph=t,t.states.length>1&&this.fillStateBar(),this.view_configuration=e,this.setState(h(t)),this.gui_configuration.calculator_tab&&this.gui_configuration.calculator_tab.fill(t),this.gui_configuration.filters_tab&&this.gui_configuration.filters_tab.fill(t))}initGraphViewPanel(){const t=document.getElementById(c);t.style.display="flex",t.style.flexDirection="column";const e=document.getElementById(p);e.style.marginTop="0.5rem",e.style.marginBottom="0.5rem",e.style.marginLeft="2rem",e.style.marginRight="2rem";const i=$("#"+p+"_handle");$("#"+p).slider({min:-180,max:180,value:0,step:5,slide:(t,e)=>{const n=e.value||0;i.text(`${n}°`),this.canvas_manager.rotateGraph(n),this.canvas_manager.update()},create:()=>i.text("0°")});const n=document.getElementById(d);n.style.border="solid white 1px",n.style.flex="1 1 auto",n.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation()},this.canvas_manager=new s.CanvasManager(n,this.CanvasManagerController.bind(this))}fillStateBar(){const t=Object.keys(this.bound_graph.states).length,e=100/t,i=document.getElementById(g+"_line");i.style.marginTop="0.5rem",i.style.marginRight=`${e/2}%`,i.style.marginLeft=`${e/2}%`,$("#"+g+"_line").slider({min:0,max:t-1,value:0,step:1,slide:(t,e)=>{const i=this.bound_graph.states[e.value||0];this.setState(i)}});const n=document.getElementById(g+"_labels");this.bound_graph.states.forEach(t=>{const i=document.createElement("div");i.style.display="inline-block",i.style.textAlign="center",i.innerHTML=`<span>|</span><br/><label>${t.label}</label>`,i.classList.add("scivi_fsgraph_stateline_label"),i.style.width=`${e}%`,n.appendChild(i)})}setState(t){this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.fill(t),this.gui_configuration.about_graph_tab&&this.gui_configuration.about_graph_tab.fill(t),this.active_state=t,this.canvas_manager.bindGraph(t,this.view_configuration),this.FilterNodes(),this.canvas_manager.update()}static showStateBarStub(){document.getElementById(m).style.display="flex"}static hideStateBarStub(){document.getElementById(m).style.display="none"}FilterNodes(){this.active_state.source_graph.forEachNode(t=>{if(!this.active_state.isManuallyHiddenNode(t.id)){const e=t.data.weight;!e&&0!=e||e>=this.node_weight_range.min&&e<=this.node_weight_range.max?(this.active_state.showNode(t.id),this.canvas_manager.ShowNode(t.id)):(this.canvas_manager.HideNode(t.id),this.active_state.hideNode(t.id))}}),this.FilterLinks()}FilterLinks(){this.active_state.source_graph.forEachLink(t=>{const e=t.data.weight;!e&&0!=e||e>=this.link_weight_range.min&&e<=this.link_weight_range.max?(this.active_state.showLink(t.fromId,t.toId),this.canvas_manager.ShowLink(t.fromId,t.toId)):(this.canvas_manager.HideLink(t.fromId,t.toId),this.active_state.hideLink(t.fromId,t.toId))})}async CanvasManagerController(t,e){switch(t){case"OnToggleOnNode":this.gui_configuration.node_info_tab&&this.gui_configuration.node_info_tab.fill({graph:this.active_state,node_id:e.node_id});break;case"OnToggleOffNode":this.gui_configuration.node_info_tab&&this.gui_configuration.node_info_tab.clear();break;case"OnSelectNode":this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.onSelectedNode(e.node_id);break;case"OnDeselectNode":this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.onDeselectedNode(e.node_id)}}async TabsController(t,e){switch(t){case"layout":this.canvas_manager.layoutGraph(e.builder);break;case"SelectNode":this.canvas_manager.SelectNode(e.node_id);break;case"DeselectNode":this.canvas_manager.DeselectNode(e.node_id);break;case"ShowNode":{const t=e.node_id;this.active_state.showNode(t,!0),this.canvas_manager.ShowNode(t),this.FilterNodes()}break;case"HideNode":{const t=e.node_id;this.canvas_manager.HideNode(t),this.active_state.hideNode(t,!0)}break;case"ChangeNodeName":{const t=e.node_id,i=e.new_name;this.active_state.mutable_graph.getNode(t).data.label=i,this.active_state.source_graph.getNode(t).data.label=i,this.canvas_manager.SetNodeLabel(t,i)}break;case"FilterNodes":{const t=e.min,i=e.max;this.node_weight_range.min=t,this.node_weight_range.max=i,this.FilterNodes()}break;case"FilterLinks":{const t=e.min,i=e.max;this.link_weight_range.min=t,this.link_weight_range.max=i,this.FilterLinks()}break;case"SetNodeSizeRange":this.view_configuration.min_node_size=e.min,this.view_configuration.max_node_size=e.max,this.canvas_manager.updateViewConfiguration();break;case"SetLinkSizeRange":this.view_configuration.min_link_size=e.min,this.view_configuration.max_link_size=e.max,this.canvas_manager.updateViewConfiguration();break;case"SetNodeAlpha":Object.keys(this.view_configuration.node_colors_per_group).forEach(t=>{const i=this.view_configuration.node_colors_per_group[t],n=a.color(i).alpha(e.alpha);this.view_configuration.node_colors_per_group[t]=n.hex("rgba")}),this.canvas_manager.updateViewConfiguration();break;case"SetBorderSize":{const t=e.size;this.view_configuration.node_border_width=t,this.canvas_manager.updateViewConfiguration()}break;case"Clusterise":{this.active_state.clusterize();const t=this.active_state.meta.groups_count,e=Object(l.createColorsForGraphView)(t,1);for(let i=0;i<t;i++)this.view_configuration.node_colors_per_group[i]=e[i],this.view_configuration.node_renderer_per_group[i]=this.view_configuration.node_renderer_per_group[0];this.setState(this.active_state)}break;case"SavePNG":{const t=document.getElementById(d);var i=document.createElement("a");i.download="graph.png",i.href=t.toDataURL(),i.click()}break;case"ToggleLabelsShowing":this.view_configuration.always_show_labels=!this.view_configuration.always_show_labels;break;case"ToggleWeightsShowing":this.view_configuration.always_show_weights=!this.view_configuration.always_show_weights;break;case"SetLabelFontSize":this.view_configuration.label_font_size=e.font_size;break;case"CalcState":{const t=e.expr,i=u(this.bound_graph,t);this.setState(i),v.showStateBarStub()}break;case"SelectLabelLayoutStrategy":{const t=Number(e.strategy_id);this.view_configuration.label_layout_strategy=t,this.canvas_manager.updateViewConfiguration()}break;default:console.log("unknown event: ",t,e)}this.canvas_manager.update()}}},"./src/GraphSerializer.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"GraphSerializer",function(){return a});var n=i("./src/@types/Graph.ts"),s=n.GraphControlling.GraphState,r=n.GraphControlling.EmptyMeta,o=n.GraphControlling.updateGraphMeta;class a{fromJSON(t){let e={states:[],meta:Object.assign({},r)},i=t.states||t;if(console.log(i),i&&"function"==typeof i[Symbol.iterator])for(let t of i){const i=t.label;console.log(t),e.states.push(a.fillState(i,t))}else e.states.push(a.fillState("0",t));return o(e),e}static fillState(t,e){const i=new s(t);i.source_graph.beginUpdate();const n=e.nodes,r=e.edges;for(let t of n){const e=t.id,n=t.group?t.group:0;let s={label:t.label?t.label:"#no_label",group:n,norm_weight:0};Object.keys(t).forEach(e=>{"id"!=e&&"group"!=e&&"label"!=e&&(s[e]=t[e])}),i.source_graph.addNode(e,s)}for(let t of r){const e=t.source,n=t.target;let s={norm_weight:0};Object.keys(t).forEach(e=>{"source"!=e&&"target"!=e&&(s[e]=t[e])}),i.source_graph.addLink(e,n,s)}return i.source_graph.endUpdate(),i.mutable_graph.beginUpdate(),i.source_graph.forEachNode(t=>{{const e=Object.assign({},t.data);i.mutable_graph.addNode(t.id,e)}}),i.source_graph.forEachLink(t=>{{const e=Object.assign({},t.data);i.mutable_graph.addLink(t.fromId,t.toId,e)}}),i.mutable_graph.endUpdate(),i.updateMeta(),i}}a.default_group_index=0},"./src/LayoutBuilders/LayoutBuilder_Circle.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"LayoutBuilder_Circle",function(){return n});class n{constructor(t){this.ranges=t}layout(t,e){const i=this.ranges.R.value;if(this.ranges.use_cluster_splitting.value){const e=Object.keys(t.node_groups).sort((e,i)=>t.node_groups[i].length-t.node_groups[e].length),s=i/e.length;let r=i;e.forEach(e=>{const i=t.node_groups[e];n.layout_cluster(i,r),r-=s})}else n.layout_cluster(t.nodes,i);return t.onNodesReplaced(),!0}getParamsNames(){return["R","use_cluster_splitting"]}setConfiguration(t){this.ranges=t}getConfiguration(){return this.ranges}static layout_cluster(t,e){let i=0;const n=Object.keys(t).filter(e=>!t[e].is_hidden),s=2*Math.PI/n.length;n.forEach(n=>{const r=t[n];r.position.x=e*Math.cos(i),r.position.y=e*Math.sin(i),i+=s})}}},"./src/LayoutBuilders/LayoutBuilder_FruchtermanReingold.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"LayoutBuilder_FruchtermanReingold",function(){return o});var n=i("./src/@types/GraphView.ts"),s=i("./modified_modules/tsm/tsm.ts"),r=n.GraphView.isLinkViewDisabled;class o{constructor(t){this.ranges=t}layout(t,e){const i=e+20,n=this.ranges.iterations_count.value,r=this.ranges.optimal_vertex_distance.value,a=this.ranges.is_bounding.value,l=this.ranges.use_cluster_splitting.value,h=new s.vec2([0,0]),u=Object.keys(t.node_groups);if(l&&u.length>1){const e={};Object.keys(t.links).forEach(i=>{const n=t.links[i];n.from.group==n.to.group&&(e[n.from.group]||(e[n.from.group]=[]),e[n.from.group].push(n))});const s=.75*i;let l=0;const c=2*Math.PI/u.length;u.forEach(d=>{h.x=s*Math.cos(l),h.y=s*Math.sin(l),l+=c;const p=i*i/u.length,g=r/u.length,m=n/u.length;o.layout_cluster(g,p,m,a,h,t.node_groups[d],e[d])})}else{const e=Object.keys(t.links).map(e=>t.links[e]);o.layout_cluster(r,i,n,a,h,t.nodes,e)}return t.onNodesReplaced(),!0}getParamsNames(){return["iterations_count","optimal_vertex_distance","is_bounding","use_cluster_splitting"]}getConfiguration(){return this.ranges}setConfiguration(t){this.ranges=t}static layout_cluster(t,e,i,n,o,a,l){const h=Object.keys(a).filter(t=>!a[t].is_hidden),u=h.length,c=t*Math.sqrt(e/u);let d=10*Math.sqrt(u);const p=(t,e,i)=>t*t/c,g=(t,e,i)=>c*c/t,m={};h.forEach(t=>{m[t]=new s.vec2([0,0]);const e=c,i=2*Math.PI/u;let n=0;h.forEach(t=>{a[t].position.x=o.x+e*Math.cos(n),a[t].position.y=o.y+e*Math.sin(n),n+=i})});const _=new s.vec2;if(l)for(let t=0;t<i&&d>1e-5;t++)h.forEach(t=>{const e=a[t];h.forEach(i=>{if(t!=i){const n=a[i];s.vec2.difference(e.position,n.position,_);let r=_.length();const o=g(r,e.size,n.size);m[i].x-=_.x/r*o,m[i].y-=_.y/r*o,m[t].x+=_.x/r*o,m[t].y+=_.y/r*o}})}),l.forEach(t=>{if(!r(t)){const e=t.from,i=t.to;s.vec2.difference(e.position,i.position,_);let n=_.length();const r=Math.min(p(n,e.size,i.size),n/2);m[i.id].x+=_.x/n*r,m[i.id].y+=_.y/n*r,m[e.id].x-=_.x/n*r,m[e.id].y-=_.y/n*r}}),h.forEach(t=>{const i=a[t];let s=m[t].length();s>0&&(i.position.x+=m[t].x/s*Math.min(d,s),i.position.y+=m[t].y/s*Math.min(d,s),n&&(i.position.x=o.x+Math.min(e,Math.max(-e,i.position.x-o.x)),i.position.y=o.y+Math.min(e,Math.max(-e,i.position.y-o.y)))),m[t].x=0,m[t].y=0}),d*=.9}}},"./src/Renderers/CircleNodeRenderer.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"CircleNodeRenderer",function(){return l});var n=i("./src/@types/GraphView.ts"),s=i("./src/Renderers/_Utils.ts"),r=n.GraphView.isNodeViewEmphasized;const o=8*Float32Array.BYTES_PER_ELEMENT,a=Uint16Array.BYTES_PER_ELEMENT;class l{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;    \n        attribute vec2 a_uv;     \n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        uniform float u_border_width;\n        varying vec2 v_uv;\n        varying vec4 v_color;\n        varying float b_width;\n\n        void main(void)\n        {\n            v_color = a_color;\n            v_uv = a_uv;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        uniform mediump float u_border_width;\n        varying vec2 v_uv;\n        varying vec4 v_color;\n        const float sharpness = 1.0;//резкость границ\n        const float base = 64.0;\n\n        void main(void) {\n            float R = length(v_uv);\n            //shape\n            float sh = pow(base, sharpness);\n            float alpha_m = max(1.0 - pow(R, sh), 0.0);\n            //border\n            float border_m = max(1.0 - pow(R + u_border_width, sh), 0.0);   \n            gl_FragColor = vec4(v_color.r * border_m, v_color.g * border_m, v_color.b * border_m, v_color.a * alpha_m);    \n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color","a_uv"],uniforms:["u_pv","u_border_width"]},this.geometry={vertices:new Float32Array(4*o*this.default_max_objects_count),indices:new Uint16Array(6*a*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.gl=null,this.program=null,this.objects=[]}render(t,e){this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.uniform1f(this.program.uniforms.u_border_width,e),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,o,0),this.gl.enableVertexAttribArray(this.program.attributes.a_uv),this.gl.vertexAttribPointer(this.program.attributes.a_uv,2,this.gl.FLOAT,!1,o,2*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,o,4*Float32Array.BYTES_PER_ELEMENT),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.DYNAMIC_DRAW),this.gl.drawElements(this.gl.TRIANGLES,6*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_uv),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=Object(s.resizeFloat32Array)(2*t.vertices.length,t.vertices),t.indices=Object(s.resizeUint16Array)(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=l.makeVerticesArray(e);this.geometry.vertices.set(i,32*t)}else{const i=this.geometry.objects_count;this.offsets.set(e,i);const n=l.makeVerticesArray(e),s=l.makeIndicesArray(4*i);this.geometry.vertices.set(n,32*i),this.geometry.indices.set(s,6*i),this.objects.push(t),this.geometry.objects_count++}}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=this.geometry.objects_count-1;if(t!=i&&(this.offsets.set(this.objects[i],t),this.objects[t]=this.objects[i],this.geometry.vertices.copyWithin(32*t,32*i,32*i+32)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=Object(s.resizeFloat32Array)(t.vertices.length/2,t.vertices),t.indices=Object(s.resizeUint16Array)(t.indices.length/2,t.indices),t.max_objects_count/=2}}}sortObjects(){}static makeVerticesArray(t){let e=t.base_color.gl();(r(t)||t.selected_adjacent_vertex_count>0)&&(e=t.emphasized_color.gl());const i=t.size;return[t.position.x-i,t.position.y-i,-1,-1,e[0],e[1],e[2],e[3],t.position.x+i,t.position.y-i,1,-1,e[0],e[1],e[2],e[3],t.position.x+i,t.position.y+i,1,1,e[0],e[1],e[2],e[3],t.position.x-i,t.position.y+i,-1,1,e[0],e[1],e[2],e[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t]}}},"./src/Renderers/OrientedStraightLinkRenderer.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"OrientedStraightLinkRenderer",function(){return h});var n=i("./src/@types/GraphView.ts"),s=i("./src/Renderers/_Utils.ts"),r=n.GraphView.isLinkViewEmphasized,o=n.GraphView.isNodeViewEmphasized;const a=6*Float32Array.BYTES_PER_ELEMENT,l=Uint16Array.BYTES_PER_ELEMENT;class h{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;\n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        varying vec4 v_color;\n\n        void main(void)\n        {\n            v_color = a_color;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        varying vec4 v_color;\n\n        void main(void) {\n            gl_FragColor = v_color;\n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color"],uniforms:["u_pv"]},this.geometry={vertices:new Float32Array(7*a*this.default_max_objects_count),indices:new Uint16Array(9*l*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.objects=[]}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}render(t){this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,a,0),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,a,2*Float32Array.BYTES_PER_ELEMENT),this.gl.drawElements(this.gl.TRIANGLES,9*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=Object(s.resizeFloat32Array)(2*t.vertices.length,t.vertices),t.indices=Object(s.resizeUint16Array)(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=h.makeVerticesArray(e);this.geometry.vertices.set(i,42*t)}else{const t=this.geometry.objects_count;this.offsets.set(e,t),this.objects.push(e);const i=h.makeVerticesArray(e),n=h.makeIndicesArray(7*t);this.geometry.vertices.set(i,42*t),this.geometry.indices.set(n,9*t),this.geometry.objects_count++}}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=this.geometry.objects_count-1;if(t!=i&&(this.offsets.set(this.objects[i],t),this.objects[t]=this.objects[i],this.geometry.vertices.copyWithin(42*t,42*i,42*i+42)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=Object(s.resizeFloat32Array)(t.vertices.length/2,t.vertices),t.indices=Object(s.resizeUint16Array)(t.indices.length/2,t.indices),t.max_objects_count/=2}}}sortObjects(){const t=[...this.objects];t.sort((t,e)=>t.zOrder-e.zOrder);const e=new Float32Array(this.geometry.vertices);for(let i=0;i<this.objects.length;i++){const n=t[i],s=this.offsets.get(n);for(let t=0;t<42;t++)e[42*i+t]=this.geometry.vertices[42*s+t];this.offsets.set(n,i)}this.geometry.vertices=e,this.objects=t}static makeVerticesArray(t){const e=t.from,i=t.to,n=i.position.y-e.position.y,s=i.position.x-e.position.x,a=Math.sqrt(n*n+s*s),l=s/a,h=n/a,u=l*t.size,c=h*t.size;let d,p;r(t)?(d=t.painter(t.from.emphasized_color.gl()),p=t.painter(t.to.emphasized_color.gl()),d[3]=1,p[3]=1):(d=o(e)?t.painter(t.from.emphasized_color.gl()):t.painter(t.from.base_color.gl()),p=o(i)?t.painter(t.to.emphasized_color.gl()):t.painter(t.to.base_color.gl()));const g=i.size+5*t.size;return[e.position.x+e.size*l-c,e.position.y+e.size*h+u,d[0],d[1],d[2],d[3],e.position.x+e.size*l+c,e.position.y+e.size*h-u,d[0],d[1],d[2],d[3],i.position.x-g*l+c,i.position.y-g*h-u,p[0],p[1],p[2],p[3],i.position.x-g*l-c,i.position.y-g*h+u,p[0],p[1],p[2],p[3],i.position.x-i.size*l,i.position.y-i.size*h,p[0],p[1],p[2],p[3],i.position.x-g*l-4*c,i.position.y-g*h+4*u,p[0],p[1],p[2],p[3],i.position.x-g*l+4*c,i.position.y-g*h-4*u,p[0],p[1],p[2],p[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t,t+4,t+5,t+6]}}},"./src/Renderers/StraightLinkRenderer.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"StraightLinkRenderer",function(){return h});var n=i("./src/@types/GraphView.ts"),s=i("./src/Renderers/_Utils.ts"),r=n.GraphView.isLinkViewEmphasized,o=n.GraphView.isNodeViewEmphasized;const a=6*Float32Array.BYTES_PER_ELEMENT,l=Uint16Array.BYTES_PER_ELEMENT;class h{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;\n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        varying vec4 v_color;\n\n        void main(void)\n        {\n            v_color = a_color;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        varying vec4 v_color;\n\n        void main(void) {\n            gl_FragColor = v_color;\n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color"],uniforms:["u_pv"]},this.geometry={vertices:new Float32Array(4*a*this.default_max_objects_count),indices:new Uint16Array(6*l*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.geometry.vertices.fill(0),this.objects=[]}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}render(t){this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,a,0),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,a,2*Float32Array.BYTES_PER_ELEMENT),this.gl.drawElements(this.gl.TRIANGLES,6*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=Object(s.resizeFloat32Array)(2*t.vertices.length,t.vertices),t.indices=Object(s.resizeUint16Array)(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=h.makeVerticesArray(e);this.geometry.vertices.set(i,24*t)}else{const t=this.geometry.objects_count;this.offsets.set(e,t);const i=h.makeVerticesArray(e),n=h.makeIndicesArray(4*t);this.geometry.vertices.set(i,24*t),this.geometry.indices.set(n,6*t),this.geometry.objects_count=this.objects.push(e)}}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),i=this.geometry.objects_count-1;if(t!=i&&(this.offsets.set(this.objects[i],t),this.objects[t]=this.objects[i],this.geometry.vertices.copyWithin(24*t,24*i,24*i+24)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=Object(s.resizeFloat32Array)(t.vertices.length/2,t.vertices),t.indices=Object(s.resizeUint16Array)(t.indices.length/2,t.indices),t.max_objects_count/=2}}}sortObjects(){const t=[...this.objects];t.sort((t,e)=>t.zOrder-e.zOrder);const e=new Float32Array(this.geometry.vertices);for(let i=0;i<this.objects.length;i++){const n=t[i],s=this.offsets.get(n);for(let t=0;t<24;t++)e[24*i+t]=this.geometry.vertices[24*s+t];this.offsets.set(n,i)}this.geometry.vertices=e,this.objects=t}static makeVerticesArray(t){const e=t.from,i=t.to,n=i.position.y-e.position.y,s=i.position.x-e.position.x,a=Math.sqrt(n*n+s*s),l=n/a,h=s/a*t.size,u=l*t.size;let c,d;return r(t)?(c=t.painter(t.from.emphasized_color.gl()),d=t.painter(t.to.emphasized_color.gl()),c[3]=1,d[3]=1):(c=o(e)?t.painter(t.from.emphasized_color.gl()):t.painter(t.from.base_color.gl()),d=o(i)?t.painter(t.to.emphasized_color.gl()):t.painter(t.to.base_color.gl())),[e.position.x-u,e.position.y+h,c[0],c[1],c[2],c[3],e.position.x+u,e.position.y-h,c[0],c[1],c[2],c[3],i.position.x+u,i.position.y-h,d[0],d[1],d[2],d[3],i.position.x-u,i.position.y+h,d[0],d[1],d[2],d[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t]}}},"./src/Renderers/_ShaderCompiler.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"ShaderCompiler_default",function(){return s});class n{compile(t,e){const i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,e.vertex_shader),t.compileShader(i);let s=t.getShaderParameter(i,t.COMPILE_STATUS);if(!s)return alert(t.getShaderInfoLog(i)),null;const r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e.fragment_shader),t.compileShader(r),!(s=t.getShaderParameter(r,t.COMPILE_STATUS)))return t.deleteShader(i),alert(t.getShaderInfoLog(r)),null;const o=t.createProgram();return t.attachShader(o,i),t.attachShader(o,r),t.linkProgram(o),(s=t.getProgramParameter(o,t.LINK_STATUS))?{program:o,attributes:n.getAttributeLocations(t,o,e.attributes),uniforms:n.getUniformLocations(t,o,e.uniforms)}:null}static getAttributeLocations(t,e,i){let n={};for(let s=0;s<i.length;++s){let r=i[s],o=-1;if(-1===(o=t.getAttribLocation(e,r)))throw new Error("Program doesn't have required attribute: "+r);n[i[s]]=o}return n}static getUniformLocations(t,e,i){let n={};for(let s=0;s<i.length;++s){let r=i[s];{let o=t.getUniformLocation(e,r);if(null===o)throw new Error("Program doesn't have required uniform: "+r);n[i[s]]=o}}return n}}const s=new n},"./src/Renderers/_Utils.ts":function(t,e,i){"use strict";function n(t,e){let i=new Float32Array(t);if(t>e.length)i.set(e,0);else for(let n=0;n<t;++n)i[n]=e[n];return i}function s(t,e){let i=new Uint16Array(t);if(t>e.length)i.set(e,0);else for(let n=0;n<t;++n)i[n]=e[n];return i}i.r(e),i.d(e,"resizeFloat32Array",function(){return n}),i.d(e,"resizeUint16Array",function(){return s})},"./src/Tabs/AboutGraphTab.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"AboutGraphTab",function(){return l});var n=i("./src/@types/GUI.ts");const s=n.id_prefix+"_about_tab_graph_name",r=n.id_prefix+"_about_tab_nodes_count_metric",o=n.id_prefix+"_about_tab_links_count_metric",a=n.id_prefix+"_about_tab_groups_count_metric";class l{constructor(t){this.container=null,this.controller=null,this.translator=null}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%",this.clear()}clear(){this.container.innerHTML=`\n            <h3 id=${s}>no graph</h3>\n            <h3>${this.translator.apply("#metrics")}</h3>\n            <ul>\n                <li style="list-style-type: none">${this.translator.apply("#groups_count")}: <span id=${a}></span></li>\n                <li style="list-style-type: none">${this.translator.apply("#nodes_count")}: <span id=${r}></span></li>\n                <li style="list-style-type: none">${this.translator.apply("#links_count")}: <span id=${o}></span></li>\n                \n            </ul>\n        `}fill(t){const e=t;document.getElementById(s).innerText=`::${e.label}`,document.getElementById(r).innerText=String(e.meta.nodes_count),document.getElementById(o).innerText=String(e.meta.links_count),document.getElementById(a).innerText=String(e.meta.groups_count)}}},"./src/Tabs/CalculatorTab.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"StateCalculatorOperand",function(){return n}),i.d(e,"CalculatorTab",function(){return o});var n,s=i("./src/@types/GUI.ts");!function(t){t.UNION="UNION",t.INTERSECT="INTERSECT",t.DIFF="DIFF",t.SYMDIFF="SYMDIFF"}(n||(n={}));const r=s.id_prefix+"_calculator_tab_expression";class o{build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";const n=document.createElement("div");n.id=r,n.style.marginBottom="1rem",this.container.appendChild(n),n.appendChild(document.createElement("br"));const s=document.createElement("button");s.className="scivi_button",s.innerText=this.translator.apply("LOC_ADDOPERAND"),this.container.appendChild(s),s.onclick=this.addOperand.bind(this);const a=document.createElement("button");a.className="scivi_button",a.innerText=this.translator.apply("LOC_CALCULATE"),this.container.appendChild(a),a.onclick=(()=>this.controller("CalcState",{expr:o.buildExpression(n)}));const l=document.createElement("button");l.className="scivi_button",l.innerText=this.translator.apply("LOC_CLEANCALC"),this.container.appendChild(l),l.onclick=this.initExpression.bind(this)}clear(){}fill(t){const e=t;this.states=e.states.map(t=>t.label),this.operators={},Object.keys(n).forEach(t=>{this.operators[t]=this.translator.apply(`#${t}`)}),this.initExpression()}initExpression(){const t=document.getElementById(r);t.innerHTML="",t.appendChild(o.createOperandCombo(this.states)),t.appendChild(o.createOperatorCombo(this.operators)),t.appendChild(o.createOperandCombo(this.states)),t.appendChild(document.createElement("br"))}addOperand(){const t=document.getElementById(r);t.appendChild(o.createOperatorCombo(this.operators)),t.appendChild(o.createOperandCombo(this.states)),t.appendChild(document.createElement("br"))}static createOperandCombo(t){const e=document.createElement("select");return t.forEach(i=>{const n=document.createElement("option");n.innerText=i,n.value=String(t.indexOf(i)),e.appendChild(n)}),e}static createOperatorCombo(t){const e=document.createElement("select");return Object.keys(t).forEach(i=>{const n=document.createElement("option");n.innerText=t[i],n.value=i,e.appendChild(n)}),e}static buildExpression(t){return Array.from(t.getElementsByTagName("select")).map(t=>t.value)}}},"./src/Tabs/FiltersTab.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"FiltersTab",function(){return c});var n=i("./src/@types/GUI.ts"),s=i("./src/@types/Param.ts");const r=n.id_prefix+"_filters_tab_node_threshold_max",o=n.id_prefix+"_filters_tab_node_threshold_min",a=n.id_prefix+"_filters_tab_node_threshold_slider",l=n.id_prefix+"_filters_tab_link_threshold_max",h=n.id_prefix+"_filters_tab_link_threshold_min",u=n.id_prefix+"_filters_tab_link_threshold_slider";class c{constructor(t){this.container=null,this.controller=null,this.translator=null,this.min_node_weight=null,this.max_node_weight=null,this.min_link_weight=null,this.max_link_weight=null}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";{const t=document.createElement("div");{const e=document.createElement("p");e.innerHTML=`${i.apply("LOC_NODE_THRESHOLD")}\n                               <input type="number" id="${o}" size="10" onkeydown="size=value.length||10">\n                                —\n                                <input type="number" id="${r}" size="10" onkeydown="size=value.length||10">`,t.appendChild(e)}const e=document.createElement("div");e.id=a,t.appendChild(e),this.container.appendChild(t)}{const t=document.createElement("div");{const e=document.createElement("p");e.innerHTML=`${i.apply("LOC_LINK_THRESHOLD")}\n                               <input type="number" id="${h}">\n                                —\n                                <input type="number" id="${l}">`,t.appendChild(e)}const e=document.createElement("div");e.id=u,t.appendChild(e),this.container.appendChild(t)}}clear(){this.min_node_weight=new s.ScalarParam(0,1),this.max_node_weight=new s.ScalarParam(0,1),this.min_link_weight=new s.ScalarParam(0,1),this.max_link_weight=new s.ScalarParam(0,1),this.UpdateRanges()}fill(t){const e=t;if(e.meta.node_weight_range){const t=e.meta.node_weight_range,i=(t.max-t.min)/e.meta.nodes_count;this.min_node_weight=new s.ScalarParam(t.min,t.max,t.min,i),this.max_node_weight=new s.ScalarParam(t.min,t.max,t.max,i)}if(e.meta.link_weight_range){const t=e.meta.link_weight_range,i=(t.max-t.min)/e.meta.links_count;this.min_link_weight=new s.ScalarParam(t.min,t.max,t.min,i),this.max_link_weight=new s.ScalarParam(t.min,t.max,t.max,i)}this.UpdateRanges()}UpdateRanges(){{const t=document.getElementById(o);this.min_node_weight?(t.min=String(this.min_node_weight.range.min),t.max=String(this.min_node_weight.range.max),t.step=String(this.min_node_weight.range.step),t.value=String(this.min_node_weight.value)):t.disabled=!0;const e=document.getElementById(r);if(this.max_node_weight?(e.min=String(this.max_node_weight.range.min),e.max=String(this.max_node_weight.range.max),e.step=String(this.max_node_weight.range.step),e.value=String(this.max_node_weight.value)):e.disabled=!0,!t.disabled&&!e.disabled){const i=$("#"+a);t.onchange=(()=>{this.min_node_weight.value=parseFloat(t.value),i.slider({values:[this.min_node_weight.value,this.max_node_weight.value]}),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})}),e.onchange=(()=>{this.max_node_weight.value=parseFloat(e.value),i.slider({values:[this.min_node_weight.value,this.max_node_weight.value]}),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})}),i.slider({range:!0,min:this.min_node_weight.range.min,max:this.max_node_weight.range.max,step:this.min_node_weight.range.step,values:[this.min_node_weight.value,this.max_node_weight.value],slide:(i,n)=>{this.min_node_weight.value=n.values[0],this.max_node_weight.value=n.values[1],t.value=String(this.min_node_weight.value),e.value=String(this.max_node_weight.value),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})}})}}{const t=document.getElementById(h);this.min_link_weight?(t.min=String(this.min_link_weight.range.min),t.max=String(this.min_link_weight.range.max),t.step=String(this.min_link_weight.range.step),t.value=String(this.min_link_weight.value)):t.disabled=!0;const e=document.getElementById(l);this.max_link_weight?(e.min=String(this.max_link_weight.range.min),e.max=String(this.max_link_weight.range.max),e.step=String(this.max_link_weight.range.step),e.value=String(this.max_link_weight.value)):e.disabled=!0;const i=$("#"+u);t.disabled||e.disabled||(t.onchange=(()=>{this.min_link_weight.value=parseFloat(t.value),i.slider({values:[this.min_link_weight.value,this.max_link_weight.value]}),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})}),e.onchange=(()=>{this.max_link_weight.value=parseFloat(e.value),i.slider({values:[this.min_link_weight.value,this.max_link_weight.value]}),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})}),i.slider({range:!0,min:this.min_link_weight.range.min,max:this.max_link_weight.range.max,step:this.min_link_weight.range.step,values:[this.min_link_weight.value,this.max_link_weight.value],slide:(i,n)=>{this.min_link_weight.value=n.values[0],this.max_link_weight.value=n.values[1],t.value=String(this.min_link_weight.value),e.value=String(this.max_link_weight.value),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})}}))}}}},"./src/Tabs/NodeInfoTab.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"NodeInfoTab",function(){return n});class n{constructor(t){this.container=null,this.controller=null,this.translator=null}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%",this.clear()}clear(){this.container.innerHTML=`<p>${this.translator.apply("LOC_NO_SELECTED_NODE")}</p>`}fill(t){const e=t.graph,i=t.node_id,n=e.mutable_graph.getNode(i);this.container.innerHTML="";const s=document.createElement("div");{const t=document.createElement("input");t.type="text",t.style.fontWeight="bold",t.style.width="300px",t.style.marginRight="5px",t.value=n.data.label;const e=document.createElement("button");e.className="scivi_button",e.innerText=this.translator.apply("LOC_CHANGE"),e.onclick=(e=>this.controller("ChangeNodeName",{node_id:i,new_name:t.value})),s.appendChild(t),s.appendChild(e)}{const t=document.createElement("ul");t.style.listStyleType="disc",n.data&&Object.keys(n.data).forEach(e=>{const i=document.createElement("li");i.innerText=`${e}: ${n.data[e]}`,t.appendChild(i)}),s.appendChild(t)}const r=document.createElement("div");r.innerHTML=`<label>${this.translator.apply("#out_links_text")}</label>`;{const t=document.createElement("ul");t.style.listStyleType="disc";const i=e.mutable_graph.getLinks(n.id);i&&i.filter(t=>t.fromId==n.id).forEach(i=>{const n=document.createElement("li");n.innerText=`${e.mutable_graph.getNode(i.toId).data.label}`,t.appendChild(n)}),r.appendChild(t)}this.container.appendChild(s),this.container.appendChild(r)}}},"./src/Tabs/NodeListTab.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"NodeListTab",function(){return l});var n,s=i("./src/@types/GUI.ts");!function(t){t[t.NoFilter=0]="NoFilter",t[t.SubstringFilter=1]="SubstringFilter",t[t.StringFilter=2]="StringFilter",t[t.RegExpFilter=3]="RegExpFilter"}(n||(n={}));const r=s.id_prefix+"_node_list_tab_filter_panel",o=s.id_prefix+"_node_list_tab_header",a=s.id_prefix+"_node_list_tab_content";class l{constructor(t){this.container=null,this.controller=null,this.translator=null,this.bound_graph=null,this.filter_string=""}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";const n=document.createElement("div");n.id=r;{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_NOT"),t.onclick=(()=>{this.m_not=!this.m_not,this.m_not?t.classList.add("pushed"):t.classList.remove("pushed"),this.updateList()}),n.appendChild(t)}{const t=document.createElement("input");t.type="text",t.style.marginRight="5px",t.width=200,t.oninput=(()=>{this.filter_string=t.value,this.updateList()}),n.appendChild(t)}{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_FINDSTRING"),t.onclick=(()=>{}),n.appendChild(t)}{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_FINDREGEXP"),t.onclick=(()=>{}),n.appendChild(t)}this.container.appendChild(n);const s=document.createElement("div");s.id=o,s.style.marginTop="5px";{const t=document.createElement("div"),e=document.createElement("span");e.innerText=i.apply("LOC_VISIBLE"),e.style.textAlign="center",e.style.width="auto",e.style.display="inline-block";const n=document.createElement("span");n.innerText=i.apply("LOC_SELECTED"),n.style.textAlign="center",n.style.width="auto",n.style.display="inline-block",n.style.marginLeft="10px",t.appendChild(e),t.appendChild(n),s.appendChild(t)}{const t=document.createElement("button");t.innerText=this.translator.apply("LOC_ALL"),t.className="scivi_button",t.style.width="auto",t.style.textAlign="center",t.onclick=this.ShowAllFilteredNodes;const e=document.createElement("button");e.innerText=this.translator.apply("LOC_NONE"),e.className="scivi_button",e.style.width="auto",e.style.textAlign="center",e.onclick=this.HideAllFilteredNodes,s.appendChild(t),s.appendChild(e)}{const t=document.createElement("button");t.innerText=this.translator.apply("LOC_ALL"),t.className="scivi_button",t.style.width="auto",t.style.textAlign="center",t.style.marginLeft="17px",t.onclick=this.SelectAllFilteredNodes;const e=document.createElement("button");e.innerText=this.translator.apply("LOC_NONE"),e.className="scivi_button",e.style.width="auto",e.style.textAlign="center",e.onclick=this.DeselectAllFilteredNodes,s.appendChild(t),s.appendChild(e)}this.container.appendChild(s);const l=document.createElement("div");l.id=a,this.container.appendChild(l),this.clear()}clear(){document.getElementById(a).innerHTML=`<p>${this.translator.apply("LOC_NO_GRAPH")}</p>`,this.bound_graph=null}fill(t){this.bound_graph=t,this.updateList()}onSelectedNode(t){document.getElementById("node_info"+t).getElementsByTagName("input")[1].checked=!0}onDeselectedNode(t){document.getElementById("node_info"+t).getElementsByTagName("input")[1].checked=!1}updateList(){if(this.bound_graph){const t=document.getElementById(a);t.innerHTML="";const e=this.filter_string.length>0;this.bound_graph.source_graph.forEachNode(i=>(e&&!this.matchStr(i.data.label,this.filter_string,n.SubstringFilter)||this.postNodeInfo(t,i),!1))}}matchStr(t,e,i){if(null===e||0===e.length)return!0;switch(i){case n.NoFilter:return!0;case n.SubstringFilter:return this.m_not?-1===t.indexOf(e):-1!==t.indexOf(e);case n.StringFilter:return this.m_not?t!==e:t===e;case n.RegExpFilter:return this.m_not?null===t.match(e):null!==t.match(e)}return!1}postNodeInfo(t,e){const i=document.createElement("li");i.id="node_info"+e.id,i.style.listStyleType="none";const n=document.createElement("input");n.type="checkbox",n.style.marginLeft="18px",n.checked=!this.bound_graph.isManuallyHiddenNode(e.id),n.onclick=(()=>{n.checked?this.controller("ShowNode",{node_id:e.id}):this.controller("HideNode",{node_id:e.id})});const s=document.createElement("input");s.type="checkbox",s.style.marginLeft="55px",s.style.marginRight="18px",s.onclick=(()=>{s.checked?this.controller("SelectNode",{node_id:e.id}):this.controller("DeselectNode",{node_id:e.id})});const r=document.createElement("span");return r.style.fontWeight="normal",r.innerText=e.data.label,i.appendChild(n),i.appendChild(s),i.appendChild(r),t.appendChild(i),!1}ShowAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[0];e.checked=!0,e.onclick.apply(e)})}HideAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[0];e.checked=!1,e.onclick.apply(e)})}SelectAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[1];e.checked=!0,e.onclick.apply(e)})}DeselectAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[1];e.checked=!1,e.onclick.apply(e)})}}},"./src/Tabs/SettingsTab.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"SettingsTab",function(){return k});var n=i("./src/@types/GUI.ts"),s=i("./src/@types/Param.ts");const r=n.id_prefix+"_settings_tab_node_alpha_label",o=n.id_prefix+"_settings_tab_node_alpha_slider",a=n.id_prefix+"_settings_tab_link_alpha_label",l=n.id_prefix+"_settings_tab_link_alpha_slider",h=n.id_prefix+"_settings_tab_node_size_label",u=n.id_prefix+"_settings_tab_node_size_slider",c=n.id_prefix+"_settings_tab_link_size_label",d=n.id_prefix+"_settings_tab_link_size_slider",p=n.id_prefix+"_settings_tab_border_size_label",g=n.id_prefix+"_settings_tab_border_size_slider",m=n.id_prefix+"_settings_tab_node_font_size_input",_=n.id_prefix+"_settings_tab_always_show_label_input",f=n.id_prefix+"_settings_tab_label_layout_stratefy",v=n.id_prefix+"_settings_tab_layout_builder_selector",y=n.id_prefix+"_settings_tab_layout_builder_configuration",b=n.id_prefix+"_settings_tab_build_layout_button",x=n.id_prefix+"_settings_tab_fit_to_screen_button",w=n.id_prefix+"_settings_tab_calc_modularity_button",E=n.id_prefix+"_settings_tab_graph_export_button";class k{constructor(t){this.container=null,this.controller=null,this.translator=null,t?(this.layouts=t.Layouts,this.view_config=t.view_config):(this.layouts=null,this.view_config=null)}build(t,e,i){this.container=t,this.controller=e,this.translator=i,this.container.style.height="100%";const n=document.createElement("div");{const t=document.createElement("div");{const e=document.createElement("div");e.innerHTML=`${i.apply("LOC_PASSIVETEXTALPHA")}`;const n=document.createElement("span");n.id=r,e.appendChild(n);const s=document.createElement("div");s.id=o,s.style.margin="10px",t.appendChild(e),t.appendChild(s)}const e=document.createElement("div");{const t=document.createElement("div");t.innerHTML=`${i.apply("LOC_PASSIVEEDGEALPHA")}`;const n=document.createElement("span");n.id=a,t.appendChild(n);const s=document.createElement("div");s.id=l,s.style.margin="10px",e.appendChild(t),e.appendChild(s)}n.appendChild(t),n.appendChild(e)}this.container.appendChild(n),S(this.container),$("#"+o).slider({min:0,max:1,step:.01,value:1,slide:(t,i)=>{const n=i.value||0;document.getElementById(r).innerText=` ${n}`,e("SetNodeAlpha",{alpha:n})},create:()=>document.getElementById(r).innerText="1"}),$("#"+l).slider({min:0,max:1,step:.01,value:1,slide:(t,i)=>{const n=i.value||0;document.getElementById(a).innerText=` ${n}`,e("SetLinkAlpha",{alpha:n})},create:()=>document.getElementById(a).innerText="1"});const k=document.createElement("div");{const t=document.createElement("div");{const e=document.createElement("div");e.innerHTML=`${i.apply("LOC_NODE_SIZE_TEXT")}`;const n=document.createElement("span");n.id=h,e.appendChild(n);const s=document.createElement("div");s.id=u,s.style.margin="10px",t.appendChild(e),t.appendChild(s)}const e=document.createElement("div");{const t=document.createElement("div");t.innerHTML=`${i.apply("LOC_LINK_SIZE_TEXT")}`;const n=document.createElement("span");n.id=c,t.appendChild(n);const s=document.createElement("div");s.id=d,s.style.margin="10px",e.appendChild(t),e.appendChild(s)}const n=document.createElement("div");{const t=document.createElement("div");t.innerHTML=`${i.apply("LOC_BORDER_SIZE_TEXT")}`;const n=document.createElement("span");n.id=p,t.appendChild(n);const s=document.createElement("div");s.id=g,s.style.margin="10px",e.appendChild(t),e.appendChild(s)}k.appendChild(t),k.appendChild(e),k.appendChild(n)}this.container.appendChild(k),S(this.container);{const t={min:this.view_config.min_node_size,max:this.view_config.max_node_size};$("#"+u).slider({range:!0,min:t.min,max:t.max,step:.01,values:[t.min,t.max],slide:(t,e)=>{const i=e.values[0],n=e.values[1];document.getElementById(h).innerText=`[${i.toFixed(2)} — ${n.toFixed(2)}]`,this.controller("SetNodeSizeRange",{min:i,max:n})},create:()=>{document.getElementById(h).innerText=`[${t.min.toFixed(2)} — ${t.max.toFixed(2)}]`}})}{const t={min:this.view_config.min_link_size,max:this.view_config.max_link_size};$("#"+d).slider({range:!0,min:t.min,max:t.max,step:.01,values:[t.min,t.max],slide:(t,e)=>{const i=e.values[0],n=e.values[1];document.getElementById(c).innerText=`[${i.toFixed(2)} — ${n.toFixed(2)}]`,this.controller("SetLinkSizeRange",{min:i,max:n})},create:()=>{document.getElementById(c).innerText=`[${t.min.toFixed(2)} — ${t.max.toFixed(2)}]`}})}$("#"+g).slider({min:0,max:.3,step:.01,value:.1,slide:(t,i)=>{const n=i.value||0;document.getElementById(p).innerText=` ${n}`,e("SetBorderSize",{size:n})},create:()=>document.getElementById(p).innerText=" 0.1"});const z=document.createElement("ul");z.style.display="flex",z.style.flexDirection="column",z.style.padding="0";{const t=document.createElement("li");t.style.listStyleType="none",t.style.display="flex",t.style.flexDirection="row";{const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="space-between",e.style.flex="1";const n=document.createElement("span");n.innerText=i.apply("LOC_NODEFONT");const s=document.createElement("input");s.id=m,s.style.width="70px",s.type="number",s.min="5",s.max="50",s.value="24",s.required=!0,e.appendChild(n),e.appendChild(s),t.appendChild(e)}const e=document.createElement("button");e.className="scivi_button",e.innerText=i.apply("LOC_APPLY"),e.style.marginLeft="10px",e.onclick=(()=>{const t=document.getElementById(m);this.controller("SetLabelFontSize",{font_size:parseInt(t.value)})}),t.appendChild(e),z.appendChild(t)}{const t=document.createElement("li");t.style.listStyleType="none";const n=document.createElement("span");n.innerText=`${i.apply("#always_show_labels")}:`;const s=document.createElement("input");s.id=_,s.type="checkbox",s.value="false",s.onclick=(()=>e("ToggleLabelsShowing",null)),t.appendChild(n),t.appendChild(s),z.appendChild(t)}{const t=document.createElement("li");t.style.listStyleType="none";const n=document.createElement("span");n.innerText=`${i.apply("#always_show_weights")}:`;const s=document.createElement("input");s.id=_,s.type="checkbox",s.value="false",s.onclick=(()=>e("ToggleWeightsShowing",null)),t.appendChild(n),t.appendChild(s),z.appendChild(t)}{const t=document.createElement("li");t.style.listStyleType="none";const n=document.createElement("span");n.innerText=`${i.apply("#label_layout_strategy")}:`;const s=document.createElement("select");s.id=f,s.required=!0,s.onchange=(()=>e("SelectLabelLayoutStrategy",{strategy_id:s.options[s.selectedIndex].value}));const r=document.createElement("option");r.value="0",r.text=i.apply("#around_vertex_strategy"),r.selected=!0;const o=document.createElement("option");o.value="1",o.text=i.apply("#inside_vertex_strategy"),s.appendChild(o),s.appendChild(r),t.appendChild(n),t.appendChild(s),z.appendChild(t)}if(this.container.appendChild(z),S(this.container),Object.keys(this.layouts).length>0){const t=document.createElement("div");{const e=document.createElement("select");e.id=v,e.name=v;const n=document.createElement("ul");n.id=y,n.style.margin="10px 10px",e.onchange=(()=>{n.innerHTML="";const t=this.layouts[e.value].getConfiguration();t&&Object.keys(t).forEach(e=>{const i=t[e],r=i.range,o=document.createElement("li");o.style.listStyleType="none",o.innerHTML=`${this.translator.apply("#"+e+"_text")}: `;const a=document.createElement("input");a.className="layout_input",a.id=e,i instanceof s.BooleanParam?(a.type="checkbox",a.checked=i.value):(a.type="number",a.max=String(r.max),a.min=String(r.min),a.step=String(r.step),a.value=String(r.default)),o.appendChild(a),n.appendChild(o)})});const r=document.createElement("button");r.id=b,r.innerText=i.apply("LOC_BUILD_LAYOUT"),r.className="scivi_button",r.onclick=(()=>{const t=this.layouts[e.value].getConfiguration();Object.keys(t).forEach(e=>{const i=document.getElementById(e);switch(t[e].type){case s.ParamType.NUMBER:t[e].value=parseFloat(i.value);break;case s.ParamType.BOOLEAN:t[e].value=i.checked}}),this.controller("layout",{builder:this.layouts[e.value]})}),t.appendChild(e),t.appendChild(n),t.appendChild(r)}this.container.appendChild(t),S(this.container),this.fillLayouts()}const j=document.createElement("div");{const t=document.createElement("button");t.className="scivi_button",t.innerText=i.apply("LOC_FIT_TO_SCREEN"),t.id=x,t.onclick=(()=>this.controller("FitToScreen",null));const e=document.createElement("button");e.className="scivi_button",e.innerText=i.apply("LOC_CALC_MODULARITY"),e.id=w,e.onclick=(()=>this.controller("Clusterise",null));const n=document.createElement("button");n.className="scivi_button",n.innerText=i.apply("LOC_SAVE_GRAPH"),n.id=E,n.onclick=(()=>this.controller("ExportGraph",null));const s=document.createElement("button");s.className="scivi_button",s.innerText=i.apply("#save_as_png"),s.onclick=(()=>this.controller("SavePNG",null)),j.appendChild(t),j.appendChild(e),j.appendChild(n),j.appendChild(s)}this.container.appendChild(j),S(this.container);const A=document.createElement("button");A.className="scivi_button",A.innerText=i.apply("LOC_HELP"),this.container.appendChild(A)}clear(){}fill(t){}fillLayouts(){const t=document.getElementById(v);document.getElementById(y);Object.keys(this.layouts).forEach(e=>{const i=document.createElement("option");i.value=e,i.innerText=this.translator.apply("#"+e),e==Object.keys(this.layouts)[0]&&(i.selected=!0),t.appendChild(i)})}}function S(t){t.appendChild(document.createElement("br")),t.appendChild(document.createElement("hr")),t.appendChild(document.createElement("br"))}},"./src/Translator.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Translator",function(){return s}),i.d(e,"getOrCreateTranslatorInstance",function(){return o});var n=i("./node_modules/node-polyglot/index.js");class s{constructor(t="ru"){this._locale=t,this._instance=new n({allowMissing:!1,locale:t})}extend(t){return this._instance.extend(t[this._locale]),this}apply(t){return this._instance.t(t)}}let r;function o(t=""){return r||(r=new s(t)),r}},"./src/index.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"getParameterByName",function(){return v});var n=i("./src/Translator.ts");i.d(e,"Translator",function(){return n.Translator}),i.d(e,"getOrCreateTranslatorInstance",function(){return n.getOrCreateTranslatorInstance});var s=i("./src/GUI.ts");i.d(e,"GUI",function(){return s.GUI});var r=i("./src/GraphSerializer.ts");i.d(e,"GraphSerializer",function(){return r.GraphSerializer});var o=i("./src/Renderers/CircleNodeRenderer.ts");i.d(e,"CircleNodeRenderer",function(){return o.CircleNodeRenderer});var a=i("./src/Renderers/OrientedStraightLinkRenderer.ts");i.d(e,"OrientedStraightLinkRenderer",function(){return a.OrientedStraightLinkRenderer});var l=i("./src/Renderers/StraightLinkRenderer.ts");i.d(e,"StraightLinkRenderer",function(){return l.StraightLinkRenderer});var h=i("./src/LayoutBuilders/LayoutBuilder_Circle.ts");i.d(e,"LayoutBuilder_Circle",function(){return h.LayoutBuilder_Circle});var u=i("./src/LayoutBuilders/LayoutBuilder_FruchtermanReingold.ts");i.d(e,"LayoutBuilder_FruchtermanReingold",function(){return u.LayoutBuilder_FruchtermanReingold});var c=i("./src/Tabs/NodeInfoTab.ts");i.d(e,"NodeInfoTab",function(){return c.NodeInfoTab});var d=i("./src/Tabs/NodeListTab.ts");i.d(e,"NodeListTab",function(){return d.NodeListTab});var p=i("./src/Tabs/SettingsTab.ts");i.d(e,"SettingsTab",function(){return p.SettingsTab});var g=i("./src/Tabs/FiltersTab.ts");i.d(e,"FiltersTab",function(){return g.FiltersTab});var m=i("./src/Tabs/CalculatorTab.ts");i.d(e,"StateCalculatorOperand",function(){return m.StateCalculatorOperand}),i.d(e,"CalculatorTab",function(){return m.CalculatorTab});var _=i("./src/Tabs/AboutGraphTab.ts");i.d(e,"AboutGraphTab",function(){return _.AboutGraphTab});var f=i("./src/@types/Param.ts");function v(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(i)return i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):""}i.d(e,"ParamType",function(){return f.ParamType}),i.d(e,"Param",function(){return f.Param}),i.d(e,"ScalarParam",function(){return f.ScalarParam}),i.d(e,"BooleanParam",function(){return f.BooleanParam})}});
